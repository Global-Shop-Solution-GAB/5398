Program.Sub.ScreenSU.Start
Gui.FormQC..Create
Gui.FormQC..Size(15360,10695)
Gui.FormQC..MinX(0)
Gui.FormQC..MinY(0)
Gui.FormQC..Position(0,0)
Gui.FormQC..BackColor(-2147483633)
Gui.FormQC..MousePointer(0)
Gui.FormQC..Event(UnLoad,FormQC_UnLoad)
Gui.FormQC..Caption("QC Workflow")
Gui.FormQC.tabQC.Create(Tab)
Gui.FormQC.tabQC.Size(15225,10350)
Gui.FormQC.tabQC.Position(30,45)
Gui.FormQC.tabQC.Event(Click,tabQC_Click)
Gui.FormQC.tabQC.Tabs(4)
Gui.FormQC.tabQC.SetTab(0)
Gui.FormQC.tabQC.Caption("CAPA")
Gui.FormQC.tabQC.SetTab(1)
Gui.FormQC.tabQC.Caption("ECR")
Gui.FormQC.tabQC.SetTab(2)
Gui.FormQC.tabQC.Caption("SIGNOFF")
Gui.FormQC.tabQC.SetTab(3)
Gui.FormQC.tabQC.Caption("COMPLETED")
Gui.FormQC.GsGridControlCAR.Create(GsGridControl)
Gui.FormQC.GsGridControlCAR.Size(15105,9945)
Gui.FormQC.GsGridControlCAR.Position(0,0)
Gui.FormQC.GsGridControlCAR.Parent("tabQC",0)
Gui.FormQC.GsGridControlCAR.Event(MouseCellEnter,GsGridControlCAR_MouseCellEnter)
Gui.FormQC.GsGridControlCAR.Event(RowCellClick,GsGridControlCAR_RowcellClick)
Gui.FormQC.GsGridControlECR.Create(GsGridControl)
Gui.FormQC.GsGridControlECR.Size(15105,9945)
Gui.FormQC.GsGridControlECR.Position(0,0)
Gui.FormQC.GsGridControlECR.Parent("tabQC",1)
Gui.FormQC.GsGridControlECR.Event(RowCellClick,GsGridControlECR_RowcellClick)
Gui.FormQC.GsGridControlECR.Event(MouseCellEnter,GsGridControlECR_MouseCellEnter)
Gui.FormQC.GsGridControlSignOff.Create(GsGridControl)
Gui.FormQC.GsGridControlSignOff.Size(15105,9945)
Gui.FormQC.GsGridControlSignOff.Position(0,0)
Gui.FormQC.GsGridControlSignOff.Parent("tabQC",2)
Gui.FormQC.GsGridControlSignOff.Event(RowCellClick,GsGridControlSignOff_RowcellClick)
Gui.FormQC.GsGridControlSignOff.Event(MouseCellEnter,GsGridControlSignOff_MouseCellEnter)
Gui.FormQC.GsGridControlCompleted.Create(GsGridControl)
Gui.FormQC.GsGridControlCompleted.Size(15105,9945)
Gui.FormQC.GsGridControlCompleted.Position(0,0)
Gui.FormQC.GsGridControlCompleted.Parent("tabQC",3)
Gui.FormQC.GsGridControlCompleted.Event(RowCellClick,GsGridControlCompleted_RowcellClick)
Gui.FormQC.cmdRefresh.Create(Button)
Gui.FormQC.cmdRefresh.Size(975,375)
Gui.FormQC.cmdRefresh.Position(14205,0)
Gui.FormQC.cmdRefresh.Caption("REFRESH")
Gui.FormQC.cmdRefresh.Event(Click,cmdRefresh_Click)
Gui.FormQC.cmdAddRow.Create(Button)
Gui.FormQC.cmdAddRow.Size(975,375)
Gui.FormQC.cmdAddRow.Position(13200,0)
Gui.FormQC.cmdAddRow.Caption("Add Row")
Gui.FormQC.cmdAddRow.Event(Click,cmdAddRow_Click)
Gui.FormCCA/ECR..Create
Gui.FormCCA/ECR..Caption("Data Entry CAPA/ECR")
Gui.FormCCA/ECR..Size(12330,8280)
Gui.FormCCA/ECR..MinX(0)
Gui.FormCCA/ECR..MinY(0)
Gui.FormCCA/ECR..Position(0,0)
Gui.FormCCA/ECR..BackColor(-2147483633)
Gui.FormCCA/ECR..MousePointer(0)
Gui.FormCCA/ECR..Event(UnLoad,FormCCA/ECR_UnLoad)
Gui.FormCCA/ECR..Event(Resize,FormCCA/ECR_Resize)
Gui.FormCCA/ECR.lblCCA/ECR.Create(Label,"CAPA/ECR: ",True,3030,435,0,105,195,True,0,"Arial",14,-2147483633,0)
Gui.FormCCA/ECR.lblProjectType.Create(Label,"Type",True,1935,255,0,105,870,True,0,"Arial",8,-2147483633,0)
Gui.FormCCA/ECR.ddlProjType.Create(DropDownList)
Gui.FormCCA/ECR.ddlProjType.Size(1935,330)
Gui.FormCCA/ECR.ddlProjType.Position(105,1095)
Gui.FormCCA/ECR.ddlProjType.Event(Click,Form_ECRCCA_Change)
Gui.FormCCA/ECR.txtPart.Create(TextBox,"",True,2700,300,0,2715,1125,True,0,"Arial",8,-2147483643,1)
Gui.FormCCA/ECR.cmdPart.Create(Button)
Gui.FormCCA/ECR.cmdPart.Size(405,375)
Gui.FormCCA/ECR.cmdPart.Position(5565,1080)
Gui.FormCCA/ECR.cmdPart.Caption("^")
Gui.FormCCA/ECR.cmdPart.Event(Click,cmdPart_Click)
Gui.FormCCA/ECR.lblPart.Create(Label,"Part",True,1935,255,0,2715,870,True,0,"Arial",8,-2147483633,0)
Gui.FormCCA/ECR.lblWO.Create(Label,"Work Order",True,1935,255,0,6690,870,True,0,"Arial",8,-2147483633,0)
Gui.FormCCA/ECR.lblSO.Create(Label,"Sales Order",True,1935,255,0,9705,870,True,0,"Arial",8,-2147483633,0)
Gui.FormCCA/ECR.lblDesc.Create(Label,"Description",True,1935,255,0,105,3165,True,0,"Arial",8,-2147483633,0)
Gui.FormCCA/ECR.cmdCCAECRSave.Create(Button)
Gui.FormCCA/ECR.cmdCCAECRSave.Size(855,375)
Gui.FormCCA/ECR.cmdCCAECRSave.Position(105,7440)
Gui.FormCCA/ECR.cmdCCAECRSave.Caption("Save")
Gui.FormCCA/ECR.cmdCCAECRSave.Event(Click,cmdCCAECRSave_Click)
Gui.FormCCA/ECR.lblIssue.Create(Label,"Process",True,1935,255,0,105,1650,True,0,"Arial",8,-2147483633,0)
Gui.FormCCA/ECR.txtWO.Create(TextBox,"",True,1725,300,0,6690,1125,True,0,"Arial",8,-2147483643,1)
Gui.FormCCA/ECR.txtSO.Create(TextBox,"",True,1725,300,0,9705,1125,True,0,"Arial",8,-2147483643,1)
Gui.FormCCA/ECR.cmdWO.Create(Button)
Gui.FormCCA/ECR.cmdWO.Size(405,375)
Gui.FormCCA/ECR.cmdWO.Position(8580,1080)
Gui.FormCCA/ECR.cmdWO.Caption("^")
Gui.FormCCA/ECR.cmdWO.Event(Click,cmdWO_Click)
Gui.FormCCA/ECR.cmdSO.Create(Button)
Gui.FormCCA/ECR.cmdSO.Size(405,375)
Gui.FormCCA/ECR.cmdSO.Position(11580,1080)
Gui.FormCCA/ECR.cmdSO.Caption("^")
Gui.FormCCA/ECR.cmdSO.Event(Click,cmdSO_Click)
Gui.FormCCA/ECR.ddlIssue.Create(DropDownList)
Gui.FormCCA/ECR.ddlIssue.Size(1935,330)
Gui.FormCCA/ECR.ddlIssue.Position(105,1875)
Gui.FormCCA/ECR.ddlIssue.Event(Click,Form_ECRCCA_Change)
Gui.FormCCA/ECR.lblStatus.Create(Label,"Status",True,1935,255,0,2775,1650,True,0,"Arial",8,-2147483633,0)
Gui.FormCCA/ECR.ddlStatus.Create(DropDownList)
Gui.FormCCA/ECR.ddlStatus.Size(2700,330)
Gui.FormCCA/ECR.ddlStatus.Position(2775,1875)
Gui.FormCCA/ECR.ddlStatus.Event(Click,Form_ECRCCA_Change)
Gui.FormCCA/ECR.lblPriority.Create(Label,"Priority",True,1650,255,0,6195,1650,True,0,"Arial",8,-2147483633,0)
Gui.FormCCA/ECR.ddlPriority.Create(DropDownList)
Gui.FormCCA/ECR.ddlPriority.Size(1590,330)
Gui.FormCCA/ECR.ddlPriority.Position(6195,1875)
Gui.FormCCA/ECR.ddlPriority.Event(Click,Form_ECRCCA_Change)
Gui.FormCCA/ECR.lblAssigned.Create(Label,"Assigned Dept",True,1935,255,0,105,2430,True,0,"Arial",8,-2147483633,0)
Gui.FormCCA/ECR.txtDept.Create(TextBox,"",True,1725,300,0,105,2670,True,0,"Arial",8,-2147483643,1)
Gui.FormCCA/ECR.cmdDept.Create(Button)
Gui.FormCCA/ECR.cmdDept.Size(405,375)
Gui.FormCCA/ECR.cmdDept.Position(1965,2610)
Gui.FormCCA/ECR.cmdDept.Caption("^")
Gui.FormCCA/ECR.cmdDept.Event(Click,cmdDept_Click)
Gui.FormCCA/ECR.txtESTCost.Create(TextBox,"",True,1725,300,0,8280,1905,True,0,"Arial",8,-2147483643,1)
Gui.FormCCA/ECR.txtESTCost.Event(Change,Form_ECRCCA_Change)
Gui.FormCCA/ECR.lblEstCost.Create(Label,"Est Cost",True,1650,255,0,8280,1650,True,0,"Arial",8,-2147483633,0)
Gui.FormCCA/ECR.ddlWG.Create(DropDownList)
Gui.FormCCA/ECR.ddlWG.Size(1560,330)
Gui.FormCCA/ECR.ddlWG.Position(10425,1875)
Gui.FormCCA/ECR.ddlWG.Event(Click,Form_ECRCCA_Change)
Gui.FormCCA/ECR.lblWG.Create(Label,"Work Group",True,1650,255,0,10425,1650,True,0,"Arial",8,-2147483633,0)
Gui.FormCCA/ECR.lblAssignedTo.Create(Label,"Assigned To",True,1935,255,0,2490,2430,True,0,"Arial",8,-2147483633,0)
Gui.FormCCA/ECR.ddlAssignedTo.Create(DropDownList)
Gui.FormCCA/ECR.ddlAssignedTo.Size(1935,330)
Gui.FormCCA/ECR.ddlAssignedTo.Position(2490,2640)
Gui.FormCCA/ECR.ddlAssignedTo.Event(Click,Form_ECRCCA_Change)
Gui.FormCCA/ECR.lblDueDate.Create(Label,"Due Date",True,1935,255,0,4575,2430,True,0,"Arial",8,-2147483633,0)
Gui.FormCCA/ECR.dtpDueDate.Create(DatePicker)
Gui.FormCCA/ECR.dtpDueDate.Size(1935,285)
Gui.FormCCA/ECR.dtpDueDate.Position(4575,2670)
Gui.FormCCA/ECR.dtpDueDate.Event(Change,Form_ECRCCA_Change)
Gui.FormCCA/ECR.chkECR.Create(CheckBox)
Gui.FormCCA/ECR.chkECR.Size(1110,585)
Gui.FormCCA/ECR.chkECR.Position(9105,2610)
Gui.FormCCA/ECR.chkECR.Caption("ECR Required")
Gui.FormCCA/ECR.chkECR.Event(Click,chkECR_Click)
Gui.FormCCA/ECR.lblECR.Create(Label,"ECR",False,1005,255,0,10290,2430,True,0,"Arial",8,-2147483633,0)
Gui.FormCCA/ECR.txtECR.Create(TextBox,"",False,1215,300,0,10290,2670,True,0,"Arial",8,-2147483643,1)
Gui.FormCCA/ECR.txtECR.Locked(True)
Gui.FormCCA/ECR.txtECR.Event(Change,Form_ECRCCA_Change)
Gui.FormCCA/ECR.txtDesc.Create(TextboxM)
Gui.FormCCA/ECR.txtDesc.Size(11880,1035)
Gui.FormCCA/ECR.txtDesc.Position(105,3375)
Gui.FormCCA/ECR.txtDesc.Event(Change,Form_ECRCCA_Change)
Gui.FormCCA/ECR.cmdECC.Create(Button)
Gui.FormCCA/ECR.cmdECC.Visible(False)
Gui.FormCCA/ECR.cmdECC.Size(405,375)
Gui.FormCCA/ECR.cmdECC.Position(11580,2610)
Gui.FormCCA/ECR.cmdECC.Caption("^")
Gui.FormCCA/ECR.cmdECC.Event(Click,cmdECC_Click)
Gui.FormCCA/ECR.lblOrgDrawn.Create(Label,"Org. Drawn By",True,1725,255,0,3690,195,True,0,"Arial",8,-2147483633,0)
Gui.FormCCA/ECR.txtOrgDrawn.Create(TextBox,"",True,1725,300,0,3690,405,True,0,"Arial",8,-2147483643,1)
Gui.FormCCA/ECR.cmdOrigDrawn.Create(Button)
Gui.FormCCA/ECR.cmdOrigDrawn.Size(405,375)
Gui.FormCCA/ECR.cmdOrigDrawn.Position(5565,360)
Gui.FormCCA/ECR.cmdOrigDrawn.Caption("^")
Gui.FormCCA/ECR.cmdOrigDrawn.Event(Click,cmdOrigDrawn_Click)
Gui.FormCCA/ECR.lblModBy.Create(Label,"Org. Modeled By",True,1725,255,0,6690,195,True,0,"Arial",8,-2147483633,0)
Gui.FormCCA/ECR.txtOrgModBy.Create(TextBox,"",True,1725,300,0,6690,405,True,0,"Arial",8,-2147483643,1)
Gui.FormCCA/ECR.cmdOrigModBy.Create(Button)
Gui.FormCCA/ECR.cmdOrigModBy.Size(405,375)
Gui.FormCCA/ECR.cmdOrigModBy.Position(8580,360)
Gui.FormCCA/ECR.cmdOrigModBy.Caption("^")
Gui.FormCCA/ECR.cmdOrigModBy.Event(Click,cmdOrigModBy_Click)
Gui.FormCCA/ECR.lblOrgCheck.Create(Label,"Org. Checked By",True,1725,255,0,9705,195,True,0,"Arial",8,-2147483633,0)
Gui.FormCCA/ECR.txtOrgCheckBy.Create(TextBox,"",True,1725,300,0,9705,405,True,0,"Arial",8,-2147483643,1)
Gui.FormCCA/ECR.cmdOrigCheck.Create(Button)
Gui.FormCCA/ECR.cmdOrigCheck.Size(405,375)
Gui.FormCCA/ECR.cmdOrigCheck.Position(11580,360)
Gui.FormCCA/ECR.cmdOrigCheck.Caption("^")
Gui.FormCCA/ECR.cmdOrigCheck.Event(Click,cmdOrigCheck_Click)
Gui.FormCCA/ECR.txtRootCause.Create(TextboxM)
Gui.FormCCA/ECR.txtRootCause.Size(11880,1035)
Gui.FormCCA/ECR.txtRootCause.Position(105,4800)
Gui.FormCCA/ECR.lblRootCause.Create(Label,"Root Cause",True,1935,255,0,105,4545,True,0,"Arial",8,-2147483633,0)
Gui.FormCCA/ECR.lblActionPlan.Create(Label,"Action Plan",True,1935,255,0,105,5970,True,0,"Arial",8,-2147483633,0)
Gui.FormCCA/ECR.txtActionPlan.Create(TextboxM)
Gui.FormCCA/ECR.txtActionPlan.Size(11880,1035)
Gui.FormCCA/ECR.txtActionPlan.Position(105,6225)
Gui.FormCCA/ECR.lblSource.Create(Label,"Source",True,1935,255,0,6720,2430,True,0,"Arial",8,-2147483633,0)
Gui.FormCCA/ECR.ddlSource.Create(DropDownList)
Gui.FormCCA/ECR.ddlSource.Size(2130,330)
Gui.FormCCA/ECR.ddlSource.Position(6720,2640)
Gui.FormCCA/ECR.ddlSource.Event(Click,Form_ECRCCA_Change)
Gui.FormCCA/ECRSignoff..Create
Gui.FormCCA/ECRSignoff..Caption("CAPA/ECR Signoff")
Gui.FormCCA/ECRSignoff..Size(5520,3900)
Gui.FormCCA/ECRSignoff..MinX(0)
Gui.FormCCA/ECRSignoff..MinY(0)
Gui.FormCCA/ECRSignoff..Position(0,0)
Gui.FormCCA/ECRSignoff..BackColor(-2147483633)
Gui.FormCCA/ECRSignoff..MousePointer(0)
Gui.FormCCA/ECRSignoff..Event(UnLoad,FormCCA/ECRSignoff_UnLoad)
Gui.FormCCA/ECRSignoff.lblCCA/ECR.Create(Label,"CAPA/ECR: ",True,3120,435,0,105,195,True,0,"Arial",14,-2147483633,0)
Gui.FormCCA/ECRSignoff.ddlAddGroup1.Create(DropDownList)
Gui.FormCCA/ECRSignoff.ddlAddGroup1.Size(1845,330)
Gui.FormCCA/ECRSignoff.ddlAddGroup1.Position(105,885)
Gui.FormCCA/ECRSignoff.ddlAddGroup1.Event(Click,Form_ECRCCASignoff_Change)
Gui.FormCCA/ECRSignoff.lblAddGroup1.Create(Label,"Additional Group 1",True,1935,255,0,105,645,True,0,"Arial",8,-2147483633,0)
Gui.FormCCA/ECRSignoff.ddlAddGroup2.Create(DropDownList)
Gui.FormCCA/ECRSignoff.ddlAddGroup2.Size(1845,330)
Gui.FormCCA/ECRSignoff.ddlAddGroup2.Position(105,1740)
Gui.FormCCA/ECRSignoff.ddlAddGroup2.Event(Click,Form_ECRCCASignoff_Change)
Gui.FormCCA/ECRSignoff.lblAddGroup2.Create(Label,"Additional Group 2",True,1935,255,0,105,1515,True,0,"Arial",8,-2147483633,0)
Gui.FormCCA/ECRSignoff.chkAddGroup1Signoff.Create(CheckBox)
Gui.FormCCA/ECRSignoff.chkAddGroup1Signoff.Size(945,360)
Gui.FormCCA/ECRSignoff.chkAddGroup1Signoff.Position(2100,870)
Gui.FormCCA/ECRSignoff.chkAddGroup1Signoff.Caption("Signoff")
Gui.FormCCA/ECRSignoff.chkAddGroup1Signoff.Event(Click,chkAddGroup1Signoff_Click)
Gui.FormCCA/ECRSignoff.chkAddGroup2Signoff.Create(CheckBox)
Gui.FormCCA/ECRSignoff.chkAddGroup2Signoff.Size(945,360)
Gui.FormCCA/ECRSignoff.chkAddGroup2Signoff.Position(2100,1725)
Gui.FormCCA/ECRSignoff.chkAddGroup2Signoff.Caption("Signoff")
Gui.FormCCA/ECRSignoff.chkAddGroup2Signoff.Event(Click,chkAddGroup2Signoff_Click)
Gui.FormCCA/ECRSignoff.cmdSendEmails.Create(Button)
Gui.FormCCA/ECRSignoff.cmdSendEmails.Size(1740,375)
Gui.FormCCA/ECRSignoff.cmdSendEmails.Position(3570,2550)
Gui.FormCCA/ECRSignoff.cmdSendEmails.Caption("Send Email")
Gui.FormCCA/ECRSignoff.cmdSendEmails.Event(Click,cmdSendEmails_Click)
Gui.FormCCA/ECRSignoff.lblSignoff1.Create(Label,"Signed off by User",True,1935,255,0,3105,645,True,0,"Arial",8,-2147483633,0)
Gui.FormCCA/ECRSignoff.lblSignoff2.Create(Label,"Signed off by User",True,1935,255,0,3105,1515,True,0,"Arial",8,-2147483633,0)
Gui.FormCCA/ECRSignoff.txtGroup1User.Create(TextBox,"",True,1965,300,0,3105,900,True,0,"Arial",8,-2147483643,1)
Gui.FormCCA/ECRSignoff.txtGroup1User.Locked(True)
Gui.FormCCA/ECRSignoff.txtGroup2User.Create(TextBox,"",True,1965,300,0,3105,1755,True,0,"Arial",8,-2147483643,1)
Gui.FormCCA/ECRSignoff.txtGroup2User.Locked(True)
Gui.FormCCA/ECRSignoff.chkQCSignoff.Create(CheckBox)
Gui.FormCCA/ECRSignoff.chkQCSignoff.Size(1215,360)
Gui.FormCCA/ECRSignoff.chkQCSignoff.Position(135,2595)
Gui.FormCCA/ECRSignoff.chkQCSignoff.Caption("QC Signoff")
Gui.FormCCA/ECRSignoff.chkQCSignoff.Event(Click,chkQCSignoff_Click)
Gui.FormCCA/ECRSignoff.lblSignoffQC.Create(Label,"Signed off by User",True,1935,255,0,1455,2400,True,0,"Arial",8,-2147483633,0)
Gui.FormCCA/ECRSignoff.txtQCUser.Create(TextBox,"",True,1965,300,0,1455,2625,True,0,"Arial",8,-2147483643,1)
Gui.FormCCA/ECRSignoff.txtQCUser.Locked(True)
Gui.FormCCA/ECRSignoff.cmdSaveSignoff.Create(Button)
Gui.FormCCA/ECRSignoff.cmdSaveSignoff.Size(855,375)
Gui.FormCCA/ECRSignoff.cmdSaveSignoff.Position(105,3105)
Gui.FormCCA/ECRSignoff.cmdSaveSignoff.Caption("Save")
Gui.FormCCA/ECRSignoff.cmdSaveSignoff.Event(Click,cmdSaveSignoff_Click)
Program.Sub.ScreenSU.End

Program.Sub.Preflight.Start
V.Global.iCarIndex.Declare(Long,-1)
V.Global.iEcrIndex.Declare(Long,-1)
V.Global.iSignOffIndex.Declare(Long,-1)
V.Global.iEcr.Declare(Long,0)
v.Global.iWidth.Declare(Long,0)
v.Global.iHeight.Declare(Long,0)
Program.Sub.Preflight.End

Program.Sub.Main.Start
F.Intrinsic.Control.Try
	V.Local.sError.Declare(String,"")
	V.Local.i.Declare
	
	F.Intrinsic.Control.BlockEvents
	'This Project is a Work Flow Where User can Create CCA(Cause and Corrective Actions) and ECR(Engineering Change Record)
	'This Project Alow Dept and User to be assigned created CCA/ECR's
	'Final Signoff will be done by the QC group - QC group can also sign two addition Groups that need to signoff the CCA/ECR
	'There's a completed Tab to show all completed CCA/ECR(s)
	'Coded by RLK 2/20/2019
	'setting anchors to the screen
	F.Intrinsic.Control.CallSub(Set_Anchors)
	'populating screen
	F.Intrinsic.Control.CallSub(Get_Data)
	F.Intrinsic.Control.UnBlockEvents
	'setting grid properties for each grid
	F.Intrinsic.Control.CallSub(Set_Car_Properties)
	F.Intrinsic.Control.CallSub(Set_Ecr_Properties)
	F.Intrinsic.Control.CallSub(Set_Signoff_Properties)
	F.Intrinsic.Control.CallSub(Set_Complete_Properties)
	
	v.Global.iWidth.Set(V.Screen.FormCCA/ECR.Width)
	v.Global.iHeight.Set(V.Screen.FormCCA/ECR.Height)
	
	Gui.FormQC..Show
	
	'setting default tab to CCA tab
	Gui.FormQC.tabQC.SetTab(0)
	
	F.Intrinsic.Control.ExitSub

F.Intrinsic.Control.Catch
	F.Intrinsic.Control.If(V.Ambient.ErrorNumber,<>,0)
		F.Intrinsic.String.Build("Project: {0}{1}Subroutine: {2}{1}Error Occurred {3} with description {4}","GCG_5398_CAR_ECN.g2u",V.Ambient.NewLine,V.Ambient.CurrentSubroutine,V.Ambient.ErrorNumber,V.Ambient.ErrorDescription,V.Local.sError)
		F.Intrinsic.UI.Msgbox(V.Local.sError)
		F.Intrinsic.Control.CallSub(FormQC_UnLoad)
	F.Intrinsic.Control.EndIf
Function.Intrinsic.Control.EndTry
Program.Sub.Main.End

Program.Sub.FormQC_UnLoad.Start
F.Intrinsic.Control.Try
	V.Local.sError.Declare(String,"")
	V.Local.sSql.Declare(String,"")
	V.Local.sFile.Declare(String,"")
	V.Local.sReturn.Declare(String,"")
	
	F.ODBC.Connection!Con.OpenCompanyConnection
	
	'clearing record locks for logged in user.
	F.Intrinsic.String.Build("Delete From GCG_5398_Record_Lock Where Gss_User = '{0}'",V.Caller.User.Trim,V.Local.sSql)
	F.ODBC.Connection!Con.Execute(V.Local.sSql)
	
	'getting saved formats for grids
	F.Intrinsic.String.Build("{0}\Custom\5398\{1}{2}_5398_CAR.txt",V.Caller.GlobalDir,V.Caller.User.Trim,V.Caller.CompanyCode,V.Local.sFile)
	Gui.FormQC.GsGridControlCAR.Serialize("CAR",V.Local.sReturn)
	F.Intrinsic.File.String2File(V.Local.sFile,V.Local.sReturn)
	
	F.Intrinsic.String.Build("{0}\Custom\5398\{1}{2}_5398_ECR.txt",V.Caller.GlobalDir,V.Caller.User.Trim,V.Caller.CompanyCode,V.Local.sFile)
	Gui.FormQC.GsGridControlECR.Serialize("ECR",V.Local.sReturn)
	F.Intrinsic.File.String2File(V.Local.sFile,V.Local.sReturn)
	
	F.Intrinsic.String.Build("{0}\Custom\5398\{1}{2}_5398_Signoff.txt",V.Caller.GlobalDir,V.Caller.User.Trim,V.Caller.CompanyCode,V.Local.sFile)
	Gui.FormQC.GsGridControlSignoff.Serialize("Signoff",V.Local.sReturn)
	F.Intrinsic.File.String2File(V.Local.sFile,V.Local.sReturn)
	
	F.Intrinsic.String.Build("{0}\Custom\5398\{1}{2}_5398_Complete.txt",V.Caller.GlobalDir,V.Caller.User.Trim,V.Caller.CompanyCode,V.Local.sFile)
	Gui.FormQC.GsGridControlCompleted.Serialize("Complete",V.Local.sReturn)
	F.Intrinsic.File.String2File(V.Local.sFile,V.Local.sReturn)
	
	F.ODBC.Connection!Con.Close
	
	F.Intrinsic.Control.End
	
	F.Intrinsic.Control.ExitSub

F.Intrinsic.Control.Catch
	F.Intrinsic.Control.If(V.Ambient.ErrorNumber,<>,0)
		F.Intrinsic.Control.End
	F.Intrinsic.Control.EndIf
Function.Intrinsic.Control.EndTry
Program.Sub.FormQC_UnLoad.End

Program.Sub.Get_Data.Start
F.Intrinsic.Control.Try
	V.Local.sError.Declare(String,"")
	V.Local.sSql.Declare(String,"")
	
	F.ODBC.Connection!Con.OpenCompanyConnection
	
	'creating Datatables that will be used to populate the grid as well as Save Dt that will be used to save data back to pervasive.
	'save datatables are used so only single rows can be saved back to the pervasive rather than all rows in the datable used to populate the grid.
	V.Local.sSql.Set("Select '' as Doc_Link, CCA_NO, DATE_ENTERED, DUE_DATE, ORIG_USER, rtrim(PRIORITY) as PRIORITY, rtrim(PROJECT_TYPE) as PROJECT_TYPE, rtrim(PART) as PART, rtrim(WO) as WO, rtrim(SO) as SO, ISSUE, rtrim(DESCRIPTION) as DESCRIPTION, rtrim(ROOT_CAUSE) as ROOT_CAUSE,rtrim(ACTION_PLAN) as ACTION_PLAN, STATUS, rtrim(ASSIGNED_Dept) as ASSIGNED_Dept, rtrim(ASSIGNED_TO) as ASSIGNED_TO,rtrim(Source) as Source, ECR_REQUIRED, ECR, EST_COST_INC,  rtrim(WorkGroup) as WorkGroup FROM GCG_5398_CAR Where Status <> 'Complete - Awaiting Signoff' ORDER BY CCA_NO")
	F.Data.DataTable.CreateFromSQL("CAR","con",V.Local.sSql,True)
	
	V.Local.sSql.Set("Select CCA_NO, DATE_ENTERED, DUE_DATE, ORIG_USER, rtrim(PRIORITY) as PRIORITY, rtrim(PROJECT_TYPE) as PROJECT_TYPE, rtrim(PART) as PART, rtrim(WO) as WO, rtrim(SO) as SO, ISSUE, rtrim(DESCRIPTION) as DESCRIPTION, rtrim(ROOT_CAUSE) as ROOT_CAUSE, rtrim(ACTION_PLAN) as ACTION_PLAN, STATUS, rtrim(ASSIGNED_Dept) as ASSIGNED_Dept, rtrim(ASSIGNED_TO) as ASSIGNED_TO,rtrim(Source) as Source, ECR_REQUIRED, ECR, EST_COST_INC, rtrim(WorkGroup) as WorkGroup FROM GCG_5398_CAR Where CCA_NO = -1")
	F.Data.DataTable.CreateFromSQL("CARSave","con",V.Local.sSql,True)
	
	F.Data.DataTable.AddColumn("CAR","Edit","String")
	F.Data.DataTable.SetValue("CAR",-1,"Edit","Edit")
	F.Data.DataTable.AddColumn("CAR","Delete","String")
	F.Data.DataTable.SetValue("CAR",-1,"Delete","Delete")
	
	V.Local.sSql.Set("Select '' as Doc_Link, ECR,'' as CCA_NO, DATE_ENTERED, DUE_DATE, ORIG_USER, rtrim(PRIORITY) as PRIORITY, rtrim(PROJECT_TYPE) as PROJECT_TYPE, rtrim(ECC) as ECC, rtrim(PART) as PART, rtrim(WO) as WO, rtrim(SO) as SO, ISSUE, rtrim(DESCRIPTION) as DESCRIPTION, rtrim(ROOT_CAUSE) as ROOT_CAUSE, rtrim(ACTION_PLAN) as ACTION_PLAN, STATUS, rtrim(ASSIGNED_Dept) as ASSIGNED_Dept, rtrim(ASSIGNED_TO) as ASSIGNED_TO,rtrim(Source) as Source, EST_COST_INC, rtrim(WorkGroup) as WorkGroup, ORIG_DRAWNBY, ORIG_MODELBY, ORIG_CHECKBY FROM GCG_5398_ECR Where Status <> 'Complete - Awaiting Signoff' ORDER By ECR")
	F.Data.DataTable.CreateFromSQL("ECR","con",V.Local.sSql,True)
	
	F.Data.Dictionary.CreateFromSQL("CCA_Temp","Con","Select ECR, CCA_NO From GCG_5398_CAR")
	F.Data.Dictionary.SetDefaultReturn("CCA_Temp"," ")
	F.Data.DataTable.FillFromDictionary("ECR","CCA_Temp","ECR","CCA_NO")
	
	V.Local.sSql.Set("Select ECR, DATE_ENTERED, DUE_DATE, ORIG_USER, rtrim(PRIORITY) as PRIORITY, rtrim(PROJECT_TYPE) as PROJECT_TYPE, rtrim(ECC) as ECC, rtrim(PART) as PART, rtrim(WO) as WO, rtrim(SO) as SO, ISSUE, rtrim(DESCRIPTION) as DESCRIPTION, rtrim(ROOT_CAUSE) as ROOT_CAUSE,rtrim(ACTION_PLAN) as ACTION_PLAN, STATUS, rtrim(ASSIGNED_Dept) as ASSIGNED_Dept, rtrim(ASSIGNED_TO) as ASSIGNED_TO,rtrim(Source) as Source, EST_COST_INC, rtrim(WorkGroup) as WorkGroup, ORIG_DRAWNBY, ORIG_MODELBY, ORIG_CHECKBY FROM GCG_5398_ECR Where ECR = -1")
	F.Data.DataTable.CreateFromSQL("ECRSave","con",V.Local.sSql,True)
	
	F.Data.DataTable.AddColumn("ECR","Edit","String")
	F.Data.DataTable.SetValue("ECR",-1,"Edit","Edit")
	F.Data.DataTable.AddColumn("ECR","Delete","String")
	F.Data.DataTable.SetValue("ECR",-1,"Delete","Delete")
	
	V.Local.sSql.Set("Select '' as Doc_Link, CCA_NO, ECR, DATE_ENTERED, DUE_DATE, ORIG_USER, rtrim(PRIORITY) as PRIORITY, rtrim(PROJECT_TYPE) as PROJECT_TYPE, rtrim(PART) as PART, rtrim(WO) as WO, rtrim(SO) as SO, ISSUE, rtrim(DESCRIPTION) as DESCRIPTION, rtrim(ROOT_CAUSE) as ROOT_CAUSE,rtrim(ACTION_PLAN) as ACTION_PLAN, STATUS, rtrim(ASSIGNED_Dept) as ASSIGNED_Dept, rtrim(ASSIGNED_TO) as ASSIGNED_TO,rtrim(Source) as Source, EST_COST_INC, rtrim(WorkGroup) as WorkGroup, QA_SIGNOFF, QA_USER, ADD_Group_1, Group_1_SIGNOFF, Group_1_USER, ADD_Group_2, Group_2_SIGNOFF, Group_2_USER, '' as ORIG_DRAWNBY, '' as ORIG_MODELBY, '' as ORIG_CHECKBY FROM GCG_5398_CAR Where Status = 'Complete - Awaiting Signoff' and QA_SIGNOFF <> 1 ORDER BY CCA_NO")
	F.Data.DataTable.CreateFromSQL("Signoff","con",V.Local.sSql,True)
	
	V.Local.sSql.Set("Select ECR, DATE_ENTERED, DUE_DATE, ORIG_USER, rtrim(PRIORITY) as PRIORITY, rtrim(PROJECT_TYPE) as PROJECT_TYPE, rtrim(ECC) as ECC, rtrim(PART) as PART, rtrim(WO) as WO, rtrim(SO) as SO, ISSUE, rtrim(DESCRIPTION) as DESCRIPTION, rtrim(ROOT_CAUSE) as ROOT_CAUSE,rtrim(ACTION_PLAN) as ACTION_PLAN, STATUS, rtrim(ASSIGNED_Dept) as ASSIGNED_Dept, rtrim(ASSIGNED_TO) as ASSIGNED_TO,rtrim(Source) as Source, EST_COST_INC, rtrim(WorkGroup) as WorkGroup, QA_SIGNOFF, QA_USER, ADD_Group_1, Group_1_SIGNOFF, Group_1_USER, ADD_Group_2, Group_2_SIGNOFF, Group_2_USER, COMPLETED_DATE, ORIG_DRAWNBY, ORIG_MODELBY, ORIG_CHECKBY FROM GCG_5398_ECR Where ECR = -1")
	F.Data.DataTable.CreateFromSQL("SignoffSave","con",V.Local.sSql,True)
	F.Data.DataTable.AddColumn("SignoffSave","CCA_NO",Long)
	
	V.Local.sSql.Set("Select ECR, DATE_ENTERED, DUE_DATE, COMPLETED_DATE, ORIG_USER, rtrim(PRIORITY) as PRIORITY, rtrim(PROJECT_TYPE) as PROJECT_TYPE, rtrim(PART) as PART, rtrim(WO) as WO, rtrim(SO) as SO, ISSUE, rtrim(DESCRIPTION) as DESCRIPTION, rtrim(ROOT_CAUSE) as ROOT_CAUSE,rtrim(ACTION_PLAN) as ACTION_PLAN, STATUS, rtrim(ASSIGNED_Dept) as ASSIGNED_Dept, rtrim(ASSIGNED_TO) as ASSIGNED_TO,rtrim(Source) as Source, EST_COST_INC, rtrim(WorkGroup) as WorkGroup, QA_SIGNOFF, QA_USER, ADD_Group_1, Group_1_SIGNOFF, Group_1_USER, ADD_Group_2, Group_2_SIGNOFF, Group_2_USER FROM GCG_5398_ECR Where Status = 'Complete - Awaiting Signoff' and QA_SIGNOFF <> 1 ORDER BY ECR")
	F.Data.DataTable.CreateFromSQL("Temp","con",V.Local.sSql,True)
	F.Data.DataTable.Merge("Temp","Signoff",True,4)
	F.Data.DataTable.Close("Temp")
	
	F.Data.DataTable.AddColumn("Signoff","Edit","String")
	F.Data.DataTable.SetValue("Signoff",-1,"Edit","Edit")
	F.Data.DataTable.AddColumn("Signoff","Delete","String")
	F.Data.DataTable.SetValue("Signoff",-1,"Delete","Delete")
	
	V.Local.sSql.Set("Select '' as Doc_Link, CCA_NO, ECR, DATE_ENTERED, DUE_DATE, COMPLETED_DATE, ORIG_USER, rtrim(PRIORITY) as PRIORITY, rtrim(PROJECT_TYPE) as PROJECT_TYPE, rtrim(PART) as PART, rtrim(WO) as WO, rtrim(SO) as SO, ISSUE, rtrim(DESCRIPTION) as DESCRIPTION, rtrim(ROOT_CAUSE) as ROOT_CAUSE,rtrim(ACTION_PLAN) as ACTION_PLAN, STATUS, rtrim(ASSIGNED_Dept) as ASSIGNED_Dept, rtrim(ASSIGNED_TO) as ASSIGNED_TO,rtrim(Source) as Source, EST_COST_INC, rtrim(WorkGroup) as WorkGroup, QA_SIGNOFF, QA_USER, ADD_Group_1, Group_1_SIGNOFF, Group_1_USER, ADD_Group_2, Group_2_SIGNOFF, Group_2_USER, '' as ORIG_DRAWNBY, '' as ORIG_MODELBY, '' as ORIG_CHECKBY FROM GCG_5398_CAR Where Status = 'Complete - Awaiting Signoff' and QA_SIGNOFF = 1 ORDER BY CCA_NO")
	F.Data.DataTable.CreateFromSQL("Complete","con",V.Local.sSql,True)
	
	V.Local.sSql.Set("Select ECR, DATE_ENTERED, DUE_DATE, COMPLETED_DATE, ORIG_USER, rtrim(PRIORITY) as PRIORITY, rtrim(PROJECT_TYPE) as PROJECT_TYPE, rtrim(ECC) as ECC, rtrim(PART) as PART, rtrim(WO) as WO, rtrim(SO) as SO, ISSUE, rtrim(DESCRIPTION) as DESCRIPTION, rtrim(ROOT_CAUSE) as ROOT_CAUSE,rtrim(ACTION_PLAN) as ACTION_PLAN, STATUS, rtrim(ASSIGNED_Dept) as ASSIGNED_Dept, rtrim(ASSIGNED_TO) as ASSIGNED_TO,rtrim(Source) as Source, EST_COST_INC, rtrim(WorkGroup) as WorkGroup, QA_SIGNOFF, QA_USER, ADD_Group_1, Group_1_SIGNOFF, Group_1_USER, ADD_Group_2, Group_2_SIGNOFF, Group_2_USER, ORIG_DRAWNBY, ORIG_MODELBY, ORIG_CHECKBY FROM GCG_5398_ECR Where Status = 'Complete - Awaiting Signoff' and QA_SIGNOFF = 1 ORDER BY ECR")
	F.Data.DataTable.CreateFromSQL("Temp","con",V.Local.sSql,True)
	F.Data.DataTable.Merge("Temp","Complete",True,4)
	F.Data.DataTable.Close("Temp")
	
	'creating Dictionaries to use to populate Drop Down List 
	'common issue DropDown LIst
	V.Local.sSql.Set("Select rtrim(Common_Issue), rtrim(Common_Issue) From GCG_5398_CCA_COM_ISS Order by Issue_No")
	F.Data.Dictionary.CreateFromSQL("COMISS","con",V.Local.sSql)
	F.Data.Dictionary.SetDefaultReturn("COMISS"," ")
	Gui.FormCCA/ECR.ddlIssue.AddItem(" ",0)
	Gui.FormCCA/ECR.ddlIssue.AddItems("Dictionary","COMISS")
	F.Data.Dictionary.Close("COMISS")
	'Project TYpe DropDown List
	V.Local.sSql.Set("Select rtrim(Project_Type), rtrim(Project_Type) From GCG_5398_Proj_Type Order by Proj_No")
	F.Data.Dictionary.CreateFromSQL("Project","con",V.Local.sSql)
	F.Data.Dictionary.SetDefaultReturn("Project"," ")
	Gui.FormCCA/ECR.ddlProjType.AddItem(" ",0)
	Gui.FormCCA/ECR.ddlProjType.addItems("Dictionary","Project")
	'Source DropDown List
	V.Local.sSql.Set("Select rtrim(Source), rtrim(Source) From GCG_5398_Source Order By Source_No")
	F.Data.Dictionary.CreateFromSQL("Source","con",V.Local.sSql)
	F.Data.Dictionary.SetDefaultReturn("Source"," ")
	Gui.FormCCA/ECR.ddlSource.AddItem(" ",0)
	Gui.FormCCA/ECR.ddlSource.addItems("Dictionary","Source")
	'WorkGroup DropDown list
	V.Local.sSql.Set("Select rtrim(Work_Group), rtrim(Work_Group) From V_WORKGROUP_HEAD Order by Work_Group")
	F.Data.Dictionary.CreateFromSQL("WG","con",V.Local.sSql)
	F.Data.Dictionary.SetDefaultReturn("WG"," ")
	Gui.FormCCA/ECR.ddlWG.AddItem(" ",0)
	Gui.FormCCA/ECR.ddlWG.AddItems("Dictionary","WG")
	F.Data.Dictionary.Close("WG")
	'Assigned Group DropDown List
	V.Local.sSql.Set("Select distinct rtrim(ENG_Group), rtrim(Eng_Group) From V_Eng_Group Where length(Eng_Group) = 4 order by Eng_Group")
	F.Data.Dictionary.CreateFromSql("Group","con",V.Local.sSql)
	F.Data.Dictionary.SetDefaultReturn("Group"," ")
	Gui.FormCCA/ECRSignoff.ddlAddGroup1.AddItem(" ",0)
	Gui.FormCCA/ECRSignoff.ddlAddGroup2.AddItem(" ",0)
	Gui.FormCCA/ECRSignoff.ddlAddGroup1.AddItems("Dictionary","Group")
	Gui.FormCCA/ECRSignoff.ddlAddGroup2.AddItems("Dictionary","Group")
	F.Data.Dictionary.Close("Group")
	
	'Priority DropDown List
	Gui.FormCCA/ECR.ddlPriority.AddItem(" ",0)
	Gui.FormCCA/ECR.ddlPriority.AddItem("Low",1)
	Gui.FormCCA/ECR.ddlPriority.AddItem("Medium",2)
	Gui.FormCCA/ECR.ddlPriority.AddItem("High",3)
	Gui.FormCCA/ECR.ddlPriority.AddItem("Critical",4)
	'Status Drop Down List
	Gui.FormCCA/ECR.ddlStatus.AddItem(" ",0)
	Gui.FormCCA/ECR.ddlStatus.AddItem("Assigned - Not Started",1)
	Gui.FormCCA/ECR.ddlStatus.AddItem("In Process",2)
	Gui.FormCCA/ECR.ddlStatus.AddItem("Complete - Awaiting Signoff",3)
	
	F.ODBC.Connection!Con.Close
	
	F.Intrinsic.Control.ExitSub

F.Intrinsic.Control.Catch
	F.Intrinsic.Control.If(V.Ambient.ErrorNumber,<>,0)
		F.Intrinsic.String.Build("Project: {0}{1}Subroutine: {2}{1}Error Occurred {3} with description {4}","GCG_5398_CAR_ECN.g2u",V.Ambient.NewLine,V.Ambient.CurrentSubroutine,V.Ambient.ErrorNumber,V.Ambient.ErrorDescription,V.Local.sError)
		F.Intrinsic.UI.Msgbox(V.Local.sError)
		F.Intrinsic.Control.CallSub(FormQC_UnLoad)
	F.Intrinsic.Control.EndIf
Function.Intrinsic.Control.EndTry
Program.Sub.Get_Data.End

Program.Sub.Set_Anchors.Start
F.Intrinsic.Control.Try
	V.Local.sError.Declare(String,"")
	
	'setting achors on the screen
	Gui.FormQC.GsGridControlCAR.Anchor(15)
	Gui.FormQC.GsGridControlECR.Anchor(15)
	Gui.FormQC.GsGridControlSignOff.Anchor(15)
	Gui.FormQC.GsGridControlCompleted.Anchor(15)
	Gui.FormQC.cmdRefresh.Anchor(9)
	Gui.FormQC.cmdAddRow.Anchor(9)
	Gui.FormQC.tabQC.Anchor(15)
	
	Gui.FormCCA/ECR.txtDesc.Anchor(13)
	Gui.FormCCA/ECR.txtActionPlan.Anchor(12)
	Gui.FormCCA/ECR.txtRootCause.Anchor(14)
	Gui.FormCCA/ECR.cmdCCAECRSave.Anchor(6)
	
	F.Intrinsic.Control.ExitSub

F.Intrinsic.Control.Catch
	F.Intrinsic.Control.If(V.Ambient.ErrorNumber,<>,0)
		F.Intrinsic.String.Build("Project: {0}{1}Subroutine: {2}{1}Error Occurred {3} with description {4}","GCG_5398_CAR_ECN.g2u",V.Ambient.NewLine,V.Ambient.CurrentSubroutine,V.Ambient.ErrorNumber,V.Ambient.ErrorDescription,V.Local.sError)
		F.Intrinsic.UI.Msgbox(V.Local.sError)
		F.Intrinsic.Control.CallSub(FormQC_UnLoad)
	F.Intrinsic.Control.EndIf
Function.Intrinsic.Control.EndTry
Program.Sub.Set_Anchors.End

Program.Sub.GsGridControlSignOff_RowcellClick.Start
F.Intrinsic.Control.Try
	V.Local.sError.Declare(String,"")
	V.Local.sSql.Declare(String,"")
	V.Local.sRet.Declare(String,"")
	V.Local.i.Declare(Long,0)
	V.Local.sFieldMap.Declare(String,"")
	V.Local.sFilter.Declare(String,"")
	V.Local.iRec.Declare(Long,-1)
	V.Local.sMsg.Declare(String,"")
	V.Local.sATGDoc.Declare(String,"")
	V.Local.iTemp.Declare(Long,0)
	V.Local.bQlty.Declare(Boolean,False)
	V.Local.bGroup1.Declare(Boolean,False)
	V.Local.bGroup2.Declare(Boolean,False)
	V.Local.iCCAECR.Declare(Long,0)
	V.Local.iRet.Declare(Long,0)
	V.Local.iC.Declare(Long,0)
	
	F.Intrinsic.Control.SelectCase(V.Args.Column.UCase)
		F.Intrinsic.Control.Case("EDIT")		
			'saving record back to database
			'if it's been signed off by qa moving to the complete grid.
			'updating selected row so it's current to what's in the database.
			Gui.FormCCA/ECRSignoff.chkAddGroup1Signoff.Value(0)
			Gui.FormCCA/ECRSignoff.chkAddGroup2Signoff.Value(0)
			Gui.FormCCA/ECRSignoff.chkQCSignoff.Value(0)
			Gui.FormCCA/ECRSignoff.txtGroup1User.Text("")
			Gui.FormCCA/ECRSignoff.txtGroup2User.Text("")
			Gui.FormCCA/ECRSignoff.txtQCUser.Text("")
			Gui.FormCCA/ECRSignoff.ddlAddGroup1.Text("")
			Gui.FormCCA/ECRSignoff.ddlAddGroup2.Text("")
			
			F.Intrinsic.Control.If(V.DataTable.Signoff(V.Args.RowIndex).CCA_NO!FieldValTrim,<>,"")
				F.ODBC.Connection!Con.OpenCompanyConnection
				V.Local.iCCAECR.Set(V.DataTable.Signoff(V.Args.RowIndex).CCA_No!FieldValLong)
				F.Intrinsic.String.Build("Select GSS_User From GCG_5398_RECORD_LOCK Where Record_Type = 'CCA' and Record_NO = {0}",V.DataTable.Signoff(V.Args.RowIndex).CCA_No!FieldValLong,V.Local.sSql)
				F.ODBC.Connection!Con.ExecuteAndReturn(V.Local.sSql,V.Local.sSql)
				F.Intrinsic.Control.If(V.Local.sSql.Length,=,0)
					F.Intrinsic.String.Build("Select CCA_NO, ECR, DATE_ENTERED, DUE_DATE, ORIG_USER, PRIORITY, rtrim(PROJECT_TYPE) as PROJECT_TYPE, rtrim(PART) as PART, rtrim(WO) as WO, rtrim(SO) as SO, ISSUE, rtrim(DESCRIPTION) as DESCRIPTION, STATUS, rtrim(ASSIGNED_Dept) as ASSIGNED_Dept, rtrim(ASSIGNED_TO) as ASSIGNED_TO, EST_COST_INC, rtrim(WorkGroup) as WorkGroup, QA_SIGNOFF, QA_USER, ADD_Group_1, Group_1_SIGNOFF, Group_1_USER, ADD_Group_2, Group_2_SIGNOFF, Group_2_USER FROM GCG_5398_CAR Where CCA_No = {0}",V.DataTable.Signoff(V.Args.RowIndex).CCA_No!FieldVal,V.Local.sSql)
					F.Data.DataTable.CreateFromSQL("Temp","con",V.Local.sSql)
					F.Intrinsic.Control.If(V.DataTable.Temp(V.DataTable.Temp.RowCount--).QA_Signoff!FieldVal)
						F.Intrinsic.String.Build("Selected CCA: {0} is already signed off and has been moved to completed tab.",V.DataTable.Temp(V.DataTable.Temp).CCA_NO!FieldVal,V.Local.sMsg)
						F.Intrinsic.UI.Msgbox(V.Local.sMsg)
						F.Data.DataTable.AddRow("Complete","CCA_NO",V.DataTable.Temp(V.DataTable.Temp.RowCount--).CCA_NO!FieldVal,"ECR",V.DataTable.Temp(V.DataTable.Temp.RowCount--).ECR!FieldVal,"DATE_ENTERED",V.DataTable.Temp(V.DataTable.Temp.RowCount--).DATE_ENTERED!FieldVal,"DUE_DATE",V.DataTable.Temp(V.DataTable.Temp.RowCount--).DUE_DATE!FieldVal,"ORIG_USER",V.DataTable.Temp(V.DataTable.Temp.RowCount--).ORIG_USER!FieldVal,"PRIORITY",V.DataTable.Temp(V.DataTable.Temp.RowCount--).PRIORITY!FieldVal,"PROJECT_TYPE",V.DataTable.Temp(V.DataTable.Temp.RowCount--).PROJECT_TYPE!FieldVal,"PART",V.DataTable.Temp(V.DataTable.Temp.RowCount--).PART!FieldVal,"WO",V.DataTable.Temp(V.DataTable.Temp.RowCount--).WO!FieldVal,"SO",V.DataTable.Temp(V.DataTable.Temp.RowCount--).SO!FieldVal,"ISSUE",V.DataTable.Temp(V.DataTable.Temp.RowCount--).ISSUE!FieldVal,"DESCRIPTION",V.DataTable.Temp(V.DataTable.Temp.RowCount--).DESCRIPTION!FieldVal,"STATUS",V.DataTable.Temp(V.DataTable.Temp.RowCount--).STATUS!FieldVal,"ASSIGNED_Dept",V.DataTable.Temp(V.DataTable.Temp.RowCount--).ASSIGNED_Dept!FieldVal,"ASSIGNED_TO",V.DataTable.Temp(V.DataTable.Temp.RowCount--).ASSIGNED_TO!FieldVal,"EST_COST_INC",V.DataTable.Temp(V.DataTable.Temp.RowCount--).EST_COST_INC!FieldVal,"WorkGroup",V.DataTable.Temp(V.DataTable.Temp.RowCount--).WorkGroup!FieldVal,"QA_SIGNOFF",V.DataTable.Temp(V.DataTable.Temp.RowCount--).QA_SIGNOFF!FieldVal,"QA_USER",V.DataTable.Temp(V.DataTable.Temp.RowCount--).QA_USER!FieldVal,"ADD_Group_1",V.DataTable.Temp(V.DataTable.Temp.RowCount--).ADD_Group_1!FieldVal,"Group_1_SIGNOFF",V.DataTable.Temp(V.DataTable.Temp.RowCount--).Group_1_SIGNOFF!FieldVal,"Group_1_USER",V.DataTable.Temp(V.DataTable.Temp.RowCount--).Group_1_USER!FieldVal,"ADD_Group_2",V.DataTable.Temp(V.DataTable.Temp.RowCount--).ADD_Group_2!FieldVal,"Group_2_SIGNOFF",V.DataTable.Temp(V.DataTable.Temp.RowCount--).Group_2_SIGNOFF!FieldVal,"Group_2_USER",V.DataTable.Temp(V.DataTable.Temp.RowCount--).Group_2_USER!FieldVal)
						F.Data.DataTable.DeleteRow("Signoff",V.Args.RowIndex)
						F.Data.DataTable.AcceptChanges("Signoff")
						F.ODBC.Connection!Con.Close
					F.Intrinsic.Control.Else
						'Disabling Controls that are not needed 
						Gui.FormCCA/ECRSignoff.chkAddGroup1Signoff.Enabled(False)
						Gui.FormCCA/ECRSignoff.chkAddGroup2Signoff.Enabled(False)
						Gui.FormCCA/ECRSignoff.ddlAddGroup1.Enabled(False)
						Gui.FormCCA/ECRSignoff.ddlAddGroup2.Enabled(False)
						Gui.FormCCA/ECRSignoff.cmdSendEmails.Visible(False)
						Gui.FormCCA/ECRSignoff.chkQCSignoff.Enabled(False)		
						F.Intrinsic.String.Build("Select Eng_Group From V_Eng_Group Where User_ID = '{0}'",V.Caller.User.Trim,V.Local.sSql)
						F.ODBC.Connection!Con.ExecuteAndReturn(V.Local.sSql,V.Local.sRet)
						F.Intrinsic.String.Split(V.Local.sRet,"#$#",V.Local.sRet)	
						F.Intrinsic.Control.For(V.Local.i,0,V.Local.sRet.UBound,1)
							F.Intrinsic.Control.If(V.Local.sRet(V.Local.i).Trim,=,"QLTY")
								V.Local.bQlty.Set(True)
								'Disabling and Enabling controls that are needed
								Gui.FormCCA/ECRSignoff.chkAddGroup1Signoff.Enabled(False)
								Gui.FormCCA/ECRSignoff.chkAddGroup2Signoff.Enabled(False)
								Gui.FormCCA/ECRSignoff.ddlAddGroup1.Enabled(True)
								Gui.FormCCA/ECRSignoff.ddlAddGroup2.Enabled(True)
								Gui.FormCCA/ECRSignoff.cmdSendEmails.Visible(True)
								Gui.FormCCA/ECRSignoff.chkQCSignoff.Enabled(True)
								F.Intrinsic.Control.ExitFor(V.Local.i)
							F.Intrinsic.Control.EndIf
						F.Intrinsic.Control.Next(V.Local.i)
						
						F.Intrinsic.Control.BlockEvents
						
						F.Intrinsic.Control.If(V.DataTable.Signoff(V.Args.RowIndex).ADD_Group_1!FieldValTrim,<>,"")
							'check if user is in the Group
							'signing off on the step if user is in the assigned Group
							F.Intrinsic.String.Build("Select Eng_Group From V_Eng_Group Where User_ID = '{0}'",V.Caller.User.Trim,V.Local.sSql)
							F.ODBC.Connection!Con.ExecuteAndReturn(V.Local.sSql,V.Local.sRet)
							F.Intrinsic.String.Split(V.Local.sRet,"#$#",V.Local.sRet)
							F.Intrinsic.Control.For(V.Local.iC,0,V.Local.sRet.UBound,1)
								F.Intrinsic.Control.If(V.Local.sRet(V.Local.iC).Trim,=,V.DataTable.Signoff(V.Args.RowIndex).ADD_Group_1!FieldValTrim)
									V.Local.bGroup1.Set(True)
									Gui.FormCCA/ECRSignoff.chkAddGroup1Signoff.Enabled(True)
									F.Intrinsic.Control.If(V.Local.bQlty,=,False)
										Gui.FormCCA/ECRSignoff.ddlAddGroup1.Enabled(False)
										Gui.FormCCA/ECRSignoff.cmdSendEmails.Visible(False)
									F.Intrinsic.Control.EndIf
								F.Intrinsic.Control.EndIf
							F.Intrinsic.Control.Next(V.Local.iC)
						F.Intrinsic.Control.EndIf
						
						F.Intrinsic.Control.If(V.DataTable.Signoff(V.Args.RowIndex).ADD_Group_2!FieldValTrim,<>,"")
							F.Intrinsic.String.Build("Select Eng_Group From V_Eng_Group Where User_ID = '{0}'",V.Caller.User.Trim,V.Local.sSql)
							F.ODBC.Connection!Con.ExecuteAndReturn(V.Local.sSql,V.Local.sRet)
							F.Intrinsic.String.Split(V.Local.sRet,"#$#",V.Local.sRet)
							F.Intrinsic.Control.For(V.Local.iC,0,V.Local.sRet.UBound,1)
								F.Intrinsic.Control.If(V.Local.sRet(V.Local.iC).Trim,=,V.DataTable.Signoff(V.Args.RowIndex).ADD_Group_2!FieldValTrim)
									V.Local.bGroup2.Set(True)
									Gui.FormCCA/ECRSignoff.chkAddGroup2Signoff.Enabled(True)
									F.Intrinsic.Control.If(V.Local.bQlty,=,False)
										Gui.FormCCA/ECRSignoff.ddlAddGroup2.Enabled(False)
										Gui.FormCCA/ECRSignoff.cmdSendEmails.Visible(False)
									F.Intrinsic.Control.EndIf
								F.Intrinsic.Control.EndIf
							F.Intrinsic.Control.Next(V.Local.iC)
						F.Intrinsic.Control.EndIf
						
						F.Intrinsic.Control.UnBlockEvents
						
						F.Intrinsic.Control.If(V.Local.bGroup1,=,True,"OR",V.Local.bGroup2,=,True,V.Local.bQlty,=,True)
							Gui.FormCCA/ECRSignoff.cmdSaveSignoff.Enabled(False)
							'updating grid to make sure all information is uptodate
							F.Intrinsic.String.Build("Insert Into GCG_5398_RECORD_LOCK (Record_Type,Record_No,GSS_User) VALUES('{0}',{1},'{2}')","CCA",V.Local.iCCAECR,V.Caller.User.Trim,V.Local.sSql)
							F.ODBC.Connection!Con.Execute(V.Local.sSql)
							F.Data.DataTable.SetValue("Signoff",V.Args.RowIndex,"DATE_ENTERED",V.DataTable.Temp(V.DataTable.Temp.RowCount--).DATE_ENTERED!FieldVal,"DUE_DATE",V.DataTable.Temp(V.DataTable.Temp.RowCount--).DUE_DATE!FieldVal,"ORIG_USER",V.DataTable.Temp(V.DataTable.Temp.RowCount--).ORIG_USER!FieldVal,"PRIORITY",V.DataTable.Temp(V.DataTable.Temp.RowCount--).PRIORITY!FieldVal,"PROJECT_TYPE",V.DataTable.Temp(V.DataTable.Temp.RowCount--).PROJECT_TYPE!FieldVal,"PART",V.DataTable.Temp(V.DataTable.Temp.RowCount--).PART!FieldVal,"WO",V.DataTable.Temp(V.DataTable.Temp.RowCount--).WO!FieldVal,"SO",V.DataTable.Temp(V.DataTable.Temp.RowCount--).SO!FieldVal,"ISSUE",V.DataTable.Temp(V.DataTable.Temp.RowCount--).ISSUE!FieldVal,"DESCRIPTION",V.DataTable.Temp(V.DataTable.Temp.RowCount--).DESCRIPTION!FieldVal,"STATUS",V.DataTable.Temp(V.DataTable.Temp.RowCount--).STATUS!FieldVal,"ASSIGNED_Dept",V.DataTable.Temp(V.DataTable.Temp.RowCount--).ASSIGNED_Dept!FieldVal,"ASSIGNED_TO",V.DataTable.Temp(V.DataTable.Temp.RowCount--).ASSIGNED_TO!FieldVal,"EST_COST_INC",V.DataTable.Temp(V.DataTable.Temp.RowCount--).EST_COST_INC!FieldVal,"WorkGroup",V.DataTable.Temp(V.DataTable.Temp.RowCount--).WorkGroup!FieldVal,"QA_SIGNOFF",V.DataTable.Temp(V.DataTable.Temp.RowCount--).QA_SIGNOFF!FieldVal,"QA_USER",V.DataTable.Temp(V.DataTable.Temp.RowCount--).QA_USER!FieldVal,"ADD_Group_1",V.DataTable.Temp(V.DataTable.Temp.RowCount--).ADD_Group_1!FieldVal,"Group_1_SIGNOFF",V.DataTable.Temp(V.DataTable.Temp.RowCount--).Group_1_SIGNOFF!FieldVal,"Group_1_USER",V.DataTable.Temp(V.DataTable.Temp.RowCount--).Group_1_USER!FieldVal,"ADD_Group_2",V.DataTable.Temp(V.DataTable.Temp.RowCount--).ADD_Group_2!FieldVal,"Group_2_SIGNOFF",V.DataTable.Temp(V.DataTable.Temp.RowCount--).Group_2_SIGNOFF!FieldVal,"Group_2_USER",V.DataTable.Temp(V.DataTable.Temp.RowCount--).Group_2_USER!FieldVal)
							'populating signoff form
							F.Intrinsic.String.Build("CAPA: {0}",V.DataTable.Signoff(V.Args.RowIndex).CCA_No!FieldValLong,V.Local.sMsg)
							Gui.FormCCA/ECRSignoff.lblCCA/ECR.Caption(V.Local.sMsg)
							F.Intrinsic.Control.BlockEvents
							Gui.FormCCA/ECRSignoff.ddlAddGroup1.Text(V.DataTable.Signoff(V.Args.RowIndex).Add_Group_1!FieldValTrim)
							Gui.FormCCA/ECRSignoff.txtGroup1User.Text(V.DataTable.Signoff(V.Args.RowIndex).Group_1_USER!FieldValTrim)
							F.Intrinsic.Control.If(V.DataTable.Signoff(V.Args.RowIndex).Group_1_SIGNOFF!FieldVal)
								Gui.FormCCA/ECRSignoff.chkAddGroup1Signoff.Value(1)
							F.Intrinsic.Control.Else
								Gui.FormCCA/ECRSignoff.chkAddGroup1Signoff.Value(0)
							F.Intrinsic.Control.EndIf
							Gui.FormCCA/ECRSignoff.ddlAddGroup2.Text(V.DataTable.Signoff(V.Args.RowIndex).Add_Group_2!FieldValTrim)
							Gui.FormCCA/ECRSignoff.txtGroup2User.Text(V.DataTable.Signoff(V.Args.RowIndex).Group_2_USER!FieldValTrim)
							F.Intrinsic.Control.If(V.DataTable.Signoff(V.Args.RowIndex).Group_2_SIGNOFF!FieldVal)
								Gui.FormCCA/ECRSignoff.chkAddGroup2Signoff.Value(1)
							F.Intrinsic.Control.Else
								Gui.FormCCA/ECRSignoff.chkAddGroup2Signoff.Value(0)
							F.Intrinsic.Control.EndIf			
							F.Intrinsic.Control.UnBlockEvents
							F.ODBC.Connection!Con.Close
							Gui.FormQC..Enabled(False)
							F.Intrinsic.Control.BlockEvents
							Gui.FormCCA/ECRSignoff..Show
							F.Intrinsic.Control.UnBlockEvents
							
							Gui.FormCCA/ECRSignoff..WaitForDismiss
							'removing record lock
							F.ODBC.Connection!Con.OpenCompanyConnection
							F.Intrinsic.String.Build("Delete From GCG_5398_RECORD_LOCK Where Record_Type = 'CCA' and GSS_User = '{0}' and Record_No = {1}",V.Caller.User.Trim,V.Local.iCCAECR,V.Local.sSql)
							F.ODBC.Connection!Con.Execute(V.Local.sSql)
							F.ODBC.Connection!con.Close
							Gui.FormQC..Enabled(True)
							Gui.FormQC..AlwaysOnTop(True)
							Gui.FormQC..AlwaysOnTop(False)
						F.Intrinsic.Control.Else
							F.Intrinsic.String.Build("Delete From GCG_5398_RECORD_LOCK Where Record_Type = 'CCA' and GSS_User = '{0}' and Record_No = {1}",V.Caller.User.Trim,V.Local.iCCAECR,V.Local.sSql)
							F.ODBC.Connection!Con.Execute(V.Local.sSql)
							F.Intrinsic.UI.Msgbox("No Additional Group Assigned","Attention")
							F.ODBC.Connection!Con.Close
							Gui.FormQC..Enabled(True)
							Gui.FormQC..AlwaysOnTop(True)
							Gui.FormQC..AlwaysOnTop(False)
						F.Intrinsic.Control.EndIf
					F.Intrinsic.Control.EndIf
				F.Intrinsic.Control.Else
					F.Intrinsic.String.Build("CAPA: {0} is locked by User: {1}",V.DataTable.Signoff(V.Args.RowIndex).CCA_No!FieldValLong,V.Local.sSql,V.Local.sSql)
					F.Intrinsic.UI.Msgbox(V.Local.sSql)
				F.Intrinsic.Control.EndIf
			F.Intrinsic.Control.Else
				F.ODBC.Connection!Con.OpenCompanyConnection
				V.Local.iCCAECR.Set(V.DataTable.Signoff(V.Args.RowIndex).ECR!FieldValLong)
				F.Intrinsic.String.Build("Select GSS_User From GCG_5398_RECORD_LOCK Where Record_Type = 'ECR' and Record_NO = {0}",V.DataTable.Signoff(V.Args.RowIndex).ECR!FieldValLong,V.Local.sSql)
				F.ODBC.Connection!Con.ExecuteAndReturn(V.Local.sSql,V.Local.sSql)
				F.Intrinsic.Control.If(V.Local.sSql.Length,=,0)
					'checking current status of selected ECR
					F.Intrinsic.String.Build("Select ECR, DATE_ENTERED, DUE_DATE, ORIG_USER, PRIORITY, rtrim(PROJECT_TYPE) as PROJECT_TYPE, rtrim(PART) as PART, rtrim(WO) as WO, rtrim(SO) as SO, ISSUE, rtrim(DESCRIPTION) as DESCRIPTION, STATUS, rtrim(ASSIGNED_Dept) as ASSIGNED_Dept, rtrim(ASSIGNED_TO) as ASSIGNED_TO, EST_COST_INC, rtrim(WorkGroup) as WorkGroup, QA_SIGNOFF, QA_USER, ADD_Group_1, Group_1_SIGNOFF, Group_1_USER, ADD_Group_2, Group_2_SIGNOFF, Group_2_USER FROM GCG_5398_ECR Where ECR = {0}",V.DataTable.Signoff(V.Args.RowIndex).ECR!FieldVal,V.Local.sSql)
					F.Data.DataTable.CreateFromSQL("Temp","con",V.Local.sSql)
					F.Intrinsic.Control.If(V.DataTable.Temp(V.DataTable.Temp.RowCount--).QA_Signoff!FieldVal)
						F.Intrinsic.String.Build("Selected ECR: {0} is already signed off and has been moved to completed tab.",V.Local.iCCAECR,V.Local.sMsg)
						F.Intrinsic.UI.Msgbox(V.Local.sMsg)
						F.Data.DataTable.AddRow("Complete","ECR",V.DataTable.Temp(V.DataTable.Temp.RowCount--).ECR!FieldVal,"DATE_ENTERED",V.DataTable.Temp(V.DataTable.Temp.RowCount--).DATE_ENTERED!FieldVal,"DUE_DATE",V.DataTable.Temp(V.DataTable.Temp.RowCount--).DUE_DATE!FieldVal,"ORIG_USER",V.DataTable.Temp(V.DataTable.Temp.RowCount--).ORIG_USER!FieldVal,"PRIORITY",V.DataTable.Temp(V.DataTable.Temp.RowCount--).PRIORITY!FieldVal,"PROJECT_TYPE",V.DataTable.Temp(V.DataTable.Temp.RowCount--).PROJECT_TYPE!FieldVal,"PART",V.DataTable.Temp(V.DataTable.Temp.RowCount--).PART!FieldVal,"WO",V.DataTable.Temp(V.DataTable.Temp.RowCount--).WO!FieldVal,"SO",V.DataTable.Temp(V.DataTable.Temp.RowCount--).SO!FieldVal,"ISSUE",V.DataTable.Temp(V.DataTable.Temp.RowCount--).ISSUE!FieldVal,"DESCRIPTION",V.DataTable.Temp(V.DataTable.Temp.RowCount--).DESCRIPTION!FieldVal,"STATUS",V.DataTable.Temp(V.DataTable.Temp.RowCount--).STATUS!FieldVal,"ASSIGNED_Dept",V.DataTable.Temp(V.DataTable.Temp.RowCount--).ASSIGNED_Dept!FieldVal,"ASSIGNED_TO",V.DataTable.Temp(V.DataTable.Temp.RowCount--).ASSIGNED_TO!FieldVal,"EST_COST_INC",V.DataTable.Temp(V.DataTable.Temp.RowCount--).EST_COST_INC!FieldVal,"WorkGroup",V.DataTable.Temp(V.DataTable.Temp.RowCount--).WorkGroup!FieldVal,"QA_SIGNOFF",V.DataTable.Temp(V.DataTable.Temp.RowCount--).QA_SIGNOFF!FieldVal,"QA_USER",V.DataTable.Temp(V.DataTable.Temp.RowCount--).QA_USER!FieldVal,"ADD_Group_1",V.DataTable.Temp(V.DataTable.Temp.RowCount--).ADD_Group_1!FieldVal,"Group_1_SIGNOFF",V.DataTable.Temp(V.DataTable.Temp.RowCount--).Group_1_SIGNOFF!FieldVal,"Group_1_USER",V.DataTable.Temp(V.DataTable.Temp.RowCount--).Group_1_USER!FieldVal,"ADD_Group_2",V.DataTable.Temp(V.DataTable.Temp.RowCount--).ADD_Group_2!FieldVal,"Group_2_SIGNOFF",V.DataTable.Temp(V.DataTable.Temp.RowCount--).Group_2_SIGNOFF!FieldVal,"Group_2_USER",V.DataTable.Temp(V.DataTable.Temp.RowCount--).Group_2_USER!FieldVal)
						F.Data.DataTable.DeleteRow("Signoff",V.Args.RowIndex)
						F.Data.DataTable.AcceptChanges("Signoff")
						F.ODBC.Connection!Con.Close
					F.Intrinsic.Control.Else
						'updating grid to make sure all information is uptodate
						Gui.FormCCA/ECRSignoff.chkAddGroup1Signoff.Enabled(False)
						Gui.FormCCA/ECRSignoff.chkAddGroup2Signoff.Enabled(False)
						Gui.FormCCA/ECRSignoff.ddlAddGroup1.Enabled(False)
						Gui.FormCCA/ECRSignoff.ddlAddGroup2.Enabled(False)
						Gui.FormCCA/ECRSignoff.cmdSendEmails.Visible(False)
						Gui.FormCCA/ECRSignoff.chkQCSignoff.Enabled(False)
						F.Intrinsic.String.Build("Insert Into GCG_5398_RECORD_LOCK (Record_Type,Record_No,GSS_User) VALUES('{0}',{1},'{2}')","ECR",V.Local.iCCAECR,V.Caller.User.Trim,V.Local.sSql)
						F.ODBC.Connection!Con.Execute(V.Local.sSql)
						F.Data.DataTable.SetValue("Signoff",V.Args.RowIndex,"DATE_ENTERED",V.DataTable.Temp(V.DataTable.Temp.RowCount--).DATE_ENTERED!FieldVal,"DUE_DATE",V.DataTable.Temp(V.DataTable.Temp.RowCount--).DUE_DATE!FieldVal,"ORIG_USER",V.DataTable.Temp(V.DataTable.Temp.RowCount--).ORIG_USER!FieldVal,"PRIORITY",V.DataTable.Temp(V.DataTable.Temp.RowCount--).PRIORITY!FieldVal,"PROJECT_TYPE",V.DataTable.Temp(V.DataTable.Temp.RowCount--).PROJECT_TYPE!FieldVal,"PART",V.DataTable.Temp(V.DataTable.Temp.RowCount--).PART!FieldVal,"WO",V.DataTable.Temp(V.DataTable.Temp.RowCount--).WO!FieldVal,"SO",V.DataTable.Temp(V.DataTable.Temp.RowCount--).SO!FieldVal,"ISSUE",V.DataTable.Temp(V.DataTable.Temp.RowCount--).ISSUE!FieldVal,"DESCRIPTION",V.DataTable.Temp(V.DataTable.Temp.RowCount--).DESCRIPTION!FieldVal,"STATUS",V.DataTable.Temp(V.DataTable.Temp.RowCount--).STATUS!FieldVal,"ASSIGNED_Dept",V.DataTable.Temp(V.DataTable.Temp.RowCount--).ASSIGNED_Dept!FieldVal,"ASSIGNED_TO",V.DataTable.Temp(V.DataTable.Temp.RowCount--).ASSIGNED_TO!FieldVal,"EST_COST_INC",V.DataTable.Temp(V.DataTable.Temp.RowCount--).EST_COST_INC!FieldVal,"WorkGroup",V.DataTable.Temp(V.DataTable.Temp.RowCount--).WorkGroup!FieldVal,"QA_SIGNOFF",V.DataTable.Temp(V.DataTable.Temp.RowCount--).QA_SIGNOFF!FieldVal,"QA_USER",V.DataTable.Temp(V.DataTable.Temp.RowCount--).QA_USER!FieldVal,"ADD_Group_1",V.DataTable.Temp(V.DataTable.Temp.RowCount--).ADD_Group_1!FieldVal,"Group_1_SIGNOFF",V.DataTable.Temp(V.DataTable.Temp.RowCount--).Group_1_SIGNOFF!FieldVal,"Group_1_USER",V.DataTable.Temp(V.DataTable.Temp.RowCount--).Group_1_USER!FieldVal,"ADD_Group_2",V.DataTable.Temp(V.DataTable.Temp.RowCount--).ADD_Group_2!FieldVal,"Group_2_SIGNOFF",V.DataTable.Temp(V.DataTable.Temp.RowCount--).Group_2_SIGNOFF!FieldVal,"Group_2_USER",V.DataTable.Temp(V.DataTable.Temp.RowCount--).Group_2_USER!FieldVal)
						F.Intrinsic.String.Build("Select Eng_Group From V_Eng_Group Where User_ID = '{0}'",V.Caller.User.Trim,V.Local.sSql)
						F.ODBC.Connection!Con.ExecuteAndReturn(V.Local.sSql,V.Local.sRet)			
						F.Intrinsic.String.Split(V.Local.sRet,"#$#",V.Local.sRet)
						F.Intrinsic.Control.For(V.Local.i,0,V.Local.sRet.UBound,1)
							F.Intrinsic.Control.If(V.Local.sRet(V.Local.i).Trim,=,"QLTY")
								V.Local.bQlty.Set(True)
								Gui.FormCCA/ECRSignoff.chkAddGroup1Signoff.Enabled(False)
								Gui.FormCCA/ECRSignoff.chkAddGroup2Signoff.Enabled(False)
								Gui.FormCCA/ECRSignoff.ddlAddGroup1.Enabled(True)
								Gui.FormCCA/ECRSignoff.ddlAddGroup2.Enabled(True)
								Gui.FormCCA/ECRSignoff.cmdSendEmails.Visible(True)
								Gui.FormCCA/ECRSignoff.chkQCSignoff.Enabled(True)
								F.Intrinsic.Control.ExitFor(V.Local.i)
							F.Intrinsic.Control.EndIf
						F.Intrinsic.Control.Next(V.Local.i)
						
						F.Intrinsic.Control.If(V.DataTable.Signoff(V.Args.RowIndex).ADD_Group_1!FieldValTrim,<>,"")
							'check if user is in the Group
							'signing off on the step if user is in the assigned Group
							F.Intrinsic.String.Build("Select Eng_Group From V_Eng_Group Where User_ID = '{0}'",V.Caller.User.Trim,V.Local.sSql)
							F.ODBC.Connection!Con.ExecuteAndReturn(V.Local.sSql,V.Local.sRet)
							F.Intrinsic.String.Split(V.Local.sRet,"#$#",V.Local.sRet)
							F.Intrinsic.Control.For(V.Local.iC,0,V.Local.sRet.UBound,1)
								F.Intrinsic.Control.If(V.Local.sRet(V.Local.iC).Trim,=,V.DataTable.Signoff(V.Args.RowIndex).ADD_Group_1!FieldValTrim)
									V.Local.bGroup1.Set(True)
									Gui.FormCCA/ECRSignoff.chkAddGroup1Signoff.Enabled(True)
									F.Intrinsic.Control.If(V.Local.bQlty,=,False)
										Gui.FormCCA/ECRSignoff.ddlAddGroup1.Enabled(False)
										Gui.FormCCA/ECRSignoff.cmdSendEmails.Visible(False)
									F.Intrinsic.Control.EndIf
								F.Intrinsic.Control.EndIf
							F.Intrinsic.Control.Next(V.Local.iC)
						F.Intrinsic.Control.EndIf
						
						F.Intrinsic.Control.If(V.DataTable.Signoff(V.Args.RowIndex).ADD_Group_2!FieldValTrim,<>,"")
							F.Intrinsic.String.Build("Select Eng_Group From V_Eng_Group Where User_ID = '{0}'",V.Caller.User.Trim,V.Local.sSql)
							F.ODBC.Connection!Con.ExecuteAndReturn(V.Local.sSql,V.Local.sRet)
							F.Intrinsic.String.Split(V.Local.sRet,"#$#",V.Local.sRet)
							F.Intrinsic.Control.For(V.Local.iC,0,V.Local.sRet.UBound,1)
								F.Intrinsic.Control.If(V.Local.sRet(V.Local.iC).Trim,=,V.DataTable.Signoff(V.Args.RowIndex).ADD_Group_2!FieldValTrim)
									V.Local.bGroup2.Set(True)
									Gui.FormCCA/ECRSignoff.chkAddGroup2Signoff.Enabled(True)
									F.Intrinsic.Control.If(V.Local.bQlty,=,False)
										Gui.FormCCA/ECRSignoff.ddlAddGroup2.Enabled(False)
										Gui.FormCCA/ECRSignoff.cmdSendEmails.Visible(False)
									F.Intrinsic.Control.EndIf
									F.Intrinsic.Control.ExitFor(V.Local.i)
								F.Intrinsic.Control.EndIf
							F.Intrinsic.Control.Next(V.Local.iC)
						F.Intrinsic.Control.EndIf
						
						F.Intrinsic.Control.If(V.Local.bGroup1,=,True,"OR",V.Local.bGroup2,=,True,V.Local.bQlty,=,True)
							Gui.FormCCA/ECRSignoff.cmdSaveSignoff.Enabled(False)
							'updating grid to make sure all information is uptodate
							F.Intrinsic.String.Build("Insert Into GCG_5398_RECORD_LOCK (Record_Type,Record_No,GSS_User) VALUES('{0}',{1},'{2}')","ECR",V.Local.iCCAECR,V.Caller.User.Trim,V.Local.sSql)
							F.ODBC.Connection!Con.Execute(V.Local.sSql)
							F.Data.DataTable.SetValue("Signoff",V.Args.RowIndex,"DATE_ENTERED",V.DataTable.Temp(V.DataTable.Temp.RowCount--).DATE_ENTERED!FieldVal,"DUE_DATE",V.DataTable.Temp(V.DataTable.Temp.RowCount--).DUE_DATE!FieldVal,"ORIG_USER",V.DataTable.Temp(V.DataTable.Temp.RowCount--).ORIG_USER!FieldVal,"PRIORITY",V.DataTable.Temp(V.DataTable.Temp.RowCount--).PRIORITY!FieldVal,"PROJECT_TYPE",V.DataTable.Temp(V.DataTable.Temp.RowCount--).PROJECT_TYPE!FieldVal,"PART",V.DataTable.Temp(V.DataTable.Temp.RowCount--).PART!FieldVal,"WO",V.DataTable.Temp(V.DataTable.Temp.RowCount--).WO!FieldVal,"SO",V.DataTable.Temp(V.DataTable.Temp.RowCount--).SO!FieldVal,"ISSUE",V.DataTable.Temp(V.DataTable.Temp.RowCount--).ISSUE!FieldVal,"DESCRIPTION",V.DataTable.Temp(V.DataTable.Temp.RowCount--).DESCRIPTION!FieldVal,"STATUS",V.DataTable.Temp(V.DataTable.Temp.RowCount--).STATUS!FieldVal,"ASSIGNED_Dept",V.DataTable.Temp(V.DataTable.Temp.RowCount--).ASSIGNED_Dept!FieldVal,"ASSIGNED_TO",V.DataTable.Temp(V.DataTable.Temp.RowCount--).ASSIGNED_TO!FieldVal,"EST_COST_INC",V.DataTable.Temp(V.DataTable.Temp.RowCount--).EST_COST_INC!FieldVal,"WorkGroup",V.DataTable.Temp(V.DataTable.Temp.RowCount--).WorkGroup!FieldVal,"QA_SIGNOFF",V.DataTable.Temp(V.DataTable.Temp.RowCount--).QA_SIGNOFF!FieldVal,"QA_USER",V.DataTable.Temp(V.DataTable.Temp.RowCount--).QA_USER!FieldVal,"ADD_Group_1",V.DataTable.Temp(V.DataTable.Temp.RowCount--).ADD_Group_1!FieldVal,"Group_1_SIGNOFF",V.DataTable.Temp(V.DataTable.Temp.RowCount--).Group_1_SIGNOFF!FieldVal,"Group_1_USER",V.DataTable.Temp(V.DataTable.Temp.RowCount--).Group_1_USER!FieldVal,"ADD_Group_2",V.DataTable.Temp(V.DataTable.Temp.RowCount--).ADD_Group_2!FieldVal,"Group_2_SIGNOFF",V.DataTable.Temp(V.DataTable.Temp.RowCount--).Group_2_SIGNOFF!FieldVal,"Group_2_USER",V.DataTable.Temp(V.DataTable.Temp.RowCount--).Group_2_USER!FieldVal)
							'populating signoff form
							F.Intrinsic.String.Build("ECR: {0}",V.Local.iCCAECR,V.Local.sMsg)
							Gui.FormCCA/ECRSignoff.lblCCA/ECR.Caption(V.Local.sMsg)
							F.Intrinsic.Control.BlockEvents
							Gui.FormCCA/ECRSignoff.ddlAddGroup1.Text(V.DataTable.Signoff(V.Args.RowIndex).Add_Group_1!FieldValTrim)
							Gui.FormCCA/ECRSignoff.txtGroup1User.Text(V.DataTable.Signoff(V.Args.RowIndex).Group_1_USER!FieldValTrim)
							F.Intrinsic.Control.If(V.DataTable.Signoff(V.Args.RowIndex).Group_1_SIGNOFF!FieldVal)
								Gui.FormCCA/ECRSignoff.chkAddGroup1Signoff.Value(1)
							F.Intrinsic.Control.Else
								Gui.FormCCA/ECRSignoff.chkAddGroup1Signoff.Value(0)
							F.Intrinsic.Control.EndIf
							Gui.FormCCA/ECRSignoff.ddlAddGroup2.Text(V.DataTable.Signoff(V.Args.RowIndex).Add_Group_2!FieldValTrim)
							Gui.FormCCA/ECRSignoff.txtGroup2User.Text(V.DataTable.Signoff(V.Args.RowIndex).Group_2_USER!FieldValTrim)
							F.Intrinsic.Control.If(V.DataTable.Signoff(V.Args.RowIndex).Group_2_SIGNOFF!FieldVal)
								Gui.FormCCA/ECRSignoff.chkAddGroup2Signoff.Value(1)
							F.Intrinsic.Control.Else
								Gui.FormCCA/ECRSignoff.chkAddGroup2Signoff.Value(0)
							F.Intrinsic.Control.EndIf			
							F.Intrinsic.Control.UnBlockEvents
							F.ODBC.Connection!Con.Close
							Gui.FormQC..Enabled(False)
							F.Intrinsic.Control.BlockEvents
							Gui.FormCCA/ECRSignoff..Show
							F.Intrinsic.Control.UnBlockEvents
							Gui.FormCCA/ECRSignoff..WaitForDismiss
							'removing record lock on selected ECR.
							F.ODBC.Connection!Con.OpenCompanyConnection
							F.Intrinsic.String.Build("Delete From GCG_5398_RECORD_LOCK Where Record_Type = 'ECR' and GSS_User = '{0}' and Record_No = {1}",V.Caller.User.Trim,V.Local.iCCAECR,V.Local.sSql)
							F.ODBC.Connection!Con.Execute(V.Local.sSql)
							F.ODBC.Connection!con.Close
							Gui.FormQC..Enabled(True)
							Gui.FormQC..AlwaysOnTop(True)
							Gui.FormQC..AlwaysOnTop(False)
						F.Intrinsic.Control.Else
							'removing record lock on selected ECR.
							F.Intrinsic.String.Build("Delete From GCG_5398_RECORD_LOCK Where Record_Type = 'ECR' and GSS_User = '{0}' and Record_No = {1}",V.Caller.User.Trim,V.Local.iCCAECR,V.Local.sSql)
							F.ODBC.Connection!Con.Execute(V.Local.sSql)
							F.Intrinsic.UI.Msgbox("No Addtional Group Assigned","Attention")
							F.ODBC.Connection!Con.Close
							Gui.FormQC..Enabled(True)
							Gui.FormQC..AlwaysOnTop(True)
							Gui.FormQC..AlwaysOnTop(False)
						F.Intrinsic.Control.EndIf
						F.ODBC.Connection!Con.OpenCompanyConnection
						F.Intrinsic.String.Build("Delete From GCG_5398_RECORD_LOCK Where Record_Type = 'ECR' and GSS_User = '{0}' and Record_No = {1}",V.Caller.User.Trim,V.Local.iCCAECR,V.Local.sSql)
						F.ODBC.Connection!Con.Execute(V.Local.sSql)
						F.ODBC.Connection!con.Close
					F.Intrinsic.Control.EndIf
				F.Intrinsic.Control.Else
					F.ODBC.Connection!Con.Close
					F.Intrinsic.String.Build("ECR: {0} is locked by User: {1}",V.Local.iCCAECR,V.Local.sSql,V.Local.sSql)
					F.Intrinsic.UI.Msgbox(V.Local.sSql)
				F.Intrinsic.Control.EndIf
			F.Intrinsic.Control.EndIf

		F.Intrinsic.Control.Case("DOC_LINK")
			'launching document control
			'custom link 2010 used.
			F.Intrinsic.Control.If(V.DataTable.Signoff(V.Args.RowIndex).CCA_NO!Field,<>,"")
'				Function.Global.General.ResetPassedDataElements
'				F.Global.General.SetPassedDataElement("DATA-LINK-TYPE",2010)
				F.Intrinsic.String.Build("{0}-ECR",V.DataTable.Signoff(V.Args.RowIndex).CCA_NO!FieldValLong,V.Local.sRet)
'				F.Global.General.SetPassedDataElement("DATA-LINK-KEY",V.Local.sRet)
'				F.Global.General.SetPassedDataElement("DATA-LINK-DESC","Engineering Change Request")
				F.Global.DocumentControl.GetLinkID(V.Local.sRet,2010,V.Local.i)
				F.Intrinsic.Control.If(V.Local.i,=,-1)
					F.Global.DocumentControl.CreateReference(V.Local.sRet,2010,V.Local.i)
				F.Intrinsic.Control.EndIf
				F.Global.DocumentControl.Invoke(V.Local.sRet,2010,"Engineering Change Request",V.Local.i)
'				F.Intrinsic.String.Build("{0}\ATG_DocumentControl.gas",V.Caller.GasDir,V.Local.sATGDoc)
'				F.Global.General.CallAsyncGAS(V.Local.sATGDoc,V.Local.i)
			F.Intrinsic.Control.Else
'				Function.Global.General.ResetPassedDataElements
'				F.Global.General.SetPassedDataElement("DATA-LINK-TYPE",2010)
				F.Intrinsic.String.Build("Select CCA_NO From GCG_5398_CAR Where ECR = {0}",V.DataTable.Signoff(V.Args.RowIndex).ECR!FieldValLong,V.Local.sFilter)
				F.ODBC.Connection!Con.OpenCompanyConnection
				F.ODBC.Connection!Con.ExecuteAndReturn(V.Local.sFilter,V.Local.sFilter)
				F.ODBC.Connection!Con.Close
				F.Intrinsic.Control.If(V.Local.sFilter,<>,"")
					F.Intrinsic.String.Build("{0}-CCA",V.Local.sFilter.Long,V.Local.sRet)
				F.Intrinsic.Control.Else
					F.Intrinsic.String.Build("{0}-ECR",V.DataTable.Signoff(V.Args.RowIndex).ECR!FieldValLong,V.Local.sRet)
				F.Intrinsic.Control.EndIf
'				F.Global.General.SetPassedDataElement("DATA-LINK-KEY",V.Local.sRet)
'				F.Global.General.SetPassedDataElement("DATA-LINK-DESC","Engineering Change Request")
				F.Global.DocumentControl.GetLinkID(V.Local.sRet,2010,V.Local.i)
				F.Intrinsic.Control.If(V.Local.i,=,-1)
					F.Global.DocumentControl.CreateReference(V.Local.sRet,2010,V.Local.i)
				F.Intrinsic.Control.EndIf
				F.Global.DocumentControl.Invoke(V.Local.sRet,2010,"Engineering Change Request",V.Local.i)
'				F.Intrinsic.String.Build("{0}\ATG_DocumentControl.gas",V.Caller.GasDir,V.Local.sATGDoc)
'				F.Global.General.CallAsyncGAS(V.Local.sATGDoc,V.Local.i)
			F.Intrinsic.Control.EndIf
			
		F.Intrinsic.Control.Case("DELETE")
			F.ODBC.Connection!Con.OpenCompanyConnection
			F.Intrinsic.String.Build("Select GSS_User From GCG_5398_RECORD_LOCK Where Record_Type = 'CCA' and Record_NO = {0}",V.DataTable.Signoff(V.Args.RowIndex).CCA_NO!FieldVal,V.Local.sSql)
			F.ODBC.Connection!Con.ExecuteAndReturn(V.Local.sSql,V.Local.sRet)
			F.Intrinsic.Control.If(V.Local.sRet.Length,=,0)
				F.Intrinsic.Control.If(V.DataTable.Signoff(V.Args.RowIndex).ECR!FieldValLong,>,0)
					F.Intrinsic.UI.Msgbox("Current CAPA has a ECR.  Would you like to delete the ECR as well?","Attention",4,V.Local.iRet)
					F.Intrinsic.Control.If(V.Local.iRet,=,6)
						F.Intrinsic.String.Build("Select GSS_User From GCG_5398_RECORD_LOCK Where Record_Type = 'ECR' and Record_NO = {0}",V.DataTable.Signoff(V.Args.RowIndex).ECR!FieldValLong,V.Local.sSql)
						F.ODBC.Connection!Con.ExecuteAndReturn(V.Local.sSql,V.Local.sRet)
						F.Intrinsic.Control.If(V.Local.sRet.Length,=,0)
							F.Intrinsic.String.Build("Delete From GCG_5398_ECR Where ECR = {0}",V.DataTable.Signoff(V.Args.RowIndex).ECR!FieldVal,V.Local.sSql)
							F.ODBC.Connection!Con.Execute(V.Local.sSql)
							'removing from either the signoff or ecr datatable
							F.Intrinsic.String.Build("ECR = {0}",V.DataTable.Signoff(V.Args.RowIndex).ECR!FieldValLong,V.Local.sFilter)
							F.Data.DataView.Create("ECR","Remove",22,V.Local.sFilter,"")
							F.Intrinsic.Control.If(V.DataView.ECR!Remove.RowCount--,<>,-1)
								F.Data.DataTable.DeleteRow("ECR",V.DataView.ECR!Remove(V.DataView.ECR!Remove.RowCount--).DataTableIndex)
								F.Data.DataTable.AcceptChanges("ECR")
							F.Intrinsic.Control.Else
								F.Data.DataView.Create("Signoff","Remove",22,V.Local.sFilter,"")
								F.Intrinsic.Control.If(V.DataView.Signoff!Remove.RowCount--,<>,-1)
									F.Data.DataTable.DeleteRow("Signoff",V.DataView.Signoff!Remove(V.DataView.Signoff!Remove.RowCount--).DataTableIndex)
									F.Data.DataTable.AcceptChanges("Signoff")
								F.Intrinsic.Control.EndIf
							F.Intrinsic.Control.EndIf
							F.Data.DataView.Close("ECR","Remove")
						F.Intrinsic.Control.Else
							F.Intrinsic.String.Build("ECR: {0} is locked by User: {1}. ECR will need to be removed from the ECR tab.",V.DataTable.Signoff(V.Args.RowIndex).ECR!FieldVal,V.Local.sRet.Trim,V.Local.sRet)
							F.Intrinsic.UI.Msgbox(V.Local.sRet)
						F.Intrinsic.Control.EndIf
					F.Intrinsic.Control.EndIf
				F.Intrinsic.Control.EndIf
				F.Intrinsic.String.Build("Delete From GCG_5398_CAR Where CCA_NO = {0}",V.DataTable.Signoff(V.Args.RowIndex).CCA_NO!FieldVal,V.Local.sSql)
				F.ODBC.Connection!Con.Execute(V.Local.sSql)
				F.Data.DataTable.DeleteRow("Signoff",V.Args.RowIndex)
				F.Data.DataTable.AcceptChanges("Signoff")
			F.Intrinsic.Control.Else
				F.Intrinsic.String.Build("Selected CAPA: {0} is locked by User: {1}",V.DataTable.Signoff(V.Args.RowIndex).CCA_NO!FieldVal,V.Local.sRet.Trim,V.Local.sRet)
				F.Intrinsic.UI.Msgbox(V.Local.sRet)
			F.Intrinsic.Control.EndIf
			F.ODBC.Connection!Con.Close
			
	F.Intrinsic.Control.EndSelect
	
	F.Intrinsic.Control.ExitSub

F.Intrinsic.Control.Catch
	F.Intrinsic.Control.If(V.Ambient.ErrorNumber,<>,0)
		F.Intrinsic.String.Build("Project: {0}{1}Subroutine: {2}{1}Error Occurred {3} with description {4}","GCG_5398_CAR_ECN.g2u",V.Ambient.NewLine,V.Ambient.CurrentSubroutine,V.Ambient.ErrorNumber,V.Ambient.ErrorDescription,V.Local.sError)
		F.Intrinsic.UI.Msgbox(V.Local.sError)
		F.Intrinsic.Control.CallSub(FormQC_UnLoad)
	F.Intrinsic.Control.EndIf
Function.Intrinsic.Control.EndTry
Program.Sub.GsGridControlSignOff_RowcellClick.End

Program.Sub.GsGridControlCAR_RowcellClick.Start
F.Intrinsic.Control.Try
	V.Local.sError.Declare(String,"")
	V.Local.iX.Declare(Long,0)
	V.Local.iY.Declare(Long,0)
	V.Local.sMsg.Declare(String,"")
	V.Local.sRet.Declare(String,"")
	V.Local.iIdentity.Declare(Long,0)
	V.Local.sSql.Declare(String,"")
	V.Local.sDate.Declare(String,"")
	V.Local.sTitles.Declare(String,"")
	V.Local.sWidths.Declare(String,"")
	V.Local.sFieldMap.Declare(String,"")
	V.Local.sFilter.Declare(String,"")
	V.Local.sATGDoc.Declare(String,"")
	V.Local.iCol.Declare(Long,0)
	V.Local.iCCA.Declare(Long,0)
	V.Local.iRet.Declare(Long,0)

	F.Intrinsic.Control.SelectCase(V.Args.Column.UCase)	
		F.Intrinsic.Control.Case("EDIT")
			Gui.FormCCA/ECR.lblECR.Caption("ECR")
			Gui.FormCCA/ECR.txtECR.Locked(True)
			Gui.FormCCA/ECR.cmdECC.Visible(False)
			Gui.FormCCA/ECR.chkECR.Visible(True)
			Gui.FormCCA/ECR.lblOrgCheck.Visible(False)
			Gui.FormCCA/ECR.lblOrgDrawn.Visible(False)
			Gui.FormCCA/ECR.lblModBy.Visible(False)
			Gui.FormCCA/ECR.txtOrgCheckBy.Visible(False)
			Gui.FormCCA/ECR.txtOrgDrawn.Visible(False)
			Gui.FormCCA/ECR.txtOrgModBy.Visible(False)
			Gui.FormCCA/ECR.cmdOrigCheck.Visible(False)
			Gui.FormCCA/ECR.cmdOrigDrawn.Visible(False)
			Gui.FormCCA/ECR.cmdOrigModBy.Visible(False)
			Gui.FormQC..Enabled(False)
			
			F.ODBC.Connection!Con.OpenCompanyConnection
			'letting user know that current row is locked by another user
			V.Local.iCCA.Set(V.DataTable.CAR(V.Args.RowIndex).CCA_No!FieldValLong)
			F.Intrinsic.String.Build("Select GSS_User From GCG_5398_RECORD_LOCK Where Record_Type = 'CCA' and Record_NO = {0}",V.DataTable.CAR(V.Args.RowIndex).CCA_No!FieldValLong,V.Local.sSql)
			F.ODBC.Connection!Con.ExecuteAndReturn(V.Local.sSql,V.Local.sSql)
			F.Intrinsic.Control.If(V.Local.sSql.Length,=,0)
				F.Intrinsic.String.Build("Select CCA_NO, ECR, DATE_ENTERED, DUE_DATE, ORIG_USER, PRIORITY, rtrim(PROJECT_TYPE) as PROJECT_TYPE, rtrim(PART) as PART, rtrim(WO) as WO, rtrim(SO) as SO, ISSUE, rtrim(DESCRIPTION) as DESCRIPTION, rtrim(Source) as Source, rtrim(Action_Plan) as Action_Plan, rtrim(Root_Cause) as Root_Cause, STATUS, rtrim(ASSIGNED_Dept) as ASSIGNED_Dept, rtrim(ASSIGNED_TO) as ASSIGNED_TO, EST_COST_INC, rtrim(WorkGroup) as WorkGroup FROM GCG_5398_CAR Where CCA_NO = {0}",V.DataTable.CAR(V.Args.RowIndex).CCA_No!FieldValLong,V.Local.sSql)
				F.Data.DataTable.CreateFromSQL("Temp","con",V.Local.sSql)
				F.Intrinsic.Control.If(V.DataTable.Temp(V.DataTable.Temp.RowCount--).Status!FieldValTrim,=,"Complete - Awaiting Signoff")
					F.Intrinsic.String.Build("Selected CAPA: {0} is already completed and has been moved to signoff tab.","Attention",V.DataTable.Temp(V.DataTable.Temp.RowCount--).CCA_NO!FieldVal,V.Local.sMsg)
					F.Intrinsic.UI.Msgbox(V.Local.sMsg)
					F.Data.DataTable.DeleteRow("CAR",V.Args.RowIndex)
					F.Data.DataTable.AcceptChanges("CAR")
					F.ODBC.Connection!Con.Close
					Gui.FormQC..Enabled(True)
				F.Intrinsic.Control.Else
					'updating grid to make sure all information is uptodate
					F.Intrinsic.String.Build("Insert Into GCG_5398_RECORD_LOCK (Record_Type,Record_No,GSS_User) VALUES('{0}',{1},'{2}')","CCA",V.DataTable.CAR(V.Args.RowIndex).CCA_No!FieldValLong,V.Caller.User.Trim,V.Local.sSql)
					F.ODBC.Connection!Con.Execute(V.Local.sSql)
					F.Data.DataTable.SetValue("CAR",V.Args.RowIndex,"ECR",V.DataTable.Temp(V.DataTable.Temp.RowCount--).ECR!FieldVal,"DATE_ENTERED",V.DataTable.Temp(V.DataTable.Temp.RowCount--).DATE_ENTERED!FieldVal,"ORIG_USER",V.DataTable.Temp(V.DataTable.Temp.RowCount--).ORIG_USER!FieldValTrim,"PROJECT_TYPE",V.DataTable.Temp(V.DataTable.Temp.RowCount--).PROJECT_TYPE!FieldValTrim,"PART",V.DataTable.Temp(V.DataTable.Temp.RowCount--).PART!FieldValTrim,"WO",V.DataTable.Temp(V.DataTable.Temp.RowCount--).WO!FieldValTrim,"SO",V.DataTable.Temp(V.DataTable.Temp.RowCount--).SO!FieldValTrim,"ISSUE",V.DataTable.Temp(V.DataTable.Temp.RowCount--).ISSUE!FieldValTrim,"DESCRIPTION",V.DataTable.Temp(V.DataTable.Temp.RowCount--).DESCRIPTION!FieldValTrim,"STATUS",V.DataTable.Temp(V.DataTable.Temp.RowCount--).STATUS!FieldValTrim,"ASSIGNED_Dept",V.DataTable.Temp(V.DataTable.Temp.RowCount--).ASSIGNED_Dept!FieldValTrim,"ASSIGNED_TO",V.DataTable.Temp(V.DataTable.Temp.RowCount--).ASSIGNED_TO!FieldValTrim,"DUE_DATE",V.DataTable.Temp(V.DataTable.Temp.RowCount--).DUE_DATE!FieldVal,"PRIORITY",V.DataTable.Temp(V.DataTable.Temp.RowCount--).PRIORITY!FieldValTrim,"EST_COST_INC",V.DataTable.Temp(V.DataTable.Temp.RowCount--).EST_COST_INC!FieldVal,"WorkGroup",V.DataTable.Temp(V.DataTable.Temp.RowCount--).WorkGroup!FieldValTrim)
					F.Intrinsic.String.Build("CAPA: {0}",V.DataTable.CAR(V.Args.RowIndex).CCA_NO!FieldValLong,V.Local.sMsg)
					F.Intrinsic.Control.BlockEvents
					Gui.FormCCA/ECR.lblCCA/ECR.Caption(V.Local.sMsg)
					gui.FormCCA/ECR.txtDept.Text(V.DataTable.CAR(V.Args.RowIndex).ASSIGNED_Dept!FieldValTrim)
					Gui.FormCCA/ECR.txtDesc.Text(V.DataTable.CAR(V.Args.RowIndex).Description!FieldValTrim)
					Gui.FormCCA/ECR.txtECR.Text(V.DataTable.CAR(V.Args.RowIndex).ECR!FieldVal)
					Gui.FormCCA/ECR.txtESTCost.Text(V.DataTable.CAR(V.Args.RowIndex).Est_Cost_Inc!FieldValFloat)
					Gui.FormCCA/ECR.txtPart.Text(V.DataTable.CAR(V.Args.RowIndex).Part!FieldValTrim)
					Gui.FormCCA/ECR.txtSO.Text(V.DataTable.CAR(V.Args.RowIndex).SO!FieldValTrim)
					Gui.FormCCA/ECR.txtWO.Text(V.DataTable.CAR(V.Args.RowIndex).WO!FieldValTrim)
					Gui.FormCCA/ECR.ddlIssue.Text(V.DataTable.CAR(V.Args.RowIndex).Issue!FieldValTrim)
					Gui.FormCCA/ECR.ddlPriority.Text(V.DataTable.CAR(V.Args.RowIndex).Priority!FieldValTrim)
					Gui.FormCCA/ECR.ddlProjType.Text(V.DataTable.CAR(V.Args.RowIndex).Project_Type!FieldValTrim)
					Gui.FormCCA/ECR.ddlStatus.Text(V.DataTable.CAR(V.Args.RowIndex).Status!FieldValTrim)
					Gui.FormCCA/ECR.ddlWG.Text(V.DataTable.CAR(V.Args.RowIndex).WorkGroup!FieldValTrim)
					Gui.FormCCA/ECR.ddlSource.Text(V.DataTable.CAR(V.Args.RowIndex).Source!FieldValTrim)
					Gui.FormCCA/ECR.txtActionPlan.Text(V.DataTable.CAR(V.Args.RowIndex).Action_Plan!FieldValTrim)
					Gui.FormCCA/ECR.txtRootCause.Text(V.DataTable.CAR(V.Args.RowIndex).Root_Cause!FieldValTrim)
					V.Local.sDate.Set(V.DataTable.CAR(V.Args.RowIndex).Due_Date!FieldVal)
					F.Intrinsic.Control.If(V.Local.sDate.Trim,=,"")
						Gui.FormCCA/ECR.dtpDueDate.Value(V.Ambient.Date)
					F.Intrinsic.Control.Else
						Gui.FormCCA/ECR.dtpDueDate.Value(V.Local.sDate.DateComp)
					F.Intrinsic.Control.EndIf
					'browser for current users for in selected Group
					F.Intrinsic.Control.If(V.DataTable.CAR(V.Args.RowIndex).ASSIGNED_Dept!FieldValTrim,<>,"")
'						F.Intrinsic.String.Build("Select rtrim(PR_User_ID), rtrim(PR_User_ID) From V_Employee_Mstr Where rtrim(Dept_Employee) = '{0}' and PR_User_ID <> ''",V.DataTable.CAR(V.Args.RowIndex).ASSIGNED_Dept!FieldValTrim,V.Local.sSql)
						F.Intrinsic.String.Build("Select rtrim(PR_User_ID), rtrim(PR_User_ID) From V_Employee_Mstr a Where a.Employee in (Select b.Employee From GCG_5398_Dept_Maint b Where b.Dept_ID = '{0}') and PR_User_ID <> ''",V.DataTable.CAR(V.Args.RowIndex).ASSIGNED_Dept!FieldValTrim,V.Local.sSql)
						F.Data.Dictionary.CreateFromSQL("AssignedTO","con",V.Local.sSql)
						Gui.FormCCA/ECR.ddlAssignedTo.ClearItems
						Gui.FormCCA/ECR.ddlAssignedTo.AddItem(" ",0)
						Gui.FormCCA/ECR.ddlAssignedTo.AddItems("Dictionary","AssignedTO")
						
						F.Data.Dictionary.Close("AssignedTO")
					F.Intrinsic.Control.EndIf
					Gui.FormCCA/ECR.ddlAssignedTo.Text(V.DataTable.CAR(V.Args.RowIndex).Assigned_To!FieldValTrim)
					Gui.FormCCA/ECR.chkECR.Visible(True)
			
					F.Intrinsic.Control.If(V.DataTable.CAR(V.Args.RowIndex).Ecr_Required!FieldVal)
						Gui.FormCCA/ECR.chkECR.Value(1)
						Gui.FormCCA/ECR.txtECR.Visible(True)
						Gui.FormCCA/ECR.lblECR.Visible(True)
						F.Intrinsic.Control.If(V.Screen.FormCCA/ECR!txtECR.Text,<>,"")
							Gui.FormCCA/ECR.chkECR.Enabled(False)
						F.Intrinsic.Control.Else
							Gui.FormCCA/ECR.chkECR.Enabled(True)
						F.Intrinsic.Control.EndIf
					F.Intrinsic.Control.Else
						Gui.FormCCA/ECR.chkECR.Value(0)
						Gui.FormCCA/ECR.txtECR.Visible(True)
						Gui.FormCCA/ECR.lblECR.Visible(True)
						Gui.FormCCA/ECR.chkECR.Enabled(True)
					F.Intrinsic.Control.EndIf
					F.Intrinsic.Control.UnBlockEvents
					Gui.FormCCA/ECR.cmdCCAECRSave.Enabled(False)
					F.Intrinsic.Control.BlockEvents
					Gui.FormCCA/ECR..Show
					F.Intrinsic.Control.UnBlockEvents
					F.ODBC.Connection!Con.Close
					Gui.FormCCA/ECR..WaitForDismiss
					
					F.ODBC.Connection!Con.OpenCompanyConnection
					
					F.Intrinsic.String.Build("Delete From GCG_5398_RECORD_LOCK Where Record_Type = '{0}' and Record_No = {1} and GSS_User = '{2}'","CCA",V.Local.iCCA,V.Caller.User.Trim,V.Local.sSql)
					F.ODBC.Connection!Con.Execute(V.Local.sSql)
					
					F.ODBC.Connection!Con.Close
					
					Gui.FormQC..Enabled(True)
					Gui.FormQC..AlwaysOnTop(True)
					Gui.FormQC..AlwaysOnTop(False)
				F.Intrinsic.Control.EndIf
			F.Intrinsic.Control.Else
				F.Intrinsic.String.Build("CAPA: {0} is locked by User: {1}",V.DataTable.CAR(V.Args.RowIndex).CCA_No!FieldValLong,V.Local.sSql,V.Local.sSql)
				F.Intrinsic.UI.Msgbox(V.Local.sSql)
				F.ODBC.Connection!Con.Close
				Gui.FormQC..Enabled(True)
				Gui.FormQC..AlwaysOnTop(True)
				Gui.FormQC..AlwaysOnTop(False)
			F.Intrinsic.Control.EndIf
		
		F.Intrinsic.Control.Case("DOC_LINK")
'			Function.Global.General.ResetPassedDataElements
'			F.Global.General.SetPassedDataElement("DATA-LINK-TYPE",2010)
			F.Intrinsic.String.Build("{0}-CCA",V.DataTable.CAR(V.Args.RowIndex).CCA_NO!FieldValLong,V.Local.sRet)
'			F.Global.General.SetPassedDataElement("DATA-LINK-KEY",V.Local.sRet)
'			F.Global.General.SetPassedDataElement("DATA-LINK-DESC","Cause and Corrective Action")
			F.Global.DocumentControl.GetLinkID(V.Local.sRet,2010,V.Local.iIdentity)
			F.Intrinsic.Control.If(V.Local.iIdentity,=,-1)
				F.Global.DocumentControl.CreateReference(V.Local.sRet,2010,V.Local.iIdentity)
			F.Intrinsic.Control.EndIf
			F.Global.DocumentControl.Invoke(V.Local.sRet,2010,"Cause and Corrective Action",V.Local.iIdentity)
'			F.Intrinsic.String.Build("{0}\ATG_DocumentControl.gas",V.Caller.GasDir,V.Local.sATGDoc)
'			F.Global.General.CallAsyncGAS(V.Local.sATGDoc,V.Local.iIdentity)
			
		F.Intrinsic.Control.Case("DELETE")
			F.ODBC.Connection!Con.OpenCompanyConnection
			F.Intrinsic.String.Build("Select GSS_User From GCG_5398_RECORD_LOCK Where Record_Type = 'CCA' and Record_NO = {0}",V.DataTable.CAR(V.Args.RowIndex).CCA_NO!FieldVal,V.Local.sSql)
			F.ODBC.Connection!Con.ExecuteAndReturn(V.Local.sSql,V.Local.sRet)
			F.Intrinsic.Control.If(V.Local.sRet.Length,=,0)
				F.Intrinsic.Control.If(V.DataTable.CAR(V.Args.RowIndex).ECR!FieldValLong,>,0)
					F.Intrinsic.String.Build("ECR = {0}",V.DataTable.CAR(V.Args.RowIndex).ECR!FieldValLong,V.Local.sFilter)
					F.Data.DataView.Create("ECR","TempECR",22,V.Local.sFilter,"")
					F.Intrinsic.Control.If(V.DataView.ECR!TempECR.RowCount--,<>,-1)
						F.Intrinsic.UI.Msgbox("Current CCA has a ECR.  Would you like to delete the ECR as well?","Attention",4,V.Local.iRet)
						F.Intrinsic.Control.If(V.Local.iRet,=,6)
							F.Intrinsic.String.Build("Select GSS_User From GCG_5398_RECORD_LOCK Where Record_Type = 'ECR' and Record_NO = {0}",V.DataTable.CAR(V.Args.RowIndex).ECR!FieldValLong,V.Local.sSql)
							F.ODBC.Connection!Con.ExecuteAndReturn(V.Local.sSql,V.Local.sRet)
							F.Intrinsic.Control.If(V.Local.sRet.Length,=,0)
								F.Intrinsic.String.Build("Delete From GCG_5398_ECR Where ECR = {0}",V.DataTable.CAR(V.Args.RowIndex).ECR!FieldVal,V.Local.sSql)
								F.ODBC.Connection!Con.Execute(V.Local.sSql)
								F.Data.DataTable.DeleteRow("ECR",V.DataView.ECR!TempECR(V.DataView.ECR!TempECR.RowCount--).DataTableIndex)
								F.Data.DataTable.AcceptChanges("ECR")
							F.Intrinsic.Control.Else
								F.Intrinsic.String.Build("ECR: {0} is locked by User: {1}. ECR will need to be removed from the ECR tab.",V.DataTable.CAR(V.Args.RowIndex).ECR!FieldVal,V.Local.sRet.Trim,V.Local.sRet)
								F.Intrinsic.UI.Msgbox(V.Local.sRet)
							F.Intrinsic.Control.EndIf
						F.Intrinsic.Control.EndIf
					F.Intrinsic.Control.EndIf
				F.Intrinsic.Control.EndIf
				F.Intrinsic.String.Build("Delete From GCG_5398_CAR Where CCA_NO = {0}",V.DataTable.CAR(V.Args.RowIndex).CCA_NO!FieldVal,V.Local.sSql)
				F.ODBC.Connection!Con.Execute(V.Local.sSql)
				F.Data.DataTable.DeleteRow("CAR",V.Args.RowIndex)
				F.Data.DataTable.AcceptChanges("CAR")
			F.Intrinsic.Control.Else
				F.Intrinsic.String.Build("Selected CAPA: {0} is locked by User: {1}",V.DataTable.CAR(V.Args.RowIndex).CCA_NO!FieldVal,V.Local.sRet.Trim,V.Local.sRet)
				F.Intrinsic.UI.Msgbox(V.Local.sRet)
			F.Intrinsic.Control.EndIf
			F.ODBC.Connection!Con.Close
			
	F.Intrinsic.Control.EndSelect
	
	F.Intrinsic.Control.ExitSub

F.Intrinsic.Control.Catch
	F.Intrinsic.Control.If(V.Ambient.ErrorNumber,<>,0)
		F.Intrinsic.String.Build("Project: {0}{1}Subroutine: {2}{1}Error Occurred {3} with description {4}","GCG_5398_CAR_ECN.g2u",V.Ambient.NewLine,V.Ambient.CurrentSubroutine,V.Ambient.ErrorNumber,V.Ambient.ErrorDescription,V.Local.sError)
		F.Intrinsic.UI.Msgbox(V.Local.sError)
		F.Intrinsic.Control.CallSub(FormQC_UnLoad)
	F.Intrinsic.Control.EndIf
Function.Intrinsic.Control.EndTry
Program.Sub.GsGridControlCAR_RowcellClick.End

Program.Sub.GsGridControlCAR_MouseCellEnter.Start
F.Intrinsic.Control.Try
	V.Local.sError.Declare(String,"")
	V.Local.iMenu.Declare(Long,0)
	V.Local.iRoWGlick.Declare(Long,0)
	V.Local.sTemp.Declare(String,"")
	V.Local.sSql.Declare(String,"")
	V.Local.sUser.Declare(String,"")
	V.Local.iChange.Declare(Long,0)
	V.Local.sRet.Declare(String,"")
	V.Local.iCol.Declare(Long,0)
	
	F.Intrinsic.Control.BlockEvents
	F.Intrinsic.Control.IsInCallstack(MenuClick,V.Local.iMenu)
	F.Intrinsic.Control.IsInCallstack(GsGridControlCAR_RowcellClick,V.Local.iRoWGlick)
	
	F.Intrinsic.Control.If(V.Local.iMenu,=,0,"AND",V.Local.iRoWGlick,=,0,V.Local.iChange,=,0)	
		V.Global.iCarIndex.Set(V.Args.SourceRowIndex)
	F.Intrinsic.Control.EndIf
			
	F.Intrinsic.Control.UnBlockEvents
	
	F.Intrinsic.Control.ExitSub

F.Intrinsic.Control.Catch
	F.Intrinsic.Control.If(V.Ambient.ErrorNumber,<>,0)
		F.Intrinsic.String.Build("Project: {0}{1}Subroutine: {2}{1}Error Occurred {3} with description {4}","GCG_5398_CAR_ECN.g2u",V.Ambient.NewLine,V.Ambient.CurrentSubroutine,V.Ambient.ErrorNumber,V.Ambient.ErrorDescription,V.Local.sError)
		F.Intrinsic.UI.Msgbox(V.Local.sError)
		F.Intrinsic.Control.CallSub(FormQC_UnLoad)
	F.Intrinsic.Control.EndIf
Function.Intrinsic.Control.EndTry
Program.Sub.GsGridControlCAR_MouseCellEnter.End

Program.Sub.GsGridControlECR_RowcellClick.Start
F.Intrinsic.Control.Try
	V.Local.sError.Declare(String,"")
	V.Local.iX.Declare(Long,0)
	V.Local.iY.Declare(Long,0)
	V.Local.sMsg.Declare(String,"")
	V.Local.sRet.Declare(String,"")
	V.Local.iIdentity.Declare(Long,0)
	V.Local.sSql.Declare(String,"")
	V.Local.sDate.Declare(String,"")
	V.Local.sTitles.Declare(String,"")
	V.Local.sWidths.Declare(String,"")
	V.Local.sFilter.Declare(String,"")
	V.Local.sFieldMap.Declare(String,"")
	V.Local.sATGDoc.Declare(String,"")
	V.Local.iCol.Declare(Long,0)
	V.Local.iECR.Declare(Long,0)

	F.Intrinsic.Control.SelectCase(V.Args.Column.UCase)		
		F.Intrinsic.Control.Case("EDIT")
			Gui.FormQC..Enabled(False)
			Gui.FormCCA/ECR.lblECR.Caption("ECC")
			Gui.FormCCA/ECR.txtECR.Locked(True)
			Gui.FormCCA/ECR.cmdECC.Visible(True)
			Gui.FormCCA/ECR.lblECR.Visible(True)
			Gui.FormCCA/ECR.txtECR.Visible(True)
			Gui.FormCCA/ECR.chkECR.Visible(False)
			Gui.FormCCA/ECR.lblOrgCheck.Visible(True)
			Gui.FormCCA/ECR.lblOrgDrawn.Visible(True)
			Gui.FormCCA/ECR.lblModBy.Visible(True)
			Gui.FormCCA/ECR.txtOrgCheckBy.Visible(True)
			Gui.FormCCA/ECR.txtOrgDrawn.Visible(True)
			Gui.FormCCA/ECR.txtOrgModBy.Visible(True)
			Gui.FormCCA/ECR.cmdOrigCheck.Visible(True)
			Gui.FormCCA/ECR.cmdOrigDrawn.Visible(True)
			Gui.FormCCA/ECR.cmdOrigModBy.Visible(True)
			F.ODBC.Connection!Con.OpenCompanyConnection
			'letting user know that current row is locked by another user
			V.Local.iECR.Set(V.DataTable.ECR(V.Args.RowIndex).ECR!FieldValLong)
			F.Intrinsic.String.Build("Select GSS_User From GCG_5398_RECORD_LOCK Where Record_Type = 'ECR' and Record_NO = {0}",V.DataTable.ECR(V.Args.RowIndex).ECR!FieldValLong,V.Local.sSql)
			F.ODBC.Connection!Con.ExecuteAndReturn(V.Local.sSql,V.Local.sSql)
			F.Intrinsic.Control.If(V.Local.sSql.Length,=,0)
				F.Intrinsic.String.Build("Select ECR, DATE_ENTERED, DUE_DATE, ORIG_USER, PRIORITY, rtrim(PROJECT_TYPE) as PROJECT_TYPE, rtrim(PART) as PART, rtrim(WO) as WO, rtrim(SO) as SO, ISSUE, rtrim(DESCRIPTION) as DESCRIPTION, STATUS, rtrim(ASSIGNED_Dept) as ASSIGNED_Dept, rtrim(ASSIGNED_TO) as ASSIGNED_TO, EST_COST_INC, rtrim(WorkGroup) as WorkGroup, Orig_DrawnBy, Orig_CheckBy, Orig_ModelBy FROM GCG_5398_ECR Where ECR = {0}",V.DataTable.ECR(V.Args.RowIndex).ECR!FieldValLong,V.Local.sSql)
				F.Data.DataTable.CreateFromSQL("Temp","con",V.Local.sSql)
				F.Intrinsic.Control.If(V.DataTable.Temp(V.DataTable.Temp.RowCount--).Status!FieldValTrim,=,"Complete - Awaiting Signoff")
					F.Intrinsic.String.Build("Selected ECR: {0} is already completed and has been moved to signoff tab.","Attention",V.DataTable.Temp(V.DataTable.Temp.RowCount--).ECR!FieldVal,V.Local.sMsg)
					F.Intrinsic.UI.Msgbox(V.Local.sMsg)
					F.Data.DataTable.DeleteRow("ECR",V.Args.RowIndex)
					F.Data.DataTable.AcceptChanges("ECR")
					F.ODBC.Connection!Con.Close
					Gui.FormQC..Enabled(True)
				F.Intrinsic.Control.Else
					'updating grid to make sure all information is uptodate
					F.Intrinsic.String.Build("Insert Into GCG_5398_RECORD_LOCK (Record_Type,Record_No,GSS_User) VALUES('{0}',{1},'{2}')","ECR",V.DataTable.ECR(V.Args.RowIndex).ECR!FieldValLong,V.Caller.User.Trim,V.Local.sSql)
					F.ODBC.Connection!Con.Execute(V.Local.sSql)
					F.Data.DataTable.SetValue("ECR",V.Args.RowIndex,"DATE_ENTERED",V.DataTable.Temp(V.DataTable.Temp.RowCount--).DATE_ENTERED!FieldVal,"ORIG_USER",V.DataTable.Temp(V.DataTable.Temp.RowCount--).ORIG_USER!FieldValTrim,"PROJECT_TYPE",V.DataTable.Temp(V.DataTable.Temp.RowCount--).PROJECT_TYPE!FieldValTrim,"PART",V.DataTable.Temp(V.DataTable.Temp.RowCount--).PART!FieldValTrim,"WO",V.DataTable.Temp(V.DataTable.Temp.RowCount--).WO!FieldValTrim,"SO",V.DataTable.Temp(V.DataTable.Temp.RowCount--).SO!FieldValTrim,"ISSUE",V.DataTable.Temp(V.DataTable.Temp.RowCount--).ISSUE!FieldValTrim,"DESCRIPTION",V.DataTable.Temp(V.DataTable.Temp.RowCount--).DESCRIPTION!FieldValTrim,"STATUS",V.DataTable.Temp(V.DataTable.Temp.RowCount--).STATUS!FieldValTrim,"ASSIGNED_Dept",V.DataTable.Temp(V.DataTable.Temp.RowCount--).ASSIGNED_Dept!FieldValTrim,"ASSIGNED_TO",V.DataTable.Temp(V.DataTable.Temp.RowCount--).ASSIGNED_TO!FieldValTrim,"DUE_DATE",V.DataTable.Temp(V.DataTable.Temp.RowCount--).DUE_DATE!FieldVal,"PRIORITY",V.DataTable.Temp(V.DataTable.Temp.RowCount--).PRIORITY!FieldValTrim,"EST_COST_INC",V.DataTable.Temp(V.DataTable.Temp.RowCount--).EST_COST_INC!FieldVal,"WorkGroup",V.DataTable.Temp(V.DataTable.Temp.RowCount--).WorkGroup!FieldValTrim,"Orig_DrawnBy",V.DataTable.Temp(V.DataTable.Temp.RowCount--).Orig_DrawnBy!FieldValTrim,"Orig_Checkby",V.DataTable.Temp(V.DataTable.Temp.RowCount--).Orig_CheckBy!FieldValTrim,"Orig_ModelBy",V.DataTable.Temp(V.DataTable.Temp.RowCount--).Orig_ModelBy!FieldValTrim)
					F.Intrinsic.String.Build("ECR: {0}",V.DataTable.ECR(V.Args.RowIndex).ECR!FieldValLong,V.Local.sMsg)
					F.Intrinsic.Control.BlockEvents
					Gui.FormCCA/ECR.lblCCA/ECR.Caption(V.Local.sMsg)
					gui.FormCCA/ECR.txtDept.Text(V.DataTable.ECR(V.Args.RowIndex).ASSIGNED_Dept!FieldValTrim)
					Gui.FormCCA/ECR.txtDesc.Text(V.DataTable.ECR(V.Args.RowIndex).Description!FieldValTrim)
					Gui.FormCCA/ECR.txtECR.Text(V.DataTable.ECR(V.Args.RowIndex).ECC!FieldValTrim)
					Gui.FormCCA/ECR.txtESTCost.Text(V.DataTable.ECR(V.Args.RowIndex).Est_Cost_Inc!FieldValFloat)
					Gui.FormCCA/ECR.txtPart.Text(V.DataTable.ECR(V.Args.RowIndex).Part!FieldValTrim)
					Gui.FormCCA/ECR.txtSO.Text(V.DataTable.ECR(V.Args.RowIndex).SO!FieldValTrim)
					Gui.FormCCA/ECR.txtWO.Text(V.DataTable.ECR(V.Args.RowIndex).WO!FieldValTrim)
					Gui.FormCCA/ECR.ddlIssue.Text(V.DataTable.ECR(V.Args.RowIndex).Issue!FieldValTrim)
					Gui.FormCCA/ECR.ddlPriority.Text(V.DataTable.ECR(V.Args.RowIndex).Priority!FieldValTrim)
					Gui.FormCCA/ECR.ddlProjType.Text(V.DataTable.ECR(V.Args.RowIndex).Project_Type!FieldValTrim)
					Gui.FormCCA/ECR.ddlStatus.Text(V.DataTable.ECR(V.Args.RowIndex).Status!FieldValTrim)
					Gui.FormCCA/ECR.ddlWG.Text(V.DataTable.ECR(V.Args.RowIndex).WorkGroup!FieldValTrim)
					Gui.FormCCA/ECR.txtOrgCheckBy.Text(V.DataTable.ECR(V.Args.RowIndex).ORIG_CHECKBY!FieldValTrim)
					Gui.FormCCA/ECR.txtOrgDrawn.Text(V.DataTable.ECR(V.Args.RowIndex).ORIG_DRAWNBY!FieldValTrim)
					Gui.FormCCA/ECR.txtOrgModBy.Text(V.DataTable.ECR(V.Args.RowIndex).ORIG_MODELBY!FieldValTrim)
					Gui.FormCCA/ECR.ddlSource.Text(V.DataTable.ECR(V.Args.RowIndex).Source!FieldValTrim)
					Gui.FormCCA/ECR.txtActionPlan.Text(V.DataTable.ECR(V.Args.RowIndex).Action_Plan!FieldValTrim)
					Gui.FormCCA/ECR.txtRootCause.Text(V.DataTable.ECR(V.Args.RowIndex).Root_Cause!FieldValTrim)
					V.Local.sDate.Set(V.DataTable.ECR(V.Args.RowIndex).Due_Date!FieldVal)
					F.Intrinsic.Control.If(V.Local.sDate.Trim,=,"")
						Gui.FormCCA/ECR.dtpDueDate.Value(V.Ambient.Date)
					F.Intrinsic.Control.Else
						Gui.FormCCA/ECR.dtpDueDate.Value(V.Local.sDate.DateComp)
					F.Intrinsic.Control.EndIf
					'browser for current users for in selected Group
					F.Intrinsic.Control.If(V.DataTable.ECR(V.Args.RowIndex).ASSIGNED_Dept!FieldValTrim,<>,"")
'						F.Intrinsic.String.Build("Select rtrim(PR_User_ID), rtrim(PR_User_ID) From V_Employee_Mstr Where rtrim(Dept_Employee) = '{0}' and PR_User_ID <> ''",V.DataTable.ECR(V.Args.RowIndex).ASSIGNED_Dept!FieldValTrim,V.Local.sSql)
						F.Intrinsic.String.Build("Select rtrim(PR_User_ID), rtrim(PR_User_ID) From V_Employee_Mstr a Where a.Employee in (Select b.Employee From GCG_5398_Dept_Maint b Where b.Dept_ID = '{0}') and PR_User_ID <> ''",V.DataTable.ECR(V.Args.RowIndex).ASSIGNED_Dept!FieldValTrim,V.Local.sSql)
						F.Data.Dictionary.CreateFromSQL("AssignedTO","con",V.Local.sSql)
						Gui.FormCCA/ECR.ddlAssignedTo.ClearItems
						Gui.FormCCA/ECR.ddlAssignedTo.AddItem(" ",0)
						Gui.FormCCA/ECR.ddlAssignedTo.AddItems("Dictionary","AssignedTO")
						
						F.Data.Dictionary.Close("AssignedTO")
					F.Intrinsic.Control.EndIf
					Gui.FormCCA/ECR.ddlAssignedTo.Text(V.DataTable.ECR(V.Args.RowIndex).Assigned_To!FieldValTrim)
					Gui.FormCCA/ECR.chkECR.Visible(False)
					Gui.FormCCA/ECR.chkECR.Value(0)
					F.Intrinsic.Control.UnBlockEvents
					Gui.FormCCA/ECR.cmdCCAECRSave.Enabled(False)
					F.Intrinsic.Control.BlockEvents
					Gui.FormCCA/ECR..Show
					F.Intrinsic.Control.UnBlockEvents
					F.ODBC.Connection!Con.Close
					Gui.FormCCA/ECR..WaitForDismiss
					
					F.ODBC.Connection!Con.OpenCompanyConnection
					
					F.Intrinsic.String.Build("Delete From GCG_5398_RECORD_LOCK Where Record_Type = '{0}' and Record_No = {1} and GSS_User = '{2}'","ECR",V.Local.iECR,V.Caller.User.Trim,V.Local.sSql)
					F.ODBC.Connection!Con.Execute(V.Local.sSql)
					
					F.ODBC.Connection!Con.Close
					
					Gui.FormQC..Enabled(True)
					Gui.FormQC..AlwaysOnTop(True)
					Gui.FormQC..AlwaysOnTop(False)
				F.Intrinsic.Control.EndIf
			F.Intrinsic.Control.Else
				F.Intrinsic.String.Build("ECR: {0} is locked by User: {1}",V.DataTable.ECR(V.Args.RowIndex).ECR!FieldValLong,V.Local.sSql,V.Local.sSql)
				F.Intrinsic.UI.Msgbox(V.Local.sSql)
				F.ODBC.Connection!Con.Close
				Gui.FormQC..Enabled(True)
			F.Intrinsic.Control.EndIf
		
		F.Intrinsic.Control.Case("DOC_LINK")			
'			Function.Global.General.ResetPassedDataElements
'			F.Global.General.SetPassedDataElement("DATA-LINK-TYPE",2010)
			F.Intrinsic.String.Build("Select CCA_NO From GCG_5398_CAR Where ECR = {0}",V.DataTable.ECR(V.Args.RowIndex).ECR!FieldValLong,V.Local.sFilter)
			F.ODBC.Connection!Con.OpenCompanyConnection
			F.ODBC.Connection!Con.ExecuteAndReturn(V.Local.sFilter,V.Local.sFilter)
			F.ODBC.Connection!Con.Close
			F.Intrinsic.Control.If(V.Local.sFilter,<>,"")
				F.Intrinsic.String.Build("{0}-CCA",V.Local.sFilter.Long,V.Local.sRet)
			F.Intrinsic.Control.Else
				F.Intrinsic.String.Build("{0}-ECR",V.DataTable.ECR(V.Args.RowIndex).ECR!FieldValLong,V.Local.sRet)
			F.Intrinsic.Control.EndIf
			
'			F.Global.General.SetPassedDataElement("DATA-LINK-KEY",V.Local.sRet)
'			F.Global.General.SetPassedDataElement("DATA-LINK-DESC","Engineering Change Request")
			F.Global.DocumentControl.GetLinkID(V.Local.sRet,2010,V.Local.iIdentity)
				
			F.Intrinsic.Control.If(V.Local.iIdentity,=,-1)
				F.Global.DocumentControl.CreateReference(V.Local.sRet,2010,V.Local.iIdentity)
			F.Intrinsic.Control.EndIf
			F.Global.DocumentControl.Invoke(V.Local.sRet,2010,"Cause and Corrective Action",V.Local.iIdentity)
'			F.Intrinsic.String.Build("{0}\ATG_DocumentControl.gas",V.Caller.GasDir,V.Local.sATGDoc)
'			F.Global.General.CallAsyncGAS(V.Local.sATGDoc,V.Local.iIdentity)
			
		F.Intrinsic.Control.Case("DELETE")
			F.ODBC.Connection!Con.OpenCompanyConnection
			'need to check to see if a user as the selected record locked.
			F.Intrinsic.String.Build("Select GSS_User From GCG_5398_RECORD_LOCK Where Record_Type = 'ECR' and Record_NO = {0}",V.DataTable.ECR(V.Args.RowIndex).ECR!FieldValLong,V.Local.sSql)
			F.ODBC.Connection!Con.ExecuteAndReturn(V.Local.sSql,V.Local.sRet)
			F.Intrinsic.Control.If(V.Local.sRet.Length,=,0)
				'getting ECR to see if it's attached to a CCA if so removing to ECR from the CCA row
				F.Intrinsic.String.Build("ECR = {0}",V.DataTable.ECR(V.Args.RowIndex).ECR!FieldValLong,V.Local.sFilter)
				F.Data.DataView.Create("CAR","TempECR",22,V.Local.sFilter,"")
				F.Intrinsic.Control.If(V.DataView.CAR!TempECR.RowCount--,<>,-1)
					F.Data.DataView.SetValue("CAR","TempECR",-1,"ECR_REQUIRED",False,"ECR",V.Ambient.DBNull)
				F.Intrinsic.Control.EndIf

				V.Local.sFieldMap.Set("CCA_NO@!@CCA_NO*!*ECR@!@ECR*!*ECR_REQUIRED@!@ECR_REQUIRED*!*DATE_ENTERED@!@DATE_ENTERED*!*ORIG_USER@!@ORIG_USER*!*PROJECT_TYPE@!@PROJECT_TYPE*!*PART@!@PART*!*WO@!@WO*!*SO@!@SO*!*ISSUE@!@ISSUE*!*DESCRIPTION@!@DESCRIPTION*!*ROOT_CAUSE@!@ROOT_CAUSE*!*ACTION_PLAN@!@ACTION_PLAN*!*STATUS@!@STATUS*!*ASSIGNED_Dept@!@ASSIGNED_Dept*!*ASSIGNED_TO@!@ASSIGNED_TO*!*SOURCE@!@SOURCE*!*DUE_DATE@!@DUE_DATE*!*PRIORITY@!@PRIORITY*!*EST_COST_INC@!@EST_COST_INC*!*WorkGroup@!@WorkGroup")
				'saving current row
				F.Intrinsic.String.Build("CCA_NO = {0}",V.DataTable.ECR(V.Args.RowIndex).CCA_NO!FieldValLong,V.Local.sFilter)
				F.Data.DataView.Create("CAR","CARTemp",22,V.Local.sFilter,"")
				F.Data.DataView.ToDataTable("CAR","CARTemp","CARSaveTemp")
				F.Data.DataView.Close("CAR","CARTemp")
				F.Data.DataTable.Merge("CARSaveTemp","CarSave",True,2)
				F.Data.DataTable.SaveToDB("CARSave","Con","GCG_5398_CAR","CCA_NO",256,V.Local.sFieldMap)
				F.Data.DataTable.DeleteRow("CarSave")
				F.Data.DataTable.AcceptChanges("CarSave")
				
				F.Data.DataView.Close("CAR","TempECR")
				F.Intrinsic.String.Build("Delete From GCG_5398_ECR Where ECR = {0}",V.DataTable.ECR(V.Args.RowIndex).ECR!FieldVal,V.Local.sSql)
				F.ODBC.Connection!Con.Execute(V.Local.sSql)
				F.Data.DataTable.DeleteRow("ECR",V.Args.RowIndex)
				F.Data.DataTable.AcceptChanges("ECR")
			F.Intrinsic.Control.Else
				F.Intrinsic.String.Build("Selected ECR: {0} is locked by User: {1}",V.DataTable.ECR(V.Args.RowIndex).ECR!FieldVal,V.Local.sRet.Trim,V.Local.sRet)
				F.Intrinsic.UI.Msgbox(V.Local.sRet)
			F.Intrinsic.Control.EndIf
			F.ODBC.Connection!Con.Close
	F.Intrinsic.Control.EndSelect
	
	F.Intrinsic.Control.ExitSub

F.Intrinsic.Control.Catch
	F.Intrinsic.Control.If(V.Ambient.ErrorNumber,<>,0)
		F.Intrinsic.String.Build("Project: {0}{1}Subroutine: {2}{1}Error Occurred {3} with description {4}","GCG_5398_CAR_ECN.g2u",V.Ambient.NewLine,V.Ambient.CurrentSubroutine,V.Ambient.ErrorNumber,V.Ambient.ErrorDescription,V.Local.sError)
		F.Intrinsic.UI.Msgbox(V.Local.sError)
		F.Intrinsic.Control.CallSub(FormQC_UnLoad)
	F.Intrinsic.Control.EndIf
Function.Intrinsic.Control.EndTry
Program.Sub.GsGridControlECR_RowcellClick.End

Program.Sub.GsGridControlECR_MouseCellEnter.Start
F.Intrinsic.Control.Try
	V.Local.sError.Declare(String,"")
	V.Local.iMenu.Declare(Long,0)
	V.Local.iRoWGlick.Declare(Long,0)
	V.Local.sTemp.Declare(String,"")
	V.Local.sSql.Declare(String,"")
	V.Local.sUser.Declare(String,"")
	V.Local.iChange.Declare(Long,0)
	V.Local.sRet.Declare(String,"")
	V.Local.iCol.Declare(Long,0)
	
	F.Intrinsic.Control.BlockEvents
	F.Intrinsic.Control.IsInCallstack(MenuClick,V.Local.iMenu)
	F.Intrinsic.Control.IsInCallstack(GsGridControlECR_RowcellClick,V.Local.iRoWGlick)
	F.Intrinsic.Control.If(V.Local.iMenu,=,0,"AND",V.Local.iRoWGlick,=,0,V.Local.iChange,=,0)	
		V.Global.iEcrIndex.Set(V.Args.SourceRowIndex)
	F.Intrinsic.Control.EndIf
			
	F.Intrinsic.Control.UnBlockEvents
	
	F.Intrinsic.Control.ExitSub

F.Intrinsic.Control.Catch
	F.Intrinsic.Control.If(V.Ambient.ErrorNumber,<>,0)
		F.Intrinsic.String.Build("Project: {0}{1}Subroutine: {2}{1}Error Occurred {3} with description {4}","GCG_5398_CAR_ECN.g2u",V.Ambient.NewLine,V.Ambient.CurrentSubroutine,V.Ambient.ErrorNumber,V.Ambient.ErrorDescription,V.Local.sError)
		F.Intrinsic.UI.Msgbox(V.Local.sError)
		F.Intrinsic.Control.CallSub(FormQC_UnLoad)
	F.Intrinsic.Control.EndIf
Function.Intrinsic.Control.EndTry
Program.Sub.GsGridControlECR_MouseCellEnter.End

Program.Sub.GsGridControlSignoff_MouseCellEnter.Start
F.Intrinsic.Control.Try
	V.Local.sError.Declare(String,"")
	V.Local.iMenu.Declare(Long,0)
	V.Local.iRoWGlick.Declare(Long,0)
	V.Local.sTemp.Declare(String,"")
	V.Local.sSql.Declare(String,"")
	V.Local.sUser.Declare(String,"")
	V.Local.iChange.Declare(Long,0)
	V.Local.sRet.Declare(String,"")
	V.Local.iCol.Declare(Long,0)
	
	F.Intrinsic.Control.BlockEvents
	F.Intrinsic.Control.IsInCallstack(MenuClick,V.Local.iMenu)
	F.Intrinsic.Control.IsInCallstack(GsGridControlSignoff_RowcellClick,V.Local.iRoWGlick)
	F.Intrinsic.Control.If(V.Local.iMenu,=,0,"AND",V.Local.iRoWGlick,=,0,V.Local.iChange,=,0)	
		V.Global.iSignOffIndex.Set(V.Args.SourceRowIndex)
	F.Intrinsic.Control.EndIf
			
	F.Intrinsic.Control.UnBlockEvents
	
	F.Intrinsic.Control.ExitSub

F.Intrinsic.Control.Catch
	F.Intrinsic.Control.If(V.Ambient.ErrorNumber,<>,0)
		F.Intrinsic.String.Build("Project: {0}{1}Subroutine: {2}{1}Error Occurred {3} with description {4}","GCG_5398_CAR_ECN.g2u",V.Ambient.NewLine,V.Ambient.CurrentSubroutine,V.Ambient.ErrorNumber,V.Ambient.ErrorDescription,V.Local.sError)
		F.Intrinsic.UI.Msgbox(V.Local.sError)
		F.Intrinsic.Control.CallSub(FormQC_UnLoad)
	F.Intrinsic.Control.EndIf
Function.Intrinsic.Control.EndTry
Program.Sub.GsGridControlSignoff_MouseCellEnter.End

Program.Sub.Set_Car_Properties.Start
F.Intrinsic.Control.Try
	V.Local.sError.Declare(String,"")
	V.Local.sFile.Declare(String,"")
	V.Local.sReturn.Declare(String,"")
	V.Local.bRet.Declare(Boolean,False)
	V.Local.sTemp.Declare(String,"")
	
	Gui.FormQC.GsGridControlCAR.AddGridviewFromDatatable("CAR","CAR")
	
	Gui.FormQC.GsGridControlCAR.SetGridviewProperty("CAR","Showgrouppanel",True)
	Gui.FormQC.GsGridControlCAR.SetGridviewProperty("CAR","Multiselect",False)
	Gui.FormQC.GsGridControlCAR.SetGridviewProperty("CAR","OptionsSelectionEnableAppearanceFocusedRow",False)
	Gui.FormQC.GsGridControlCAR.SetGridviewProperty("CAR","OptionsViewShowAutoFilterRow",True)
	Gui.FormQC.GsGridControlCAR.SetGridviewProperty("CAR","OptionsViewColumnAutoWidth",False)
	
	Gui.FormQC.GsGridControlCAR.SetColumnProperty("CAR","Doc_Link","ReadOnly",True)
	Gui.FormQC.GsGridControlCAR.SetColumnProperty("CAR","Doc_Link","AllowEdit",False)
	Gui.FormQC.GsGridControlCAR.SetColumnProperty("CAR","Doc_Link","Caption"," ")
	Gui.FormQC.GsGridControlCAR.SetColumnProperty("CAR","Doc_Link","Width",22)
	Gui.FormQC.GsGridControlCAR.SetColumnProperty("CAR","Doc_Link","Icon","DCS-ON")
	Gui.FormQC.GsGridControlCAR.SetColumnProperty("CAR","Doc_Link","HeaderBackColor","Green")
	Gui.FormQC.GsGridControlCAR.SetColumnProperty("CAR","Doc_Link","HeaderForeColor","White")
	Gui.FormQC.GsGridControlCAR.SetColumnProperty("CAR","Doc_Link","Fixed","Left")
	Gui.FormQC.GsGridControlCAR.SetColumnProperty("CAR","Doc_Link","Fixed","Left")
	
	Gui.FormQC.GsGridControlCAR.SetColumnProperty("CAR","CCA_NO","ReadOnly",True)
	Gui.FormQC.GsGridControlCAR.SetColumnProperty("CAR","CCA_NO","AllowEdit",False)
	Gui.FormQC.GsGridControlCAR.SetColumnProperty("CAR","CCA_NO","Caption","CAPA #")
	Gui.FormQC.GsGridControlCAR.SetColumnProperty("CAR","CCA_NO","HeaderBackColor","Green")
	Gui.FormQC.GsGridControlCAR.SetColumnProperty("CAR","CCA_NO","HeaderForeColor","White")
	Gui.FormQC.GsGridControlCAR.SetColumnProperty("CAR","CCA_NO","Fixed","Left")
	Gui.FormQC.GsGridControlCAR.SetColumnProperty("CAR","CCA_NO","CellHAlignment","Center")
	Gui.FormQC.GsGridControlCAR.SetColumnProperty("CAR","CCA_NO","HeaderFontSize",10)
	Gui.FormQC.GsGridControlCAR.SetColumnProperty("CAR","CCA_NO","CellFontSize",10)
	
	Gui.FormQC.GsGridControlCAR.SetColumnProperty("CAR","DATE_ENTERED","ReadOnly",True)
	Gui.FormQC.GsGridControlCAR.SetColumnProperty("CAR","DATE_ENTERED","AllowEdit",False)
	Gui.FormQC.GsGridControlCAR.SetColumnProperty("CAR","DATE_ENTERED","Caption","Date Entered")
	Gui.FormQC.GsGridControlCAR.SetColumnProperty("CAR","DATE_ENTERED","HeaderBackColor","Green")
	Gui.FormQC.GsGridControlCAR.SetColumnProperty("CAR","DATE_ENTERED","HeaderForeColor","White")
	Gui.FormQC.GsGridControlCAR.SetColumnProperty("CAR","DATE_ENTERED","DisplayCustomDatetime","d")
	Gui.FormQC.GsGridControlCAR.SetColumnProperty("CAR","DATE_ENTERED","Fixed","Left")
	Gui.FormQC.GsGridControlCAR.SetColumnProperty("CAR","DATE_ENTERED","HeaderFontSize",10)
	Gui.FormQC.GsGridControlCAR.SetColumnProperty("CAR","DATE_ENTERED","CellFontSize",10)
	
	Gui.FormQC.GsGridControlCAR.SetColumnProperty("CAR","DUE_DATE","ReadOnly",True)
	Gui.FormQC.GsGridControlCAR.SetColumnProperty("CAR","DUE_DATE","AllowEdit",False)
	Gui.FormQC.GsGridControlCAR.SetColumnProperty("CAR","DUE_DATE","Caption","Due Date")
	Gui.FormQC.GsGridControlCAR.SetColumnProperty("CAR","DUE_DATE","HeaderBackColor","Green")
	Gui.FormQC.GsGridControlCAR.SetColumnProperty("CAR","DUE_DATE","HeaderForeColor","White")
	Gui.FormQC.GsGridControlCAR.SetColumnProperty("CAR","DUE_DATE","DisplayCustomDatetime","d")
	Gui.FormQC.GsGridControlCAR.SetColumnProperty("CAR","DUE_DATE","Fixed","Left")
	Gui.FormQC.GsGridControlCAR.SetColumnProperty("CAR","DUE_DATE","HeaderFontSize",10)
	Gui.FormQC.GsGridControlCAR.SetColumnProperty("CAR","DUE_DATE","CellFontSize",10)
	
	Gui.FormQC.GsGridControlCAR.SetColumnProperty("CAR","ORIG_USER","ReadOnly",True)
	Gui.FormQC.GsGridControlCAR.SetColumnProperty("CAR","ORIG_USER","AllowEdit",False)
	Gui.FormQC.GsGridControlCAR.SetColumnProperty("CAR","ORIG_USER","Caption","Orig User")
	Gui.FormQC.GsGridControlCAR.SetColumnProperty("CAR","ORIG_USER","HeaderBackColor","Green")
	Gui.FormQC.GsGridControlCAR.SetColumnProperty("CAR","ORIG_USER","HeaderForeColor","White")
	Gui.FormQC.GsGridControlCAR.SetColumnProperty("CAR","ORIG_USER","Fixed","Left")
	Gui.FormQC.GsGridControlCAR.SetColumnProperty("CAR","ORIG_USER","HeaderFontSize",10)
	Gui.FormQC.GsGridControlCAR.SetColumnProperty("CAR","ORIG_USER","CellFontSize",10)
	
	Gui.FormQC.GsGridControlCAR.SetColumnProperty("CAR","PRIORITY","ReadOnly",True)
	Gui.FormQC.GsGridControlCAR.SetColumnProperty("CAR","PRIORITY","AllowEdit",False)
	Gui.FormQC.GsGridControlCAR.SetColumnProperty("CAR","PRIORITY","Caption","Priority")
	Gui.FormQC.GsGridControlCAR.SetColumnProperty("CAR","PRIORITY","HeaderBackColor","Green")
	Gui.FormQC.GsGridControlCAR.SetColumnProperty("CAR","PRIORITY","HeaderForeColor","White")
	Gui.FormQC.GsGridControlCAR.SetColumnProperty("CAR","PRIORITY","Fixed","Left")
	Gui.FormQC.GsGridControlCAR.SetColumnProperty("CAR","PRIORITY","HeaderFontSize",10)
	Gui.FormQC.GsGridControlCAR.SetColumnProperty("CAR","PRIORITY","CellFontSize",10)
	
	Gui.FormQC.GsGridControlCAR.SetColumnProperty("CAR","PROJECT_TYPE","ReadOnly",True)
	Gui.FormQC.GsGridControlCAR.SetColumnProperty("CAR","PROJECT_TYPE","AllowEdit",False)
	Gui.FormQC.GsGridControlCAR.SetColumnProperty("CAR","PROJECT_TYPE","Caption","Type")
	Gui.FormQC.GsGridControlCAR.SetColumnProperty("CAR","PROJECT_TYPE","HeaderBackColor","Green")
	Gui.FormQC.GsGridControlCAR.SetColumnProperty("CAR","PROJECT_TYPE","HeaderForeColor","White")
	Gui.FormQC.GsGridControlCAR.SetColumnProperty("CAR","PROJECT_TYPE","MaxLength","30")
	Gui.FormQC.GsGridControlCAR.SetColumnProperty("CAR","PROJECT_TYPE","HeaderFontSize",10)
	Gui.FormQC.GsGridControlCAR.SetColumnProperty("CAR","PROJECT_TYPE","CellFontSize",10)
	
	Gui.FormQC.GsGridControlCAR.SetColumnProperty("CAR","Source","ReadOnly",True)
	Gui.FormQC.GsGridControlCAR.SetColumnProperty("CAR","Source","AllowEdit",False)
	Gui.FormQC.GsGridControlCAR.SetColumnProperty("CAR","Source","Caption","Source")
	Gui.FormQC.GsGridControlCAR.SetColumnProperty("CAR","Source","HeaderBackColor","Green")
	Gui.FormQC.GsGridControlCAR.SetColumnProperty("CAR","Source","HeaderForeColor","White")
	Gui.FormQC.GsGridControlCAR.SetColumnProperty("CAR","Source","MaxLength","30")
	Gui.FormQC.GsGridControlCAR.SetColumnProperty("CAR","Source","HeaderFontSize",10)
	Gui.FormQC.GsGridControlCAR.SetColumnProperty("CAR","Source","CellFontSize",10)
	
	Gui.FormQC.GsGridControlCAR.SetColumnProperty("CAR","PART","ReadOnly",True)
	Gui.FormQC.GsGridControlCAR.SetColumnProperty("CAR","PART","AllowEdit",False)
	Gui.FormQC.GsGridControlCAR.SetColumnProperty("CAR","PART","Caption","Part #")
	Gui.FormQC.GsGridControlCAR.SetColumnProperty("CAR","PART","HeaderBackColor","Green")
	Gui.FormQC.GsGridControlCAR.SetColumnProperty("CAR","PART","HeaderForeColor","White")
	Gui.FormQC.GsGridControlCAR.SetColumnProperty("CAR","PART","MaxLength","20")
	Gui.FormQC.GsGridControlCAR.SetColumnProperty("CAR","PART","HeaderFontSize",10)
	Gui.FormQC.GsGridControlCAR.SetColumnProperty("CAR","PART","CellFontSize",10)
	
	Gui.FormQC.GsGridControlCAR.SetColumnProperty("CAR","WO","ReadOnly",True)
	Gui.FormQC.GsGridControlCAR.SetColumnProperty("CAR","WO","AllowEdit",False)
	Gui.FormQC.GsGridControlCAR.SetColumnProperty("CAR","WO","HeaderBackColor","Green")
	Gui.FormQC.GsGridControlCAR.SetColumnProperty("CAR","WO","HeaderForeColor","White")
	Gui.FormQC.GsGridControlCAR.SetColumnProperty("CAR","WO","MaxLength","11")
	Gui.FormQC.GsGridControlCAR.SetColumnProperty("CAR","WO","HeaderFontSize",10)
	Gui.FormQC.GsGridControlCAR.SetColumnProperty("CAR","WO","CellFontSize",10)
	
	Gui.FormQC.GsGridControlCAR.SetColumnProperty("CAR","SO","ReadOnly",True)
	Gui.FormQC.GsGridControlCAR.SetColumnProperty("CAR","SO","AllowEdit",False)
	Gui.FormQC.GsGridControlCAR.SetColumnProperty("CAR","SO","HeaderBackColor","Green")
	Gui.FormQC.GsGridControlCAR.SetColumnProperty("CAR","SO","HeaderForeColor","White")
	Gui.FormQC.GsGridControlCAR.SetColumnProperty("CAR","SO","MaxLength","6")
	Gui.FormQC.GsGridControlCAR.SetColumnProperty("CAR","SO","HeaderFontSize",10)
	Gui.FormQC.GsGridControlCAR.SetColumnProperty("CAR","SO","CellFontSize",10)
	
	Gui.FormQC.GsGridControlCAR.SetColumnProperty("CAR","ISSUE","ReadOnly",True)
	Gui.FormQC.GsGridControlCAR.SetColumnProperty("CAR","ISSUE","AllowEdit",False)
	Gui.FormQC.GsGridControlCAR.SetColumnProperty("CAR","ISSUE","Caption","Issue")
	Gui.FormQC.GsGridControlCAR.SetColumnProperty("CAR","ISSUE","HeaderBackColor","Green")
	Gui.FormQC.GsGridControlCAR.SetColumnProperty("CAR","ISSUE","HeaderForeColor","White")
	Gui.FormQC.GsGridControlCAR.SetColumnProperty("CAR","ISSUE","HeaderFontSize",10)
	Gui.FormQC.GsGridControlCAR.SetColumnProperty("CAR","ISSUE","CellFontSize",10)
	
	Gui.FormQC.GsGridControlCAR.SetColumnProperty("CAR","DESCRIPTION","ReadOnly",True)
	Gui.FormQC.GsGridControlCAR.SetColumnProperty("CAR","DESCRIPTION","AllowEdit",False)
	Gui.FormQC.GsGridControlCAR.SetColumnProperty("CAR","DESCRIPTION","Caption","Description")
	Gui.FormQC.GsGridControlCAR.SetColumnProperty("CAR","DESCRIPTION","HeaderBackColor","Green")
	Gui.FormQC.GsGridControlCAR.SetColumnProperty("CAR","DESCRIPTION","HeaderForeColor","White")
	Gui.FormQC.GsGridControlCAR.SetColumnProperty("CAR","DESCRIPTION","HeaderFontSize",10)
	Gui.FormQC.GsGridControlCAR.SetColumnProperty("CAR","DESCRIPTION","CellFontSize",10)
	
	Gui.FormQC.GsGridControlCAR.SetColumnProperty("CAR","ROOT_CAUSE","ReadOnly",True)
	Gui.FormQC.GsGridControlCAR.SetColumnProperty("CAR","ROOT_CAUSE","AllowEdit",False)
	Gui.FormQC.GsGridControlCAR.SetColumnProperty("CAR","ROOT_CAUSE","Caption","Root Cause")
	Gui.FormQC.GsGridControlCAR.SetColumnProperty("CAR","ROOT_CAUSE","HeaderBackColor","Green")
	Gui.FormQC.GsGridControlCAR.SetColumnProperty("CAR","ROOT_CAUSE","HeaderForeColor","White")
	Gui.FormQC.GsGridControlCAR.SetColumnProperty("CAR","ROOT_CAUSE","HeaderFontSize",10)
	Gui.FormQC.GsGridControlCAR.SetColumnProperty("CAR","ROOT_CAUSE","CellFontSize",10)
	
	Gui.FormQC.GsGridControlCAR.SetColumnProperty("CAR","ACTION_PLAN","ReadOnly",True)
	Gui.FormQC.GsGridControlCAR.SetColumnProperty("CAR","ACTION_PLAN","AllowEdit",False)
	Gui.FormQC.GsGridControlCAR.SetColumnProperty("CAR","ACTION_PLAN","Caption","Action_Plan")
	Gui.FormQC.GsGridControlCAR.SetColumnProperty("CAR","ACTION_PLAN","HeaderBackColor","Green")
	Gui.FormQC.GsGridControlCAR.SetColumnProperty("CAR","ACTION_PLAN","HeaderForeColor","White")
	Gui.FormQC.GsGridControlCAR.SetColumnProperty("CAR","ACTION_PLAN","HeaderFontSize",10)
	Gui.FormQC.GsGridControlCAR.SetColumnProperty("CAR","ACTION_PLAN","CellFontSize",10)
	
	Gui.FormQC.GsGridControlCAR.SetColumnProperty("CAR","STATUS","ReadOnly",True)
	Gui.FormQC.GsGridControlCAR.SetColumnProperty("CAR","STATUS","AllowEdit",False)
	Gui.FormQC.GsGridControlCAR.SetColumnProperty("CAR","STATUS","Caption","Status")
	Gui.FormQC.GsGridControlCAR.SetColumnProperty("CAR","STATUS","HeaderBackColor","Green")
	Gui.FormQC.GsGridControlCAR.SetColumnProperty("CAR","STATUS","HeaderForeColor","White")
	Gui.FormQC.GsGridControlCAR.SetColumnProperty("CAR","STATUS","HeaderFontSize",10)
	Gui.FormQC.GsGridControlCAR.SetColumnProperty("CAR","STATUS","CellFontSize",10)
	
	Gui.FormQC.GsGridControlCAR.SetColumnProperty("CAR","ASSIGNED_Dept","ReadOnly",True)
	Gui.FormQC.GsGridControlCAR.SetColumnProperty("CAR","ASSIGNED_Dept","AllowEdit",False)
	Gui.FormQC.GsGridControlCAR.SetColumnProperty("CAR","ASSIGNED_Dept","Caption","Assigned Dept")
	Gui.FormQC.GsGridControlCAR.SetColumnProperty("CAR","ASSIGNED_Dept","HeaderBackColor","Green")
	Gui.FormQC.GsGridControlCAR.SetColumnProperty("CAR","ASSIGNED_Dept","HeaderForeColor","White")
	Gui.FormQC.GsGridControlCAR.SetColumnProperty("CAR","ASSIGNED_Dept","HeaderFontSize",10)
	Gui.FormQC.GsGridControlCAR.SetColumnProperty("CAR","ASSIGNED_Dept","CellFontSize",10)
	
	Gui.FormQC.GsGridControlCAR.SetColumnProperty("CAR","ASSIGNED_TO","ReadOnly",True)
	Gui.FormQC.GsGridControlCAR.SetColumnProperty("CAR","ASSIGNED_TO","AllowEdit",False)
	Gui.FormQC.GsGridControlCAR.SetColumnProperty("CAR","ASSIGNED_TO","Caption","Assigned To")
	Gui.FormQC.GsGridControlCAR.SetColumnProperty("CAR","ASSIGNED_TO","HeaderBackColor","Green")
	Gui.FormQC.GsGridControlCAR.SetColumnProperty("CAR","ASSIGNED_TO","HeaderForeColor","White")
	Gui.FormQC.GsGridControlCAR.SetColumnProperty("CAR","ASSIGNED_TO","HeaderFontSize",10)
	Gui.FormQC.GsGridControlCAR.SetColumnProperty("CAR","ASSIGNED_TO","CellFontSize",10)
	
	Gui.FormQC.GsGridControlCAR.SetColumnProperty("CAR","ECR_REQUIRED","ReadOnly",True)
	Gui.FormQC.GsGridControlCAR.SetColumnProperty("CAR","ECR_REQUIRED","AllowEdit",False)
	Gui.FormQC.GsGridControlCAR.SetColumnProperty("CAR","ECR_REQUIRED","Caption","ECR Requried")
	Gui.FormQC.GsGridControlCAR.SetColumnProperty("CAR","ECR_REQUIRED","HeaderBackColor","Green")
	Gui.FormQC.GsGridControlCAR.SetColumnProperty("CAR","ECR_REQUIRED","HeaderForeColor","White")
	Gui.FormQC.GsGridControlCAR.SetColumnProperty("CAR","ECR_REQUIRED","HeaderFontSize",10)
	Gui.FormQC.GsGridControlCAR.SetColumnProperty("CAR","ECR_REQUIRED","CellFontSize",10)
	
	Gui.FormQC.GsGridControlCAR.SetColumnProperty("CAR","ECR","ReadOnly",True)
	Gui.FormQC.GsGridControlCAR.SetColumnProperty("CAR","ECR","AllowEdit",False)
	Gui.FormQC.GsGridControlCAR.SetColumnProperty("CAR","ECR","Caption","ECR")
	Gui.FormQC.GsGridControlCAR.SetColumnProperty("CAR","ECR","HeaderBackColor","Green")
	Gui.FormQC.GsGridControlCAR.SetColumnProperty("CAR","ECR","HeaderForeColor","White")
	Gui.FormQC.GsGridControlCAR.SetColumnProperty("CAR","ECR","HeaderFontSize",10)
	Gui.FormQC.GsGridControlCAR.SetColumnProperty("CAR","ECR","CellFontSize",10)
	
	Gui.FormQC.GsGridControlCAR.SetColumnProperty("CAR","EST_COST_INC","ReadOnly",True)
	Gui.FormQC.GsGridControlCAR.SetColumnProperty("CAR","EST_COST_INC","AllowEdit",False)
	Gui.FormQC.GsGridControlCAR.SetColumnProperty("CAR","EST_COST_INC","Caption","Est Cost")
	Gui.FormQC.GsGridControlCAR.SetColumnProperty("CAR","EST_COST_INC","HeaderBackColor","Green")
	Gui.FormQC.GsGridControlCAR.SetColumnProperty("CAR","EST_COST_INC","HeaderForeColor","White")
	Gui.FormQC.GsGridControlCAR.SetColumnProperty("CAR","EST_COST_INC","HeaderFontSize",10)
	Gui.FormQC.GsGridControlCAR.SetColumnProperty("CAR","EST_COST_INC","CellFontSize",10)
	
	Gui.FormQC.GsGridControlCAR.SetColumnProperty("CAR","WorkGroup","ReadOnly",True)
	Gui.FormQC.GsGridControlCAR.SetColumnProperty("CAR","WorkGroup","AllowEdit",False)
	Gui.FormQC.GsGridControlCAR.SetColumnProperty("CAR","WorkGroup","Caption","WG")
	Gui.FormQC.GsGridControlCAR.SetColumnProperty("CAR","WorkGroup","HeaderBackColor","Green")
	Gui.FormQC.GsGridControlCAR.SetColumnProperty("CAR","WorkGroup","HeaderForeColor","White")
	Gui.FormQC.GsGridControlCAR.SetColumnProperty("CAR","WorkGroup","HeaderFontSize",10)
	Gui.FormQC.GsGridControlCAR.SetColumnProperty("CAR","WorkGroup","CellFontSize",10)
	
	Gui.FormQC.GsGridControlCAR.SetColumnProperty("CAR","Edit","ReadOnly",True)
	Gui.FormQC.GsGridControlCAR.SetColumnProperty("CAR","Edit","AllowEdit",False)
	Gui.FormQC.GsGridControlCAR.SetColumnProperty("CAR","Edit","Caption"," ")
	Gui.FormQC.GsGridControlCAR.SetColumnProperty("CAR","Edit","HeaderBackColor","Green")
	Gui.FormQC.GsGridControlCAR.SetColumnProperty("CAR","Edit","HeaderForeColor","White")
'	Gui.FormQC.GsGridControlCAR.SetColumnProperty("CAR","Edit","CellBackColor","Gray")
	Gui.FormQC.GsGridControlCAR.SetColumnProperty("CAR","Edit","CellFontBold",True)
	Gui.FormQC.GsGridControlCAR.SetColumnProperty("CAR","Edit","CellHAlignment","Center")
	Gui.FormQC.GsGridControlCAR.SetColumnProperty("CAR","Edit","MaxWidth","60")
	Gui.FormQC.GsGridControlCAR.SetColumnProperty("CAR","Edit","Fixed","Right")
	Gui.FormQC.GsGridControlCAR.ColumnEdit("CAR","Edit","EditorButton","Edit")
	Gui.FormQC.GsGridControlCAR.SetColumnProperty("CAR","Edit","HeaderFontSize",10)
	Gui.FormQC.GsGridControlCAR.SetColumnProperty("CAR","Edit","CellFontSize",10)
	
	Gui.FormQC.GsGridControlCAR.SetColumnProperty("CAR","Delete","ReadOnly",True)
	Gui.FormQC.GsGridControlCAR.SetColumnProperty("CAR","Delete","AllowEdit",False)
	Gui.FormQC.GsGridControlCAR.SetColumnProperty("CAR","Delete","Caption"," ")
	Gui.FormQC.GsGridControlCAR.SetColumnProperty("CAR","Delete","HeaderBackColor","Green")
	Gui.FormQC.GsGridControlCAR.SetColumnProperty("CAR","Delete","HeaderForeColor","White")
'	Gui.FormQC.GsGridControlCAR.SetColumnProperty("CAR","Delete","CellBackColor","Gray")
	Gui.FormQC.GsGridControlCAR.SetColumnProperty("CAR","Delete","CellFontBold",True)
	Gui.FormQC.GsGridControlCAR.SetColumnProperty("CAR","Delete","CellHAlignment","Center")
	Gui.FormQC.GsGridControlCAR.SetColumnProperty("CAR","Delete","MaxWidth","60")
	Gui.FormQC.GsGridControlCAR.SetColumnProperty("CAR","Delete","Fixed","Right")
	Gui.FormQC.GsGridControlCAR.ColumnEdit("CAR","Delete","EditorButton","Delete")
	Gui.FormQC.GsGridControlCAR.SetColumnProperty("CAR","Delete","HeaderFontSize",10)
	Gui.FormQC.GsGridControlCAR.SetColumnProperty("CAR","Delete","CellFontSize",10)
	
	Gui.FormQC.GsGridControlCAR.AddStyleFormatCondition("CAR","PRIORITY","ParentCRed","Equal","Critical")
	Gui.FormQC.GsGridControlCAR.SetStyleFormatConditionProperty("CAR","PRIORITY","ParentCRed","BackColor","#fd6464")
	Gui.FormQC.GsGridControlCAR.SetStyleFormatConditionProperty("CAR","PRIORITY","ParentCRed","ApplyToRow",True)
	
	Gui.FormQC.GsGridControlCAR.AddStyleFormatCondition("CAR","PRIORITY","ParentYellow","Equal","Medium")
	Gui.FormQC.GsGridControlCAR.SetStyleFormatConditionProperty("CAR","PRIORITY","ParentYellow","BackColor","#EDFD73")
	Gui.FormQC.GsGridControlCAR.SetStyleFormatConditionProperty("CAR","PRIORITY","ParentYellow","ApplyToRow",True)
	
	Gui.FormQC.GsGridControlCAR.AddStyleFormatCondition("CAR","PRIORITY","ParentOrange","Equal","High")
	Gui.FormQC.GsGridControlCAR.SetStyleFormatConditionProperty("CAR","PRIORITY","ParentOrange","BackColor","#ffa500")
	Gui.FormQC.GsGridControlCAR.SetStyleFormatConditionProperty("CAR","PRIORITY","ParentOrange","ApplyToRow",True)
	
	Gui.FormQC.GsGridControlCAR.AddStyleFormatCondition("CAR","DUE_DATE","ParentRed","Less",V.Ambient.Date)
	Gui.FormQC.GsGridControlCAR.SetStyleFormatConditionProperty("CAR","DUE_DATE","ParentRed","BackColor","#fd6464")

	F.Intrinsic.String.Build("{0}\Custom\",V.Caller.GlobalDir,V.Local.sFile)
	F.Intrinsic.File.DirExists(V.Local.sFile,V.Local.bRet)
	F.Intrinsic.Control.If(V.Local.bRet,=,False)
		F.Intrinsic.File.CreateDir(V.Local.sFile)
	F.Intrinsic.Control.EndIf
	F.Intrinsic.String.Build("{0}\Custom\5398\",V.Caller.GlobalDir,V.Local.sFile)
	F.Intrinsic.File.DirExists(V.Local.sFile,V.Local.bRet)
	F.Intrinsic.Control.If(V.Local.bRet,=,False)
		F.Intrinsic.File.CreateDir(V.Local.sFile)
	F.Intrinsic.Control.EndIf
	
	F.Intrinsic.String.Build("{0}\Custom\5398\{1}{2}_5398_CAR.txt",V.Caller.GlobalDir,V.Caller.User.Trim,V.Caller.CompanyCode,V.Local.sFile)
	
	F.Intrinsic.File.Exists(V.Local.sFile,V.Local.bRet)
	F.Intrinsic.Control.If(V.Local.bRet)
		F.Intrinsic.File.File2String(V.Local.sFile,V.Local.sReturn)
		Gui.FormQC.GsGridControlCAR.Deserialize(V.Local.sReturn)
	F.Intrinsic.Control.EndIf
	
	Gui.FormQC.GsGridControlCAR.MainView("CAR")
	
	F.Intrinsic.Control.ExitSub

F.Intrinsic.Control.Catch
	F.Intrinsic.Control.If(V.Ambient.ErrorNumber,<>,0)
		F.Intrinsic.String.Build("Project: {0}{1}Subroutine: {2}{1}Error Occurred {3} with description {4}","GCG_5398_CAR_ECN.g2u",V.Ambient.NewLine,V.Ambient.CurrentSubroutine,V.Ambient.ErrorNumber,V.Ambient.ErrorDescription,V.Local.sError)
		F.Intrinsic.UI.Msgbox(V.Local.sError)
		F.Intrinsic.Control.CallSub(FormQC_UnLoad)
	F.Intrinsic.Control.EndIf
Function.Intrinsic.Control.EndTry
Program.Sub.Set_Car_Properties.End

Program.Sub.Set_Ecr_Properties.Start
F.Intrinsic.Control.Try
	V.Local.sError.Declare(String,"")
	V.Local.sFile.Declare(String,"")
	V.Local.sReturn.Declare(String,"")
	V.Local.bRet.Declare(Boolean,False)
	V.Local.sTemp.Declare(String,"")
	
	Gui.FormQC.GsGridControlECR.AddGridviewFromDatatable("ECR","ECR")
	
	Gui.FormQC.GsGridControlECR.SetGridviewProperty("ECR","Showgrouppanel",True)
	Gui.FormQC.GsGridControlECR.SetGridviewProperty("ECR","Multiselect",False)
	Gui.FormQC.GsGridControlECR.SetGridviewProperty("ECR","OptionsSelectionEnableAppearanceFocusedRow",False)
	Gui.FormQC.GsGridControlECR.SetGridviewProperty("ECR","OptionsViewShowAutoFilterRow",True)
	Gui.FormQC.GsGridControlECR.SetGridviewProperty("ECR","OptionsViewColumnAutoWidth",False)
	
	Gui.FormQC.GsGridControlECR.SetColumnProperty("ECR","Doc_Link","ReadOnly",True)
	Gui.FormQC.GsGridControlECR.SetColumnProperty("ECR","Doc_Link","AllowEdit",False)
	Gui.FormQC.GsGridControlECR.SetColumnProperty("ECR","Doc_Link","Caption"," ")
	Gui.FormQC.GsGridControlECR.SetColumnProperty("ECR","Doc_Link","Width",22)
	Gui.FormQC.GsGridControlECR.SetColumnProperty("ECR","Doc_Link","Icon","DCS-ON")
	Gui.FormQC.GsGridControlECR.SetColumnProperty("ECR","Doc_Link","HeaderBackColor","Green")
	Gui.FormQC.GsGridControlECR.SetColumnProperty("ECR","Doc_Link","HeaderForeColor","White")
	Gui.FormQC.GsGridControlECR.SetColumnProperty("ECR","Doc_Link","Fixed","Left")
	
	Gui.FormQC.GsGridControlECR.SetColumnProperty("ECR","ECR","ReadOnly",True)
	Gui.FormQC.GsGridControlECR.SetColumnProperty("ECR","ECR","AllowEdit",False)
	Gui.FormQC.GsGridControlECR.SetColumnProperty("ECR","ECR","Caption","ECR")
	Gui.FormQC.GsGridControlECR.SetColumnProperty("ECR","ECR","HeaderBackColor","Green")
	Gui.FormQC.GsGridControlECR.SetColumnProperty("ECR","ECR","HeaderForeColor","White")
	Gui.FormQC.GsGridControlECR.SetColumnProperty("ECR","ECR","Fixed","Left")
	Gui.FormQC.GsGridControlECR.SetColumnProperty("ECR","ECR","CellHAlignment","Center")
	Gui.FormQC.GsGridControlECR.SetColumnProperty("ECR","ECR","HeaderFontSize",10)
	Gui.FormQC.GsGridControlECR.SetColumnProperty("ECR","ECR","CellFontSize",10)
	
	Gui.FormQC.GsGridControlECR.SetColumnProperty("ECR","CCA_NO","ReadOnly",True)
	Gui.FormQC.GsGridControlECR.SetColumnProperty("ECR","CCA_NO","AllowEdit",False)
	Gui.FormQC.GsGridControlECR.SetColumnProperty("ECR","CCA_NO","Caption","CAPA #")
	Gui.FormQC.GsGridControlECR.SetColumnProperty("ECR","CCA_NO","HeaderBackColor","Green")
	Gui.FormQC.GsGridControlECR.SetColumnProperty("ECR","CCA_NO","HeaderForeColor","White")
	Gui.FormQC.GsGridControlECR.SetColumnProperty("ECR","CCA_NO","Fixed","Left")
	Gui.FormQC.GsGridControlECR.SetColumnProperty("ECR","CCA_NO","CellHAlignment","Center")
	Gui.FormQC.GsGridControlECR.SetColumnProperty("ECR","CCA_NO","HeaderFontSize",10)
	Gui.FormQC.GsGridControlECR.SetColumnProperty("ECR","CCA_NO","CellFontSize",10)
	
	Gui.FormQC.GsGridControlECR.SetColumnProperty("ECR","DATE_ENTERED","ReadOnly",True)
	Gui.FormQC.GsGridControlECR.SetColumnProperty("ECR","DATE_ENTERED","AllowEdit",False)
	Gui.FormQC.GsGridControlECR.SetColumnProperty("ECR","DATE_ENTERED","Caption","Date Entered")
	Gui.FormQC.GsGridControlECR.SetColumnProperty("ECR","DATE_ENTERED","HeaderBackColor","Green")
	Gui.FormQC.GsGridControlECR.SetColumnProperty("ECR","DATE_ENTERED","HeaderForeColor","White")
	Gui.FormQC.GsGridControlECR.SetColumnProperty("ECR","DATE_ENTERED","DisplayCustomDatetime","d")
	Gui.FormQC.GsGridControlECR.SetColumnProperty("ECR","DATE_ENTERED","Fixed","Left")
	Gui.FormQC.GsGridControlECR.SetColumnProperty("ECR","DATE_ENTERED","HeaderFontSize",10)
	Gui.FormQC.GsGridControlECR.SetColumnProperty("ECR","DATE_ENTERED","CellFontSize",10)
	
	Gui.FormQC.GsGridControlECR.SetColumnProperty("ECR","DUE_DATE","ReadOnly",True)
	Gui.FormQC.GsGridControlECR.SetColumnProperty("ECR","DUE_DATE","AllowEdit",False)
	Gui.FormQC.GsGridControlECR.SetColumnProperty("ECR","DUE_DATE","Caption","Due Date")
	Gui.FormQC.GsGridControlECR.SetColumnProperty("ECR","DUE_DATE","HeaderBackColor","Green")
	Gui.FormQC.GsGridControlECR.SetColumnProperty("ECR","DUE_DATE","HeaderForeColor","White")
	Gui.FormQC.GsGridControlECR.SetColumnProperty("ECR","DUE_DATE","DisplayCustomDatetime","d")
	Gui.FormQC.GsGridControlECR.SetColumnProperty("ECR","DUE_DATE","Fixed","Left")
	Gui.FormQC.GsGridControlECR.SetColumnProperty("ECR","DUE_DATE","HeaderFontSize",10)
	Gui.FormQC.GsGridControlECR.SetColumnProperty("ECR","DUE_DATE","CellFontSize",10)
	
	Gui.FormQC.GsGridControlECR.SetColumnProperty("ECR","ORIG_USER","ReadOnly",True)
	Gui.FormQC.GsGridControlECR.SetColumnProperty("ECR","ORIG_USER","AllowEdit",False)
	Gui.FormQC.GsGridControlECR.SetColumnProperty("ECR","ORIG_USER","Caption","Orig User")
	Gui.FormQC.GsGridControlECR.SetColumnProperty("ECR","ORIG_USER","HeaderBackColor","Green")
	Gui.FormQC.GsGridControlECR.SetColumnProperty("ECR","ORIG_USER","HeaderForeColor","White")
	Gui.FormQC.GsGridControlECR.SetColumnProperty("ECR","ORIG_USER","Fixed","Left")
	Gui.FormQC.GsGridControlECR.SetColumnProperty("ECR","ORIG_USER","HeaderFontSize",10)
	Gui.FormQC.GsGridControlECR.SetColumnProperty("ECR","ORIG_USER","CellFontSize",10)
	
	Gui.FormQC.GsGridControlECR.SetColumnProperty("ECR","PRIORITY","ReadOnly",True)
	Gui.FormQC.GsGridControlECR.SetColumnProperty("ECR","PRIORITY","AllowEdit",False)
	Gui.FormQC.GsGridControlECR.SetColumnProperty("ECR","PRIORITY","Caption","Priority")
	Gui.FormQC.GsGridControlECR.SetColumnProperty("ECR","PRIORITY","HeaderBackColor","Green")
	Gui.FormQC.GsGridControlECR.SetColumnProperty("ECR","PRIORITY","HeaderForeColor","White")
	Gui.FormQC.GsGridControlECR.SetColumnProperty("ECR","PRIORITY","Fixed","Left")
	Gui.FormQC.GsGridControlECR.SetColumnProperty("ECR","PRIORITY","HeaderFontSize",10)
	Gui.FormQC.GsGridControlECR.SetColumnProperty("ECR","PRIORITY","CellFontSize",10)
	
	Gui.FormQC.GsGridControlECR.SetColumnProperty("ECR","PROJECT_TYPE","ReadOnly",True)
	Gui.FormQC.GsGridControlECR.SetColumnProperty("ECR","PROJECT_TYPE","AllowEdit",False)
	Gui.FormQC.GsGridControlECR.SetColumnProperty("ECR","PROJECT_TYPE","Caption","Type")
	Gui.FormQC.GsGridControlECR.SetColumnProperty("ECR","PROJECT_TYPE","HeaderBackColor","Green")
	Gui.FormQC.GsGridControlECR.SetColumnProperty("ECR","PROJECT_TYPE","HeaderForeColor","White")
	Gui.FormQC.GsGridControlECR.SetColumnProperty("ECR","PROJECT_TYPE","MaxLength","30")
	Gui.FormQC.GsGridControlECR.SetColumnProperty("ECR","PROJECT_TYPE","HeaderFontSize",10)
	Gui.FormQC.GsGridControlECR.SetColumnProperty("ECR","PROJECT_TYPE","CellFontSize",10)
	
	Gui.FormQC.GsGridControlECR.SetColumnProperty("ECR","Source","ReadOnly",True)
	Gui.FormQC.GsGridControlECR.SetColumnProperty("ECR","Source","AllowEdit",False)
	Gui.FormQC.GsGridControlECR.SetColumnProperty("ECR","Source","Caption","Source")
	Gui.FormQC.GsGridControlECR.SetColumnProperty("ECR","Source","HeaderBackColor","Green")
	Gui.FormQC.GsGridControlECR.SetColumnProperty("ECR","Source","HeaderForeColor","White")
	Gui.FormQC.GsGridControlECR.SetColumnProperty("ECR","Source","MaxLength","30")
	Gui.FormQC.GsGridControlECR.SetColumnProperty("ECR","Source","HeaderFontSize",10)
	Gui.FormQC.GsGridControlECR.SetColumnProperty("ECR","Source","CellFontSize",10)
	
	Gui.FormQC.GsGridControlECR.SetColumnProperty("ECR","ECC","ReadOnly",True)
	Gui.FormQC.GsGridControlECR.SetColumnProperty("ECR","ECC","AllowEdit",False)
	Gui.FormQC.GsGridControlECR.SetColumnProperty("ECR","ECC","Caption","ECC #")
	Gui.FormQC.GsGridControlECR.SetColumnProperty("ECR","ECC","HeaderBackColor","Green")
	Gui.FormQC.GsGridControlECR.SetColumnProperty("ECR","ECC","HeaderForeColor","White")
	Gui.FormQC.GsGridControlECR.SetColumnProperty("ECR","ECC","HeaderFontSize",10)
	Gui.FormQC.GsGridControlECR.SetColumnProperty("ECR","ECC","CellFontSize",10)
	
	Gui.FormQC.GsGridControlECR.SetColumnProperty("ECR","PART","ReadOnly",True)
	Gui.FormQC.GsGridControlECR.SetColumnProperty("ECR","PART","AllowEdit",False)
	Gui.FormQC.GsGridControlECR.SetColumnProperty("ECR","PART","Caption","Part #")
	Gui.FormQC.GsGridControlECR.SetColumnProperty("ECR","PART","HeaderBackColor","Green")
	Gui.FormQC.GsGridControlECR.SetColumnProperty("ECR","PART","HeaderForeColor","White")
	Gui.FormQC.GsGridControlECR.SetColumnProperty("ECR","PART","MaxLength","20")
	Gui.FormQC.GsGridControlECR.SetColumnProperty("ECR","PART","HeaderFontSize",10)
	Gui.FormQC.GsGridControlECR.SetColumnProperty("ECR","PART","CellFontSize",10)
	
	Gui.FormQC.GsGridControlECR.SetColumnProperty("ECR","WO","ReadOnly",True)
	Gui.FormQC.GsGridControlECR.SetColumnProperty("ECR","WO","AllowEdit",False)
	Gui.FormQC.GsGridControlECR.SetColumnProperty("ECR","WO","HeaderBackColor","Green")
	Gui.FormQC.GsGridControlECR.SetColumnProperty("ECR","WO","HeaderForeColor","White")
	Gui.FormQC.GsGridControlECR.SetColumnProperty("ECR","WO","MaxLength","11")
	Gui.FormQC.GsGridControlECR.SetColumnProperty("ECR","WO","HeaderFontSize",10)
	Gui.FormQC.GsGridControlECR.SetColumnProperty("ECR","WO","CellFontSize",10)
	
	Gui.FormQC.GsGridControlECR.SetColumnProperty("ECR","SO","ReadOnly",True)
	Gui.FormQC.GsGridControlECR.SetColumnProperty("ECR","SO","AllowEdit",False)
	Gui.FormQC.GsGridControlECR.SetColumnProperty("ECR","SO","HeaderBackColor","Green")
	Gui.FormQC.GsGridControlECR.SetColumnProperty("ECR","SO","HeaderForeColor","White")
	Gui.FormQC.GsGridControlECR.SetColumnProperty("ECR","SO","MaxLength","6")
	Gui.FormQC.GsGridControlECR.SetColumnProperty("ECR","SO","HeaderFontSize",10)
	Gui.FormQC.GsGridControlECR.SetColumnProperty("ECR","SO","CellFontSize",10)
	
	Gui.FormQC.GsGridControlECR.SetColumnProperty("ECR","ISSUE","ReadOnly",True)
	Gui.FormQC.GsGridControlECR.SetColumnProperty("ECR","ISSUE","AllowEdit",False)
	Gui.FormQC.GsGridControlECR.SetColumnProperty("ECR","ISSUE","Caption","Issue")
	Gui.FormQC.GsGridControlECR.SetColumnProperty("ECR","ISSUE","HeaderBackColor","Green")
	Gui.FormQC.GsGridControlECR.SetColumnProperty("ECR","ISSUE","HeaderForeColor","White")
	Gui.FormQC.GsGridControlECR.SetColumnProperty("ECR","ISSUE","HeaderFontSize",10)
	Gui.FormQC.GsGridControlECR.SetColumnProperty("ECR","ISSUE","CellFontSize",10)
	
	Gui.FormQC.GsGridControlECR.SetColumnProperty("ECR","DESCRIPTION","ReadOnly",True)
	Gui.FormQC.GsGridControlECR.SetColumnProperty("ECR","DESCRIPTION","AllowEdit",False)
	Gui.FormQC.GsGridControlECR.SetColumnProperty("ECR","DESCRIPTION","Caption","Description")
	Gui.FormQC.GsGridControlECR.SetColumnProperty("ECR","DESCRIPTION","HeaderBackColor","Green")
	Gui.FormQC.GsGridControlECR.SetColumnProperty("ECR","DESCRIPTION","HeaderForeColor","White")
	Gui.FormQC.GsGridControlECR.SetColumnProperty("ECR","DESCRIPTION","HeaderFontSize",10)
	Gui.FormQC.GsGridControlECR.SetColumnProperty("ECR","DESCRIPTION","CellFontSize",10)
	
	Gui.FormQC.GsGridControlECR.SetColumnProperty("ECR","ROOT_CAUSE","ReadOnly",True)
	Gui.FormQC.GsGridControlECR.SetColumnProperty("ECR","ROOT_CAUSE","AllowEdit",False)
	Gui.FormQC.GsGridControlECR.SetColumnProperty("ECR","ROOT_CAUSE","Caption","Root Cause")
	Gui.FormQC.GsGridControlECR.SetColumnProperty("ECR","ROOT_CAUSE","HeaderBackColor","Green")
	Gui.FormQC.GsGridControlECR.SetColumnProperty("ECR","ROOT_CAUSE","HeaderForeColor","White")
	Gui.FormQC.GsGridControlECR.SetColumnProperty("ECR","ROOT_CAUSE","HeaderFontSize",10)
	Gui.FormQC.GsGridControlECR.SetColumnProperty("ECR","ROOT_CAUSE","CellFontSize",10)
	
	Gui.FormQC.GsGridControlECR.SetColumnProperty("ECR","ACTION_PLAN","ReadOnly",True)
	Gui.FormQC.GsGridControlECR.SetColumnProperty("ECR","ACTION_PLAN","AllowEdit",False)
	Gui.FormQC.GsGridControlECR.SetColumnProperty("ECR","ACTION_PLAN","Caption","Action_Plan")
	Gui.FormQC.GsGridControlECR.SetColumnProperty("ECR","ACTION_PLAN","HeaderBackColor","Green")
	Gui.FormQC.GsGridControlECR.SetColumnProperty("ECR","ACTION_PLAN","HeaderForeColor","White")
	Gui.FormQC.GsGridControlECR.SetColumnProperty("ECR","ACTION_PLAN","HeaderFontSize",10)
	Gui.FormQC.GsGridControlECR.SetColumnProperty("ECR","ACTION_PLAN","CellFontSize",10)
	
	Gui.FormQC.GsGridControlECR.SetColumnProperty("ECR","STATUS","ReadOnly",True)
	Gui.FormQC.GsGridControlECR.SetColumnProperty("ECR","STATUS","AllowEdit",False)
	Gui.FormQC.GsGridControlECR.SetColumnProperty("ECR","STATUS","Caption","Status")
	Gui.FormQC.GsGridControlECR.SetColumnProperty("ECR","STATUS","HeaderBackColor","Green")
	Gui.FormQC.GsGridControlECR.SetColumnProperty("ECR","STATUS","HeaderForeColor","White")
	Gui.FormQC.GsGridControlECR.SetColumnProperty("ECR","STATUS","HeaderFontSize",10)
	Gui.FormQC.GsGridControlECR.SetColumnProperty("ECR","STATUS","CellFontSize",10)
	
	Gui.FormQC.GsGridControlECR.SetColumnProperty("ECR","ASSIGNED_Dept","ReadOnly",True)
	Gui.FormQC.GsGridControlECR.SetColumnProperty("ECR","ASSIGNED_Dept","AllowEdit",False)
	Gui.FormQC.GsGridControlECR.SetColumnProperty("ECR","ASSIGNED_Dept","Caption","Assigned Dept")
	Gui.FormQC.GsGridControlECR.SetColumnProperty("ECR","ASSIGNED_Dept","HeaderBackColor","Green")
	Gui.FormQC.GsGridControlECR.SetColumnProperty("ECR","ASSIGNED_Dept","HeaderForeColor","White")
	Gui.FormQC.GsGridControlECR.SetColumnProperty("ECR","ASSIGNED_Dept","HeaderFontSize",10)
	Gui.FormQC.GsGridControlECR.SetColumnProperty("ECR","ASSIGNED_Dept","CellFontSize",10)
	
	Gui.FormQC.GsGridControlECR.SetColumnProperty("ECR","ASSIGNED_TO","ReadOnly",True)
	Gui.FormQC.GsGridControlECR.SetColumnProperty("ECR","ASSIGNED_TO","AllowEdit",False)
	Gui.FormQC.GsGridControlECR.SetColumnProperty("ECR","ASSIGNED_TO","Caption","Assigned To")
	Gui.FormQC.GsGridControlECR.SetColumnProperty("ECR","ASSIGNED_TO","HeaderBackColor","Green")
	Gui.FormQC.GsGridControlECR.SetColumnProperty("ECR","ASSIGNED_TO","HeaderForeColor","White")
	Gui.FormQC.GsGridControlECR.SetColumnProperty("ECR","ASSIGNED_TO","HeaderFontSize",10)
	Gui.FormQC.GsGridControlECR.SetColumnProperty("ECR","ASSIGNED_TO","CellFontSize",10)
	
	Gui.FormQC.GsGridControlECR.SetColumnProperty("ECR","EST_COST_INC","ReadOnly",True)
	Gui.FormQC.GsGridControlECR.SetColumnProperty("ECR","EST_COST_INC","AllowEdit",False)
	Gui.FormQC.GsGridControlECR.SetColumnProperty("ECR","EST_COST_INC","Caption","Est Cost")
	Gui.FormQC.GsGridControlECR.SetColumnProperty("ECR","EST_COST_INC","HeaderBackColor","Green")
	Gui.FormQC.GsGridControlECR.SetColumnProperty("ECR","EST_COST_INC","HeaderForeColor","White")
	Gui.FormQC.GsGridControlECR.SetColumnProperty("ECR","EST_COST_INC","HeaderFontSize",10)
	Gui.FormQC.GsGridControlECR.SetColumnProperty("ECR","EST_COST_INC","CellFontSize",10)
	
	Gui.FormQC.GsGridControlECR.SetColumnProperty("ECR","WorkGroup","ReadOnly",True)
	Gui.FormQC.GsGridControlECR.SetColumnProperty("ECR","WorkGroup","AllowEdit",False)
	Gui.FormQC.GsGridControlECR.SetColumnProperty("ECR","WorkGroup","Caption","WG")
	Gui.FormQC.GsGridControlECR.SetColumnProperty("ECR","WorkGroup","HeaderBackColor","Green")
	Gui.FormQC.GsGridControlECR.SetColumnProperty("ECR","WorkGroup","HeaderForeColor","White")
	Gui.FormQC.GsGridControlECR.SetColumnProperty("ECR","WorkGroup","HeaderFontSize",10)
	Gui.FormQC.GsGridControlECR.SetColumnProperty("ECR","WorkGroup","CellFontSize",10)
	
	Gui.FormQC.GsGridControlECR.SetColumnProperty("ECR","ORIG_DRAWNBY","ReadOnly",True)
	Gui.FormQC.GsGridControlECR.SetColumnProperty("ECR","ORIG_DRAWNBY","AllowEdit",False)
	Gui.FormQC.GsGridControlECR.SetColumnProperty("ECR","ORIG_DRAWNBY","Caption","Org Drawn By")
	Gui.FormQC.GsGridControlECR.SetColumnProperty("ECR","ORIG_DRAWNBY","HeaderBackColor","Green")
	Gui.FormQC.GsGridControlECR.SetColumnProperty("ECR","ORIG_DRAWNBY","HeaderForeColor","White")
	Gui.FormQC.GsGridControlECR.SetColumnProperty("ECR","ORIG_DRAWNBY","HeaderFontSize",10)
	Gui.FormQC.GsGridControlECR.SetColumnProperty("ECR","ORIG_DRAWNBY","CellFontSize",10)
	
	Gui.FormQC.GsGridControlECR.SetColumnProperty("ECR","ORIG_CHECKBY","ReadOnly",True)
	Gui.FormQC.GsGridControlECR.SetColumnProperty("ECR","ORIG_CHECKBY","AllowEdit",False)
	Gui.FormQC.GsGridControlECR.SetColumnProperty("ECR","ORIG_CHECKBY","Caption","Org Checked By")
	Gui.FormQC.GsGridControlECR.SetColumnProperty("ECR","ORIG_CHECKBY","HeaderBackColor","Green")
	Gui.FormQC.GsGridControlECR.SetColumnProperty("ECR","ORIG_CHECKBY","HeaderForeColor","White")
	Gui.FormQC.GsGridControlECR.SetColumnProperty("ECR","ORIG_CHECKBY","HeaderFontSize",10)
	Gui.FormQC.GsGridControlECR.SetColumnProperty("ECR","ORIG_CHECKBY","CellFontSize",10)
	
	Gui.FormQC.GsGridControlECR.SetColumnProperty("ECR","ORIG_MODELBY","ReadOnly",True)
	Gui.FormQC.GsGridControlECR.SetColumnProperty("ECR","ORIG_MODELBY","AllowEdit",False)
	Gui.FormQC.GsGridControlECR.SetColumnProperty("ECR","ORIG_MODELBY","Caption","Org Modeled By")
	Gui.FormQC.GsGridControlECR.SetColumnProperty("ECR","ORIG_MODELBY","HeaderBackColor","Green")
	Gui.FormQC.GsGridControlECR.SetColumnProperty("ECR","ORIG_MODELBY","HeaderForeColor","White")
	Gui.FormQC.GsGridControlECR.SetColumnProperty("ECR","ORIG_MODELBY","HeaderFontSize",10)
	Gui.FormQC.GsGridControlECR.SetColumnProperty("ECR","ORIG_MODELBY","CellFontSize",10)
	
	Gui.FormQC.GsGridControlECR.SetColumnProperty("ECR","Edit","ReadOnly",True)
	Gui.FormQC.GsGridControlECR.SetColumnProperty("ECR","Edit","AllowEdit",False)
	Gui.FormQC.GsGridControlECR.SetColumnProperty("ECR","Edit","Caption"," ")
	Gui.FormQC.GsGridControlECR.SetColumnProperty("ECR","Edit","HeaderBackColor","Green")
	Gui.FormQC.GsGridControlECR.SetColumnProperty("ECR","Edit","HeaderForeColor","White")
'	Gui.FormQC.GsGridControlECR.SetColumnProperty("ECR","Edit","CellBackColor","Gray")
	Gui.FormQC.GsGridControlECR.SetColumnProperty("ECR","Edit","CellFontBold",True)
	Gui.FormQC.GsGridControlECR.SetColumnProperty("ECR","Edit","CellHAlignment","Center")
	Gui.FormQC.GsGridControlECR.SetColumnProperty("ECR","Edit","Fixed","Right")
	Gui.FormQC.GsGridControlECR.SetColumnProperty("ECR","Edit","MaxWidth","60")
	Gui.FormQC.GsGridControlECR.ColumnEdit("ECR","Edit","EditorButton","Edit")
	Gui.FormQC.GsGridControlECR.SetColumnProperty("ECR","Edit","HeaderFontSize",10)
	Gui.FormQC.GsGridControlECR.SetColumnProperty("ECR","Edit","CellFontSize",10)
	
	Gui.FormQC.GsGridControlECR.SetColumnProperty("ECR","Delete","ReadOnly",True)
	Gui.FormQC.GsGridControlECR.SetColumnProperty("ECR","Delete","AllowEdit",False)
	Gui.FormQC.GsGridControlECR.SetColumnProperty("ECR","Delete","Caption"," ")
	Gui.FormQC.GsGridControlECR.SetColumnProperty("ECR","Delete","HeaderBackColor","Green")
	Gui.FormQC.GsGridControlECR.SetColumnProperty("ECR","Delete","HeaderForeColor","White")
'	Gui.FormQC.GsGridControlECR.SetColumnProperty("ECR","Delete","CellBackColor","Gray")
	Gui.FormQC.GsGridControlECR.SetColumnProperty("ECR","Delete","CellFontBold",True)
	Gui.FormQC.GsGridControlECR.SetColumnProperty("ECR","Delete","CellHAlignment","Center")
	Gui.FormQC.GsGridControlECR.SetColumnProperty("ECR","Delete","MaxWidth","60")
	Gui.FormQC.GsGridControlECR.SetColumnProperty("ECR","Delete","Fixed","Right")
	Gui.FormQC.GsGridControlECR.ColumnEdit("ECR","Delete","EditorButton","Delete")
	Gui.FormQC.GsGridControlECR.SetColumnProperty("ECR","Delete","HeaderFontSize",10)
	Gui.FormQC.GsGridControlECR.SetColumnProperty("ECR","Delete","CellFontSize",10)
	
	Gui.FormQC.GsGridControlECR.AddStyleFormatCondition("ECR","PRIORITY","ParentCRed","Equal","Critical")
	Gui.FormQC.GsGridControlECR.SetStyleFormatConditionProperty("ECR","PRIORITY","ParentCRed","BackColor","#fd6464")
	Gui.FormQC.GsGridControlECR.SetStyleFormatConditionProperty("ECR","PRIORITY","ParentCRed","ApplyToRow",True)
	
	Gui.FormQC.GsGridControlECR.AddStyleFormatCondition("ECR","PRIORITY","ParentYellow","Equal","Medium")
	Gui.FormQC.GsGridControlECR.SetStyleFormatConditionProperty("ECR","PRIORITY","ParentYellow","BackColor","#EDFD73")
	Gui.FormQC.GsGridControlECR.SetStyleFormatConditionProperty("ECR","PRIORITY","ParentYellow","ApplyToRow",True)
	
	Gui.FormQC.GsGridControlECR.AddStyleFormatCondition("ECR","PRIORITY","ParentOrange","Equal","High")
	Gui.FormQC.GsGridControlECR.SetStyleFormatConditionProperty("ECR","PRIORITY","ParentOrange","BackColor","#ffa500")
	Gui.FormQC.GsGridControlECR.SetStyleFormatConditionProperty("ECR","PRIORITY","ParentOrange","ApplyToRow",True)
	
	Gui.FormQC.GsGridControlECR.AddStyleFormatCondition("ECR","DUE_DATE","ParentRed","Less",V.Ambient.Date)
	Gui.FormQC.GsGridControlECR.SetStyleFormatConditionProperty("ECR","DUE_DATE","ParentRed","BackColor","#fd6464")
	
	F.Intrinsic.String.Build("{0}\Custom\5398\{1}{2}_5398_ECR.txt",V.Caller.GlobalDir,V.Caller.User.Trim,V.Caller.CompanyCode,V.Local.sFile)
	
	F.Intrinsic.File.Exists(V.Local.sFile,V.Local.bRet)
	F.Intrinsic.Control.If(V.Local.bRet)
		F.Intrinsic.File.File2String(V.Local.sFile,V.Local.sReturn)
		Gui.FormQC.GsGridControlECR.Deserialize(V.Local.sReturn)
	F.Intrinsic.Control.EndIf
	
	Gui.FormQC.GsGridControlECR.MainView("ECR")
	
	F.Intrinsic.Control.ExitSub

F.Intrinsic.Control.Catch
	F.Intrinsic.Control.If(V.Ambient.ErrorNumber,<>,0)
		F.Intrinsic.String.Build("Project: {0}{1}Subroutine: {2}{1}Error Occurred {3} with description {4}","GCG_5398_CAR_ECN.g2u",V.Ambient.NewLine,V.Ambient.CurrentSubroutine,V.Ambient.ErrorNumber,V.Ambient.ErrorDescription,V.Local.sError)
		F.Intrinsic.UI.Msgbox(V.Local.sError)
		F.Intrinsic.Control.CallSub(FormQC_UnLoad)
	F.Intrinsic.Control.EndIf
Function.Intrinsic.Control.EndTry
Program.Sub.Set_Ecr_Properties.End

Program.Sub.Set_Signoff_Properties.Start
F.Intrinsic.Control.Try
	V.Local.sError.Declare(String,"")
	V.Local.sFile.Declare(String,"")
	V.Local.sReturn.Declare(String,"")
	V.Local.bRet.Declare(Boolean,False)
	V.Local.sTemp.Declare(String,"")
	
	Gui.FormQC.GsGridControlSignOff.AddGridviewFromDataTable("Signoff","Signoff")
	
	Gui.FormQC.GsGridControlSignOff.SetGridviewProperty("Signoff","Showgrouppanel",True)
	Gui.FormQC.GsGridControlSignOff.SetGridviewProperty("Signoff","Multiselect",False)
	Gui.FormQC.GsGridControlSignOff.SetGridviewProperty("Signoff","OptionsSelectionEnableAppearanceFocusedRow",False)
	Gui.FormQC.GsGridControlSignOff.SetGridviewProperty("Signoff","OptionsViewShowAutoFilterRow",True)
	Gui.FormQC.GsGridControlSignoff.SetGridviewProperty("Signoff","OptionsViewColumnAutoWidth",False)
	
	Gui.FormQC.GsGridControlSignOff.SetColumnProperty("Signoff","Doc_Link","ReadOnly",True)
	Gui.FormQC.GsGridControlSignOff.SetColumnProperty("Signoff","Doc_Link","AllowEdit",False)
	Gui.FormQC.GsGridControlSignOff.SetColumnProperty("Signoff","Doc_Link","Caption"," ")
	Gui.FormQC.GsGridControlSignOff.SetColumnProperty("Signoff","Doc_Link","Width",22)
	Gui.FormQC.GsGridControlSignOff.SetColumnProperty("Signoff","Doc_Link","Icon","DCS-ON")
	Gui.FormQC.GsGridControlSignOff.SetColumnProperty("Signoff","Doc_Link","HeaderBackColor","Green")
	Gui.FormQC.GsGridControlSignOff.SetColumnProperty("Signoff","Doc_Link","HeaderForeColor","White")
	Gui.FormQC.GsGridControlSignOff.SetColumnProperty("Signoff","Doc_Link","Fixed","Left")
	
	Gui.FormQC.GsGridControlSignOff.SetColumnProperty("Signoff","CCA_NO","ReadOnly",True)
	Gui.FormQC.GsGridControlSignOff.SetColumnProperty("Signoff","CCA_NO","AllowEdit",False)
	Gui.FormQC.GsGridControlSignOff.SetColumnProperty("Signoff","CCA_NO","Caption","CAPA #")
	Gui.FormQC.GsGridControlSignOff.SetColumnProperty("Signoff","CCA_NO","HeaderBackColor","Green")
	Gui.FormQC.GsGridControlSignOff.SetColumnProperty("Signoff","CCA_NO","HeaderForeColor","White")
	Gui.FormQC.GsGridControlSignoff.SetColumnProperty("Signoff","CCA_NO","CellHAlignment","Center")
	Gui.FormQC.GsGridControlSignoff.SetColumnProperty("Signoff","CCA_NO","Fixed","Left")
	Gui.FormQC.GsGridControlSignoff.SetColumnProperty("Signoff","CCA_NO","HeaderFontSize",10)
	Gui.FormQC.GsGridControlSignoff.SetColumnProperty("Signoff","CCA_NO","CellFontSize",10)
	
	Gui.FormQC.GsGridControlSignOff.SetColumnProperty("Signoff","ECR","ReadOnly",True)
	Gui.FormQC.GsGridControlSignOff.SetColumnProperty("Signoff","ECR","AllowEdit",False)
	Gui.FormQC.GsGridControlSignOff.SetColumnProperty("Signoff","ECR","Caption","ECR")
	Gui.FormQC.GsGridControlSignOff.SetColumnProperty("Signoff","ECR","HeaderBackColor","Green")
	Gui.FormQC.GsGridControlSignOff.SetColumnProperty("Signoff","ECR","HeaderForeColor","White")
	Gui.FormQC.GsGridControlSignoff.SetColumnProperty("Signoff","ECR","CellHAlignment","Center")
	Gui.FormQC.GsGridControlSignoff.SetColumnProperty("Signoff","ECR","Fixed","Left")
	Gui.FormQC.GsGridControlSignoff.SetColumnProperty("Signoff","ECR","HeaderFontSize",10)
	Gui.FormQC.GsGridControlSignoff.SetColumnProperty("Signoff","ECR","CellFontSize",10)
	
	Gui.FormQC.GsGridControlSignOff.SetColumnProperty("Signoff","DATE_ENTERED","ReadOnly",True)
	Gui.FormQC.GsGridControlSignOff.SetColumnProperty("Signoff","DATE_ENTERED","AllowEdit",False)
	Gui.FormQC.GsGridControlSignOff.SetColumnProperty("Signoff","DATE_ENTERED","Caption","Date Entered")
	Gui.FormQC.GsGridControlSignOff.SetColumnProperty("Signoff","DATE_ENTERED","HeaderBackColor","Green")
	Gui.FormQC.GsGridControlSignOff.SetColumnProperty("Signoff","DATE_ENTERED","HeaderForeColor","White")
	Gui.FormQC.GsGridControlSignoff.SetColumnProperty("Signoff","DATE_ENTERED","DisplayCustomDatetime","d")
	Gui.FormQC.GsGridControlSignoff.SetColumnProperty("Signoff","DATE_ENTERED","Fixed","Left")
	Gui.FormQC.GsGridControlSignoff.SetColumnProperty("Signoff","DATE_ENTERED","HeaderFontSize",10)
	Gui.FormQC.GsGridControlSignoff.SetColumnProperty("Signoff","DATE_ENTERED","CellFontSize",10)
	
	Gui.FormQC.GsGridControlSignOff.SetColumnProperty("Signoff","DUE_DATE","ReadOnly",True)
	Gui.FormQC.GsGridControlSignOff.SetColumnProperty("Signoff","DUE_DATE","AllowEdit",False)
	Gui.FormQC.GsGridControlSignOff.SetColumnProperty("Signoff","DUE_DATE","Caption","Due Date")
	Gui.FormQC.GsGridControlSignOff.SetColumnProperty("Signoff","DUE_DATE","HeaderBackColor","Green")
	Gui.FormQC.GsGridControlSignOff.SetColumnProperty("Signoff","DUE_DATE","HeaderForeColor","White")
	Gui.FormQC.GsGridControlSignoff.SetColumnProperty("Signoff","DUE_DATE","DisplayCustomDatetime","d")
	Gui.FormQC.GsGridControlSignoff.SetColumnProperty("Signoff","DUE_DATE","Fixed","Left")
	Gui.FormQC.GsGridControlSignoff.SetColumnProperty("Signoff","DUE_DATE","HeaderFontSize",10)
	Gui.FormQC.GsGridControlSignoff.SetColumnProperty("Signoff","DUE_DATE","CellFontSize",10)
	
	Gui.FormQC.GsGridControlSignOff.SetColumnProperty("Signoff","ORIG_USER","ReadOnly",True)
	Gui.FormQC.GsGridControlSignOff.SetColumnProperty("Signoff","ORIG_USER","AllowEdit",False)
	Gui.FormQC.GsGridControlSignOff.SetColumnProperty("Signoff","ORIG_USER","Caption","Orig User")
	Gui.FormQC.GsGridControlSignOff.SetColumnProperty("Signoff","ORIG_USER","HeaderBackColor","Green")
	Gui.FormQC.GsGridControlSignOff.SetColumnProperty("Signoff","ORIG_USER","HeaderForeColor","White")
	Gui.FormQC.GsGridControlSignoff.SetColumnProperty("Signoff","ORIG_USER","Fixed","Left")
	Gui.FormQC.GsGridControlSignoff.SetColumnProperty("Signoff","ORIG_USER","HeaderFontSize",10)
	Gui.FormQC.GsGridControlSignoff.SetColumnProperty("Signoff","ORIG_USER","CellFontSize",10)
	
	Gui.FormQC.GsGridControlSignOff.SetColumnProperty("Signoff","PRIORITY","ReadOnly",True)
	Gui.FormQC.GsGridControlSignOff.SetColumnProperty("Signoff","PRIORITY","AllowEdit",False)
	Gui.FormQC.GsGridControlSignOff.SetColumnProperty("Signoff","PRIORITY","Caption","Priority")
	Gui.FormQC.GsGridControlSignOff.SetColumnProperty("Signoff","PRIORITY","HeaderBackColor","Green")
	Gui.FormQC.GsGridControlSignOff.SetColumnProperty("Signoff","PRIORITY","HeaderForeColor","White")
	Gui.FormQC.GsGridControlSignoff.SetColumnProperty("Signoff","PRIORITY","Fixed","Left")
	Gui.FormQC.GsGridControlSignoff.SetColumnProperty("Signoff","PRIORITY","HeaderFontSize",10)
	Gui.FormQC.GsGridControlSignoff.SetColumnProperty("Signoff","PRIORITY","CellFontSize",10)
	
	Gui.FormQC.GsGridControlSignOff.SetColumnProperty("Signoff","PROJECT_TYPE","ReadOnly",True)
	Gui.FormQC.GsGridControlSignOff.SetColumnProperty("Signoff","PROJECT_TYPE","AllowEdit",False)
	Gui.FormQC.GsGridControlSignOff.SetColumnProperty("Signoff","PROJECT_TYPE","Caption","Type")
	Gui.FormQC.GsGridControlSignOff.SetColumnProperty("Signoff","PROJECT_TYPE","HeaderBackColor","Green")
	Gui.FormQC.GsGridControlSignOff.SetColumnProperty("Signoff","PROJECT_TYPE","HeaderForeColor","White")
	Gui.FormQC.GsGridControlSignoff.SetColumnProperty("Signoff","PROJECT_TYPE","HeaderFontSize",10)
	Gui.FormQC.GsGridControlSignoff.SetColumnProperty("Signoff","PROJECT_TYPE","CellFontSize",10)
	
	Gui.FormQC.GsGridControlSignOff.SetColumnProperty("Signoff","Source","ReadOnly",True)
	Gui.FormQC.GsGridControlSignOff.SetColumnProperty("Signoff","Source","AllowEdit",False)
	Gui.FormQC.GsGridControlSignOff.SetColumnProperty("Signoff","Source","Caption","Source")
	Gui.FormQC.GsGridControlSignOff.SetColumnProperty("Signoff","Source","HeaderBackColor","Green")
	Gui.FormQC.GsGridControlSignOff.SetColumnProperty("Signoff","Source","HeaderForeColor","White")
	Gui.FormQC.GsGridControlSignoff.SetColumnProperty("Signoff","Source","HeaderFontSize",10)
	Gui.FormQC.GsGridControlSignoff.SetColumnProperty("Signoff","Source","CellFontSize",10)
	
	Gui.FormQC.GsGridControlSignOff.SetColumnProperty("Signoff","PART","ReadOnly",True)
	Gui.FormQC.GsGridControlSignOff.SetColumnProperty("Signoff","PART","AllowEdit",False)
	Gui.FormQC.GsGridControlSignOff.SetColumnProperty("Signoff","PART","Caption","Part #")
	Gui.FormQC.GsGridControlSignOff.SetColumnProperty("Signoff","PART","HeaderBackColor","Green")
	Gui.FormQC.GsGridControlSignOff.SetColumnProperty("Signoff","PART","HeaderForeColor","White")
	Gui.FormQC.GsGridControlSignoff.SetColumnProperty("Signoff","PART","HeaderFontSize",10)
	Gui.FormQC.GsGridControlSignoff.SetColumnProperty("Signoff","PART","CellFontSize",10)
	
	Gui.FormQC.GsGridControlSignOff.SetColumnProperty("Signoff","WO","ReadOnly",True)
	Gui.FormQC.GsGridControlSignOff.SetColumnProperty("Signoff","WO","AllowEdit",False)
	Gui.FormQC.GsGridControlSignOff.SetColumnProperty("Signoff","WO","HeaderBackColor","Green")
	Gui.FormQC.GsGridControlSignOff.SetColumnProperty("Signoff","WO","HeaderForeColor","White")
	Gui.FormQC.GsGridControlSignoff.SetColumnProperty("Signoff","WO","HeaderFontSize",10)
	Gui.FormQC.GsGridControlSignoff.SetColumnProperty("Signoff","WO","CellFontSize",10)
	
	Gui.FormQC.GsGridControlSignOff.SetColumnProperty("Signoff","SO","ReadOnly",True)
	Gui.FormQC.GsGridControlSignOff.SetColumnProperty("Signoff","SO","AllowEdit",False)
	Gui.FormQC.GsGridControlSignOff.SetColumnProperty("Signoff","SO","HeaderBackColor","Green")
	Gui.FormQC.GsGridControlSignOff.SetColumnProperty("Signoff","SO","HeaderForeColor","White")
	Gui.FormQC.GsGridControlSignoff.SetColumnProperty("Signoff","SO","HeaderFontSize",10)
	Gui.FormQC.GsGridControlSignoff.SetColumnProperty("Signoff","SO","CellFontSize",10)
	
	Gui.FormQC.GsGridControlSignOff.SetColumnProperty("Signoff","ISSUE","ReadOnly",True)
	Gui.FormQC.GsGridControlSignOff.SetColumnProperty("Signoff","ISSUE","AllowEdit",False)
	Gui.FormQC.GsGridControlSignOff.SetColumnProperty("Signoff","ISSUE","Caption","Issue")
	Gui.FormQC.GsGridControlSignOff.SetColumnProperty("Signoff","ISSUE","HeaderBackColor","Green")
	Gui.FormQC.GsGridControlSignOff.SetColumnProperty("Signoff","ISSUE","HeaderForeColor","White")
	Gui.FormQC.GsGridControlSignoff.SetColumnProperty("Signoff","ISSUE","HeaderFontSize",10)
	Gui.FormQC.GsGridControlSignoff.SetColumnProperty("Signoff","ISSUE","CellFontSize",10)
	
	Gui.FormQC.GsGridControlSignOff.SetColumnProperty("Signoff","DESCRIPTION","ReadOnly",True)
	Gui.FormQC.GsGridControlSignOff.SetColumnProperty("Signoff","DESCRIPTION","AllowEdit",False)
	Gui.FormQC.GsGridControlSignOff.SetColumnProperty("Signoff","DESCRIPTION","Caption","Description")
	Gui.FormQC.GsGridControlSignOff.SetColumnProperty("Signoff","DESCRIPTION","HeaderBackColor","Green")
	Gui.FormQC.GsGridControlSignOff.SetColumnProperty("Signoff","DESCRIPTION","HeaderForeColor","White")
	Gui.FormQC.GsGridControlSignoff.SetColumnProperty("Signoff","DESCRIPTION","HeaderFontSize",10)
	Gui.FormQC.GsGridControlSignoff.SetColumnProperty("Signoff","DESCRIPTION","CellFontSize",10)
	
	Gui.FormQC.GsGridControlSignOff.SetColumnProperty("Signoff","ROOT_CAUSE","ReadOnly",True)
	Gui.FormQC.GsGridControlSignOff.SetColumnProperty("Signoff","ROOT_CAUSE","AllowEdit",False)
	Gui.FormQC.GsGridControlSignOff.SetColumnProperty("Signoff","ROOT_CAUSE","Caption","Root Cause")
	Gui.FormQC.GsGridControlSignOff.SetColumnProperty("Signoff","ROOT_CAUSE","HeaderBackColor","Green")
	Gui.FormQC.GsGridControlSignOff.SetColumnProperty("Signoff","ROOT_CAUSE","HeaderForeColor","White")
	Gui.FormQC.GsGridControlSignOff.SetColumnProperty("Signoff","ROOT_CAUSE","HeaderFontSize",10)
	Gui.FormQC.GsGridControlSignOff.SetColumnProperty("Signoff","ROOT_CAUSE","CellFontSize",10)
	
	Gui.FormQC.GsGridControlSignOff.SetColumnProperty("Signoff","ACTION_PLAN","ReadOnly",True)
	Gui.FormQC.GsGridControlSignOff.SetColumnProperty("Signoff","ACTION_PLAN","AllowEdit",False)
	Gui.FormQC.GsGridControlSignOff.SetColumnProperty("Signoff","ACTION_PLAN","Caption","Action_Plan")
	Gui.FormQC.GsGridControlSignOff.SetColumnProperty("Signoff","ACTION_PLAN","HeaderBackColor","Green")
	Gui.FormQC.GsGridControlSignOff.SetColumnProperty("Signoff","ACTION_PLAN","HeaderForeColor","White")
	Gui.FormQC.GsGridControlSignOff.SetColumnProperty("Signoff","ACTION_PLAN","HeaderFontSize",10)
	Gui.FormQC.GsGridControlSignOff.SetColumnProperty("Signoff","ACTION_PLAN","CellFontSize",10)
	
	Gui.FormQC.GsGridControlSignOff.SetColumnProperty("Signoff","STATUS","ReadOnly",True)
	Gui.FormQC.GsGridControlSignOff.SetColumnProperty("Signoff","STATUS","AllowEdit",False)
	Gui.FormQC.GsGridControlSignOff.SetColumnProperty("Signoff","STATUS","Caption","Status")
	Gui.FormQC.GsGridControlSignOff.SetColumnProperty("Signoff","STATUS","Visible",False)
	Gui.FormQC.GsGridControlSignOff.SetColumnProperty("Signoff","STATUS","HeaderBackColor","Green")
	Gui.FormQC.GsGridControlSignOff.SetColumnProperty("Signoff","STATUS","HeaderForeColor","White")
	Gui.FormQC.GsGridControlSignoff.SetColumnProperty("Signoff","STATUS","HeaderFontSize",10)
	Gui.FormQC.GsGridControlSignoff.SetColumnProperty("Signoff","STATUS","CellFontSize",10)
	
	Gui.FormQC.GsGridControlSignOff.SetColumnProperty("Signoff","ASSIGNED_Dept","ReadOnly",True)
	Gui.FormQC.GsGridControlSignOff.SetColumnProperty("Signoff","ASSIGNED_Dept","AllowEdit",False)
	Gui.FormQC.GsGridControlSignOff.SetColumnProperty("Signoff","ASSIGNED_Dept","Caption","Assigned Dept")
	Gui.FormQC.GsGridControlSignOff.SetColumnProperty("Signoff","ASSIGNED_Dept","Visible",False)
	Gui.FormQC.GsGridControlSignOff.SetColumnProperty("Signoff","ASSIGNED_Dept","HeaderBackColor","Green")
	Gui.FormQC.GsGridControlSignOff.SetColumnProperty("Signoff","ASSIGNED_Dept","HeaderForeColor","White")
	Gui.FormQC.GsGridControlSignoff.SetColumnProperty("Signoff","ASSIGNED_Dept","HeaderFontSize",10)
	Gui.FormQC.GsGridControlSignoff.SetColumnProperty("Signoff","ASSIGNED_Dept","CellFontSize",10)
	
	Gui.FormQC.GsGridControlSignOff.SetColumnProperty("Signoff","ASSIGNED_TO","ReadOnly",True)
	Gui.FormQC.GsGridControlSignOff.SetColumnProperty("Signoff","ASSIGNED_TO","AllowEdit",False)
	Gui.FormQC.GsGridControlSignOff.SetColumnProperty("Signoff","ASSIGNED_TO","Caption","Assigned To")
	Gui.FormQC.GsGridControlSignOff.SetColumnProperty("Signoff","ASSIGNED_TO","Visible",False)
	Gui.FormQC.GsGridControlSignOff.SetColumnProperty("Signoff","ASSIGNED_TO","HeaderBackColor","Green")
	Gui.FormQC.GsGridControlSignOff.SetColumnProperty("Signoff","ASSIGNED_TO","HeaderForeColor","White")
	Gui.FormQC.GsGridControlSignoff.SetColumnProperty("Signoff","ASSIGNED_TO","HeaderFontSize",10)
	Gui.FormQC.GsGridControlSignoff.SetColumnProperty("Signoff","ASSIGNED_TO","CellFontSize",10)
	
	Gui.FormQC.GsGridControlSignOff.SetColumnProperty("Signoff","EST_COST_INC","ReadOnly",True)
	Gui.FormQC.GsGridControlSignOff.SetColumnProperty("Signoff","EST_COST_INC","AllowEdit",False)
	Gui.FormQC.GsGridControlSignOff.SetColumnProperty("Signoff","EST_COST_INC","Caption","Est Cost")
	Gui.FormQC.GsGridControlSignOff.SetColumnProperty("Signoff","EST_COST_INC","Visible",False)
	Gui.FormQC.GsGridControlSignOff.SetColumnProperty("Signoff","EST_COST_INC","HeaderBackColor","Green")
	Gui.FormQC.GsGridControlSignOff.SetColumnProperty("Signoff","EST_COST_INC","HeaderForeColor","White")
	Gui.FormQC.GsGridControlSignoff.SetColumnProperty("Signoff","EST_COST_INC","HeaderFontSize",10)
	Gui.FormQC.GsGridControlSignoff.SetColumnProperty("Signoff","EST_COST_INC","CellFontSize",10)
	
	Gui.FormQC.GsGridControlSignOff.SetColumnProperty("Signoff","WorkGroup","ReadOnly",True)
	Gui.FormQC.GsGridControlSignOff.SetColumnProperty("Signoff","WorkGroup","AllowEdit",False)
	Gui.FormQC.GsGridControlSignOff.SetColumnProperty("Signoff","WorkGroup","Caption","WG")
	Gui.FormQC.GsGridControlSignOff.SetColumnProperty("Signoff","WorkGroup","Visible",False)
	Gui.FormQC.GsGridControlSignOff.SetColumnProperty("Signoff","WorkGroup","HeaderBackColor","Green")
	Gui.FormQC.GsGridControlSignOff.SetColumnProperty("Signoff","WorkGroup","HeaderForeColor","White")
	Gui.FormQC.GsGridControlSignoff.SetColumnProperty("Signoff","WorkGroup","HeaderFontSize",10)
	Gui.FormQC.GsGridControlSignoff.SetColumnProperty("Signoff","WorkGroup","CellFontSize",10)
	
	Gui.FormQC.GsGridControlSignOff.SetColumnProperty("Signoff","QA_SIGNOFF","ReadOnly",True)
	Gui.FormQC.GsGridControlSignOff.SetColumnProperty("Signoff","QA_SIGNOFF","AllowEdit",False)
	Gui.FormQC.GsGridControlSignOff.SetColumnProperty("Signoff","QA_SIGNOFF","Caption","QA Signoff")
	Gui.FormQC.GsGridControlSignOff.SetColumnProperty("Signoff","QA_SIGNOFF","HeaderBackColor","Green")
	Gui.FormQC.GsGridControlSignOff.SetColumnProperty("Signoff","QA_SIGNOFF","HeaderForeColor","White")
	Gui.FormQC.GsGridControlSignoff.SetColumnProperty("Signoff","QA_SIGNOFF","HeaderFontSize",10)
	Gui.FormQC.GsGridControlSignoff.SetColumnProperty("Signoff","QA_SIGNOFF","CellFontSize",10)
	
	Gui.FormQC.GsGridControlSignOff.SetColumnProperty("Signoff","QA_USER","ReadOnly",True)
	Gui.FormQC.GsGridControlSignOff.SetColumnProperty("Signoff","QA_USER","AllowEdit",False)
	Gui.FormQC.GsGridControlSignOff.SetColumnProperty("Signoff","QA_USER","Caption","QA User")
	Gui.FormQC.GsGridControlSignOff.SetColumnProperty("Signoff","QA_USER","HeaderBackColor","Green")
	Gui.FormQC.GsGridControlSignOff.SetColumnProperty("Signoff","QA_USER","HeaderForeColor","White")
	Gui.FormQC.GsGridControlSignoff.SetColumnProperty("Signoff","QA_USER","HeaderFontSize",10)
	Gui.FormQC.GsGridControlSignoff.SetColumnProperty("Signoff","QA_USER","CellFontSize",10)
	
	Gui.FormQC.GsGridControlSignOff.SetColumnProperty("Signoff","ADD_Group_1","ReadOnly",True)
	Gui.FormQC.GsGridControlSignOff.SetColumnProperty("Signoff","ADD_Group_1","AllowEdit",False)
	Gui.FormQC.GsGridControlSignOff.SetColumnProperty("Signoff","ADD_Group_1","Caption","Additional Group 1")
	Gui.FormQC.GsGridControlSignOff.SetColumnProperty("Signoff","ADD_Group_1","HeaderBackColor","Green")
	Gui.FormQC.GsGridControlSignOff.SetColumnProperty("Signoff","ADD_Group_1","HeaderForeColor","White")
	Gui.FormQC.GsGridControlSignoff.SetColumnProperty("Signoff","ADD_Group_1","HeaderFontSize",10)
	Gui.FormQC.GsGridControlSignoff.SetColumnProperty("Signoff","ADD_Group_1","CellFontSize",10)
	
	Gui.FormQC.GsGridControlSignOff.SetColumnProperty("Signoff","Group_1_SIGNOFF","ReadOnly",True)
	Gui.FormQC.GsGridControlSignOff.SetColumnProperty("Signoff","Group_1_SIGNOFF","AllowEdit",False)
	Gui.FormQC.GsGridControlSignOff.SetColumnProperty("Signoff","Group_1_SIGNOFF","Caption","Group 1 Signoff")
	Gui.FormQC.GsGridControlSignOff.SetColumnProperty("Signoff","Group_1_SIGNOFF","HeaderBackColor","Green")
	Gui.FormQC.GsGridControlSignOff.SetColumnProperty("Signoff","Group_1_SIGNOFF","HeaderForeColor","White")
	Gui.FormQC.GsGridControlSignoff.SetColumnProperty("Signoff","Group_1_SIGNOFF","HeaderFontSize",10)
	Gui.FormQC.GsGridControlSignoff.SetColumnProperty("Signoff","Group_1_SIGNOFF","CellFontSize",10)
	
	Gui.FormQC.GsGridControlSignOff.SetColumnProperty("Signoff","Group_1_USER","ReadOnly",True)
	Gui.FormQC.GsGridControlSignOff.SetColumnProperty("Signoff","Group_1_USER","AllowEdit",False)
	Gui.FormQC.GsGridControlSignOff.SetColumnProperty("Signoff","Group_1_USER","Caption","Group 1 User")
	Gui.FormQC.GsGridControlSignOff.SetColumnProperty("Signoff","Group_1_USER","HeaderBackColor","Green")
	Gui.FormQC.GsGridControlSignOff.SetColumnProperty("Signoff","Group_1_USER","HeaderForeColor","White")
	Gui.FormQC.GsGridControlSignoff.SetColumnProperty("Signoff","Group_1_USER","HeaderFontSize",10)
	Gui.FormQC.GsGridControlSignoff.SetColumnProperty("Signoff","Group_1_USER","CellFontSize",10)
	
	Gui.FormQC.GsGridControlSignOff.SetColumnProperty("Signoff","ADD_Group_2","ReadOnly",True)
	Gui.FormQC.GsGridControlSignOff.SetColumnProperty("Signoff","ADD_Group_2","AllowEdit",False)
	Gui.FormQC.GsGridControlSignOff.SetColumnProperty("Signoff","ADD_Group_2","Caption","Additional Group 2")
	Gui.FormQC.GsGridControlSignOff.SetColumnProperty("Signoff","ADD_Group_2","HeaderBackColor","Green")
	Gui.FormQC.GsGridControlSignOff.SetColumnProperty("Signoff","ADD_Group_2","HeaderForeColor","White")
	Gui.FormQC.GsGridControlSignoff.SetColumnProperty("Signoff","ADD_Group_2","HeaderFontSize",10)
	Gui.FormQC.GsGridControlSignoff.SetColumnProperty("Signoff","ADD_Group_2","CellFontSize",10)
	
	Gui.FormQC.GsGridControlSignOff.SetColumnProperty("Signoff","Group_2_SIGNOFF","ReadOnly",True)
	Gui.FormQC.GsGridControlSignOff.SetColumnProperty("Signoff","Group_2_SIGNOFF","AllowEdit",False)
	Gui.FormQC.GsGridControlSignOff.SetColumnProperty("Signoff","Group_2_SIGNOFF","Caption","Group 2 Signoff")
	Gui.FormQC.GsGridControlSignOff.SetColumnProperty("Signoff","Group_2_SIGNOFF","HeaderBackColor","Green")
	Gui.FormQC.GsGridControlSignOff.SetColumnProperty("Signoff","Group_2_SIGNOFF","HeaderForeColor","White")
	Gui.FormQC.GsGridControlSignoff.SetColumnProperty("Signoff","Group_2_SIGNOFF","HeaderFontSize",10)
	Gui.FormQC.GsGridControlSignoff.SetColumnProperty("Signoff","Group_2_SIGNOFF","CellFontSize",10)
	
	Gui.FormQC.GsGridControlSignOff.SetColumnProperty("Signoff","Group_2_USER","ReadOnly",True)
	Gui.FormQC.GsGridControlSignOff.SetColumnProperty("Signoff","Group_2_USER","AllowEdit",False)
	Gui.FormQC.GsGridControlSignOff.SetColumnProperty("Signoff","Group_2_USER","Caption","Group 2 User")
	Gui.FormQC.GsGridControlSignOff.SetColumnProperty("Signoff","Group_2_USER","HeaderBackColor","Green")
	Gui.FormQC.GsGridControlSignOff.SetColumnProperty("Signoff","Group_2_USER","HeaderForeColor","White")
	Gui.FormQC.GsGridControlSignoff.SetColumnProperty("Signoff","Group_2_USER","HeaderFontSize",10)
	Gui.FormQC.GsGridControlSignoff.SetColumnProperty("Signoff","Group_2_USER","CellFontSize",10)
	
	Gui.FormQC.GsGridControlSignOff.SetColumnProperty("Signoff","ORIG_DRAWNBY","ReadOnly",True)
	Gui.FormQC.GsGridControlSignOff.SetColumnProperty("Signoff","ORIG_DRAWNBY","AllowEdit",False)
	Gui.FormQC.GsGridControlSignOff.SetColumnProperty("Signoff","ORIG_DRAWNBY","Caption","Orig. Drawn By")
	Gui.FormQC.GsGridControlSignOff.SetColumnProperty("Signoff","ORIG_DRAWNBY","HeaderBackColor","Green")
	Gui.FormQC.GsGridControlSignOff.SetColumnProperty("Signoff","ORIG_DRAWNBY","HeaderForeColor","White")
	Gui.FormQC.GsGridControlSignoff.SetColumnProperty("Signoff","ORIG_DRAWNBY","HeaderFontSize",10)
	Gui.FormQC.GsGridControlSignoff.SetColumnProperty("Signoff","ORIG_DRAWNBY","CellFontSize",10)
	
	Gui.FormQC.GsGridControlSignOff.SetColumnProperty("Signoff","ORIG_CHECKBY","ReadOnly",True)
	Gui.FormQC.GsGridControlSignOff.SetColumnProperty("Signoff","ORIG_CHECKBY","AllowEdit",False)
	Gui.FormQC.GsGridControlSignOff.SetColumnProperty("Signoff","ORIG_CHECKBY","Caption","Orig. Checked By")
	Gui.FormQC.GsGridControlSignOff.SetColumnProperty("Signoff","ORIG_CHECKBY","HeaderBackColor","Green")
	Gui.FormQC.GsGridControlSignOff.SetColumnProperty("Signoff","ORIG_CHECKBY","HeaderForeColor","White")
	Gui.FormQC.GsGridControlSignoff.SetColumnProperty("Signoff","ORIG_CHECKBY","HeaderFontSize",10)
	Gui.FormQC.GsGridControlSignoff.SetColumnProperty("Signoff","ORIG_CHECKBY","CellFontSize",10)
	
	Gui.FormQC.GsGridControlSignOff.SetColumnProperty("Signoff","ORIG_MODELBY","ReadOnly",True)
	Gui.FormQC.GsGridControlSignOff.SetColumnProperty("Signoff","ORIG_MODELBY","AllowEdit",False)
	Gui.FormQC.GsGridControlSignOff.SetColumnProperty("Signoff","ORIG_MODELBY","Caption","Orig. Model By")
	Gui.FormQC.GsGridControlSignOff.SetColumnProperty("Signoff","ORIG_MODELBY","HeaderBackColor","Green")
	Gui.FormQC.GsGridControlSignOff.SetColumnProperty("Signoff","ORIG_MODELBY","HeaderForeColor","White")
	Gui.FormQC.GsGridControlSignoff.SetColumnProperty("Signoff","ORIG_MODELBY","HeaderFontSize",10)
	Gui.FormQC.GsGridControlSignoff.SetColumnProperty("Signoff","ORIG_MODELBY","CellFontSize",10)
	
	Gui.FormQC.GsGridControlSignoff.SetColumnProperty("Signoff","COMPLETED_DATE","ReadOnly",True)
	Gui.FormQC.GsGridControlSignoff.SetColumnProperty("Signoff","COMPLETED_DATE","AllowEdit",False)
	Gui.FormQC.GsGridControlSignoff.SetColumnProperty("Signoff","COMPLETED_DATE","Visible",False)
	Gui.FormQC.GsGridControlSignoff.SetColumnProperty("Signoff","COMPLETED_DATE","Caption","Completed Date")
	Gui.FormQC.GsGridControlSignoff.SetColumnProperty("Signoff","COMPLETED_DATE","HeaderBackColor","Green")
	Gui.FormQC.GsGridControlSignoff.SetColumnProperty("Signoff","COMPLETED_DATE","HeaderForeColor","White")
	Gui.FormQC.GsGridControlSignoff.SetColumnProperty("Signoff","COMPLETED_DATE","DisplayCustomDatetime","d")
	Gui.FormQC.GsGridControlSignoff.SetColumnProperty("Signoff","COMPLETED_DATE","HeaderFontSize",10)
	Gui.FormQC.GsGridControlSignoff.SetColumnProperty("Signoff","COMPLETED_DATE","CellFontSize",10)
	
	Gui.FormQC.GsGridControlSignOff.SetColumnProperty("Signoff","Edit","ReadOnly",True)
	Gui.FormQC.GsGridControlSignOff.SetColumnProperty("Signoff","Edit","AllowEdit",False)
	Gui.FormQC.GsGridControlSignOff.SetColumnProperty("Signoff","Edit","Caption"," ")
	Gui.FormQC.GsGridControlSignOff.SetColumnProperty("Signoff","Edit","HeaderBackColor","Green")
	Gui.FormQC.GsGridControlSignOff.SetColumnProperty("Signoff","Edit","HeaderForeColor","White")
'	Gui.FormQC.GsGridControlSignOff.SetColumnProperty("Signoff","Edit","CellBackColor","Gray")
	Gui.FormQC.GsGridControlSignOff.SetColumnProperty("Signoff","Edit","CellFontBold",True)
	Gui.FormQC.GsGridControlSignOff.SetColumnProperty("Signoff","Edit","CellHAlignment","Center")
	Gui.FormQC.GsGridControlSignoff.SetColumnProperty("Signoff","Edit","Fixed","Right")
	Gui.FormQC.GsGridControlSignoff.SetColumnProperty("Signoff","Edit","MaxWidth","60")
	Gui.FormQC.GsGridControlSignOff.ColumnEdit("Signoff","Edit","EditorButton","Edit")
	
	Gui.FormQC.GsGridControlSignOff.SetColumnProperty("Signoff","Delete","ReadOnly",True)
	Gui.FormQC.GsGridControlSignOff.SetColumnProperty("Signoff","Delete","AllowEdit",False)
	Gui.FormQC.GsGridControlSignOff.SetColumnProperty("Signoff","Delete","Caption"," ")
	Gui.FormQC.GsGridControlSignOff.SetColumnProperty("Signoff","Delete","HeaderBackColor","Green")
	Gui.FormQC.GsGridControlSignOff.SetColumnProperty("Signoff","Delete","HeaderForeColor","White")
'	Gui.FormQC.GsGridControlSignOff.SetColumnProperty("Signoff","Delete","CellBackColor","Gray")
	Gui.FormQC.GsGridControlSignOff.SetColumnProperty("Signoff","Delete","CellFontBold",True)
	Gui.FormQC.GsGridControlSignOff.SetColumnProperty("Signoff","Delete","CellHAlignment","Center")
	Gui.FormQC.GsGridControlSignOff.SetColumnProperty("Signoff","Delete","MaxWidth","60")
	Gui.FormQC.GsGridControlSignOff.SetColumnProperty("Signoff","Delete","Fixed","Right")
	Gui.FormQC.GsGridControlSignOff.ColumnEdit("Signoff","Delete","EditorButton","Delete")
	
	Gui.FormQC.GsGridControlSignOff.AddStyleFormatCondition("Signoff","PRIORITY","ParentCRed","Equal","Critical")
	Gui.FormQC.GsGridControlSignOff.SetStyleFormatConditionProperty("Signoff","PRIORITY","ParentCRed","BackColor","#fd6464")
	Gui.FormQC.GsGridControlSignOff.SetStyleFormatConditionProperty("Signoff","PRIORITY","ParentCRed","ApplyToRow",True)
	
	Gui.FormQC.GsGridControlSignOff.AddStyleFormatCondition("Signoff","PRIORITY","ParentYellow","Equal","Medium")
	Gui.FormQC.GsGridControlSignOff.SetStyleFormatConditionProperty("Signoff","PRIORITY","ParentYellow","BackColor","#EDFD73")
	Gui.FormQC.GsGridControlSignOff.SetStyleFormatConditionProperty("Signoff","PRIORITY","ParentYellow","ApplyToRow",True)
	
	Gui.FormQC.GsGridControlSignOff.AddStyleFormatCondition("Signoff","PRIORITY","ParentOrange","Equal","High")
	Gui.FormQC.GsGridControlSignOff.SetStyleFormatConditionProperty("Signoff","PRIORITY","ParentOrange","BackColor","#ffa500")
	Gui.FormQC.GsGridControlSignOff.SetStyleFormatConditionProperty("Signoff","PRIORITY","ParentOrange","ApplyToRow",True)
	
	Gui.FormQC.GsGridControlSignOff.AddStyleFormatCondition("Signoff","DUE_DATE","ParentRed","Less",V.Ambient.Date)
	Gui.FormQC.GsGridControlSignOff.SetStyleFormatConditionProperty("Signoff","DUE_DATE","ParentRed","BackColor","#fd6464")
	
	F.Intrinsic.String.Build("{0}\Custom\5398\{1}{2}_5398_Signoff.txt",V.Caller.GlobalDir,V.Caller.User.Trim,V.Caller.CompanyCode,V.Local.sFile)
	
	F.Intrinsic.File.Exists(V.Local.sFile,V.Local.bRet)
	F.Intrinsic.Control.If(V.Local.bRet)
		F.Intrinsic.File.File2String(V.Local.sFile,V.Local.sReturn)
		Gui.FormQC.GsGridControlSignOff.Deserialize(V.Local.sReturn)
	F.Intrinsic.Control.EndIf
	
	Gui.FormQC.GsGridControlSignOff.MainView("Signoff")
	
	F.Intrinsic.Control.ExitSub

F.Intrinsic.Control.Catch
	F.Intrinsic.Control.If(V.Ambient.ErrorNumber,<>,0)
		F.Intrinsic.String.Build("Project: {0}{1}Subroutine: {2}{1}Error Occurred {3} with description {4}","GCG_5398_CAR_ECN.g2u",V.Ambient.NewLine,V.Ambient.CurrentSubroutine,V.Ambient.ErrorNumber,V.Ambient.ErrorDescription,V.Local.sError)
		F.Intrinsic.UI.Msgbox(V.Local.sError)
		F.Intrinsic.Control.CallSub(FormQC_UnLoad)
	F.Intrinsic.Control.EndIf
Function.Intrinsic.Control.EndTry
Program.Sub.Set_Signoff_Properties.End

Program.Sub.Set_Complete_Properties.Start
F.Intrinsic.Control.Try
	V.Local.sError.Declare(String,"")
	V.Local.sFile.Declare(String,"")
	V.Local.sReturn.Declare(String,"")
	V.Local.bRet.Declare(Boolean,False)

	Gui.FormQC.GsGridControlCompleted.AddGridviewFromDataTable("Complete","Complete")
	
	Gui.FormQC.GsGridControlCompleted.SetGridviewProperty("Complete","Enableappearanceoddrow",True)
	Gui.FormQC.GsGridControlCompleted.SetGridviewProperty("Complete","Showgrouppanel",True)
	Gui.FormQC.GsGridControlCompleted.SetGridviewProperty("Complete","Multiselect",False)
	Gui.FormQC.GsGridControlCompleted.SetGridviewProperty("Complete","OptionsSelectionEnableAppearanceFocusedRow",False)
	Gui.FormQC.GsGridControlCompleted.SetGridviewProperty("Complete","OptionsViewShowAutoFilterRow",True)
	Gui.FormQC.GsGridControlCompleted.SetGridviewProperty("Complete","OptionsViewColumnAutoWidth",False)
	
	Gui.FormQC.GsGridControlCompleted.SetColumnProperty("Complete","Doc_Link","ReadOnly",True)
	Gui.FormQC.GsGridControlCompleted.SetColumnProperty("Complete","Doc_Link","AllowEdit",False)
	Gui.FormQC.GsGridControlCompleted.SetColumnProperty("Complete","Doc_Link","Caption"," ")
	Gui.FormQC.GsGridControlCompleted.SetColumnProperty("Complete","Doc_Link","MaxWidth",22)
	Gui.FormQC.GsGridControlCompleted.SetColumnProperty("Complete","Doc_Link","Icon","DCS-ON")
	Gui.FormQC.GsGridControlCompleted.SetColumnProperty("Complete","Doc_Link","HeaderBackColor","Green")
	Gui.FormQC.GsGridControlCompleted.SetColumnProperty("Complete","Doc_Link","HeaderForeColor","White")
	Gui.FormQC.GsGridControlCompleted.SetColumnProperty("Complete","Doc_Link","Fixed","Left")
	
	Gui.FormQC.GsGridControlCompleted.SetColumnProperty("Complete","CCA_NO","ReadOnly",True)
	Gui.FormQC.GsGridControlCompleted.SetColumnProperty("Complete","CCA_NO","AllowEdit",False)
	Gui.FormQC.GsGridControlCompleted.SetColumnProperty("Complete","CCA_NO","Caption","CAPA #")
	Gui.FormQC.GsGridControlCompleted.SetColumnProperty("Complete","CCA_NO","HeaderBackColor","Green")
	Gui.FormQC.GsGridControlCompleted.SetColumnProperty("Complete","CCA_NO","HeaderForeColor","White")
	Gui.FormQC.GsGridControlCompleted.SetColumnProperty("Complete","CCA_NO","CellHAlignment","Center")
	Gui.FormQC.GsGridControlCompleted.SetColumnProperty("Complete","CCA_NO","Fixed","Left")
	Gui.FormQC.GsGridControlCompleted.SetColumnProperty("Complete","CCA_NO","HeaderFontSize",10)
	Gui.FormQC.GsGridControlCompleted.SetColumnProperty("Complete","CCA_NO","CellFontSize",10)
	
	Gui.FormQC.GsGridControlCompleted.SetColumnProperty("Complete","ECR","ReadOnly",True)
	Gui.FormQC.GsGridControlCompleted.SetColumnProperty("Complete","ECR","AllowEdit",False)
	Gui.FormQC.GsGridControlCompleted.SetColumnProperty("Complete","ECR","Caption","ECR")
	Gui.FormQC.GsGridControlCompleted.SetColumnProperty("Complete","ECR","HeaderBackColor","Green")
	Gui.FormQC.GsGridControlCompleted.SetColumnProperty("Complete","ECR","HeaderForeColor","White")
	Gui.FormQC.GsGridControlCompleted.SetColumnProperty("Complete","ECR","CellHAlignment","Center")
	Gui.FormQC.GsGridControlCompleted.SetColumnProperty("Complete","ECR","Fixed","Left")
	Gui.FormQC.GsGridControlCompleted.SetColumnProperty("Complete","ECR","HeaderFontSize",10)
	Gui.FormQC.GsGridControlCompleted.SetColumnProperty("Complete","ECR","CellFontSize",10)
	
	Gui.FormQC.GsGridControlCompleted.SetColumnProperty("Complete","DATE_ENTERED","ReadOnly",True)
	Gui.FormQC.GsGridControlCompleted.SetColumnProperty("Complete","DATE_ENTERED","AllowEdit",False)
	Gui.FormQC.GsGridControlCompleted.SetColumnProperty("Complete","DATE_ENTERED","Caption","Date Entered")
	Gui.FormQC.GsGridControlCompleted.SetColumnProperty("Complete","DATE_ENTERED","HeaderBackColor","Green")
	Gui.FormQC.GsGridControlCompleted.SetColumnProperty("Complete","DATE_ENTERED","HeaderForeColor","White")
	Gui.FormQC.GsGridControlCompleted.SetColumnProperty("Complete","DATE_ENTERED","DisplayCustomDatetime","d")
	Gui.FormQC.GsGridControlCompleted.SetColumnProperty("Complete","DATE_ENTERED","Fixed","Left")
	Gui.FormQC.GsGridControlCompleted.SetColumnProperty("Complete","DATE_ENTERED","HeaderFontSize",10)
	Gui.FormQC.GsGridControlCompleted.SetColumnProperty("Complete","DATE_ENTERED","CellFontSize",10)
	
	Gui.FormQC.GsGridControlCompleted.SetColumnProperty("Complete","DUE_DATE","ReadOnly",True)
	Gui.FormQC.GsGridControlCompleted.SetColumnProperty("Complete","DUE_DATE","AllowEdit",False)
	Gui.FormQC.GsGridControlCompleted.SetColumnProperty("Complete","DUE_DATE","Caption","Due Date")
	Gui.FormQC.GsGridControlCompleted.SetColumnProperty("Complete","DUE_DATE","HeaderBackColor","Green")
	Gui.FormQC.GsGridControlCompleted.SetColumnProperty("Complete","DUE_DATE","HeaderForeColor","White")
	Gui.FormQC.GsGridControlCompleted.SetColumnProperty("Complete","DUE_DATE","DisplayCustomDatetime","d")
	Gui.FormQC.GsGridControlCompleted.SetColumnProperty("Complete","DUE_DATE","Fixed","Left")
	Gui.FormQC.GsGridControlCompleted.SetColumnProperty("Complete","DUE_DATE","HeaderFontSize",10)
	Gui.FormQC.GsGridControlCompleted.SetColumnProperty("Complete","DUE_DATE","CellFontSize",10)
	
	Gui.FormQC.GsGridControlCompleted.SetColumnProperty("Complete","COMPLETED_DATE","ReadOnly",True)
	Gui.FormQC.GsGridControlCompleted.SetColumnProperty("Complete","COMPLETED_DATE","AllowEdit",False)
	Gui.FormQC.GsGridControlCompleted.SetColumnProperty("Complete","COMPLETED_DATE","Caption","Completed Date")
	Gui.FormQC.GsGridControlCompleted.SetColumnProperty("Complete","COMPLETED_DATE","HeaderBackColor","Green")
	Gui.FormQC.GsGridControlCompleted.SetColumnProperty("Complete","COMPLETED_DATE","HeaderForeColor","White")
	Gui.FormQC.GsGridControlCompleted.SetColumnProperty("Complete","COMPLETED_DATE","DisplayCustomDatetime","d")
	Gui.FormQC.GsGridControlCompleted.SetColumnProperty("Complete","COMPLETED_DATE","Fixed","Left")
	Gui.FormQC.GsGridControlCompleted.SetColumnProperty("Complete","COMPLETED_DATE","HeaderFontSize",10)
	Gui.FormQC.GsGridControlCompleted.SetColumnProperty("Complete","COMPLETED_DATE","CellFontSize",10)
	
	Gui.FormQC.GsGridControlCompleted.SetColumnProperty("Complete","ORIG_USER","ReadOnly",True)
	Gui.FormQC.GsGridControlCompleted.SetColumnProperty("Complete","ORIG_USER","AllowEdit",False)
	Gui.FormQC.GsGridControlCompleted.SetColumnProperty("Complete","ORIG_USER","Caption","Orig User")
	Gui.FormQC.GsGridControlCompleted.SetColumnProperty("Complete","ORIG_USER","HeaderBackColor","Green")
	Gui.FormQC.GsGridControlCompleted.SetColumnProperty("Complete","ORIG_USER","HeaderForeColor","White")
	Gui.FormQC.GsGridControlCompleted.SetColumnProperty("Complete","ORIG_USER","Fixed","Left")
	Gui.FormQC.GsGridControlCompleted.SetColumnProperty("Complete","ORIG_USER","HeaderFontSize",10)
	Gui.FormQC.GsGridControlCompleted.SetColumnProperty("Complete","ORIG_USER","CellFontSize",10)
	
	Gui.FormQC.GsGridControlCompleted.SetColumnProperty("Complete","PRIORITY","ReadOnly",True)
	Gui.FormQC.GsGridControlCompleted.SetColumnProperty("Complete","PRIORITY","AllowEdit",False)
	Gui.FormQC.GsGridControlCompleted.SetColumnProperty("Complete","PRIORITY","Caption","Priority")
	Gui.FormQC.GsGridControlCompleted.SetColumnProperty("Complete","PRIORITY","HeaderBackColor","Green")
	Gui.FormQC.GsGridControlCompleted.SetColumnProperty("Complete","PRIORITY","HeaderForeColor","White")
	Gui.FormQC.GsGridControlCompleted.SetColumnProperty("Complete","PRIORITY","Fixed","Left")
	Gui.FormQC.GsGridControlCompleted.SetColumnProperty("Complete","PRIORITY","HeaderFontSize",10)
	Gui.FormQC.GsGridControlCompleted.SetColumnProperty("Complete","PRIORITY","CellFontSize",10)
	
	Gui.FormQC.GsGridControlCompleted.SetColumnProperty("Complete","PROJECT_TYPE","ReadOnly",True)
	Gui.FormQC.GsGridControlCompleted.SetColumnProperty("Complete","PROJECT_TYPE","AllowEdit",False)
	Gui.FormQC.GsGridControlCompleted.SetColumnProperty("Complete","PROJECT_TYPE","Caption","PType")
	Gui.FormQC.GsGridControlCompleted.SetColumnProperty("Complete","PROJECT_TYPE","HeaderBackColor","Green")
	Gui.FormQC.GsGridControlCompleted.SetColumnProperty("Complete","PROJECT_TYPE","HeaderForeColor","White")
	Gui.FormQC.GsGridControlCompleted.SetColumnProperty("Complete","PROJECT_TYPE","HeaderFontSize",10)
	Gui.FormQC.GsGridControlCompleted.SetColumnProperty("Complete","PROJECT_TYPE","CellFontSize",10)
	
	Gui.FormQC.GsGridControlCompleted.SetColumnProperty("Complete","Source","ReadOnly",True)
	Gui.FormQC.GsGridControlCompleted.SetColumnProperty("Complete","Source","AllowEdit",False)
	Gui.FormQC.GsGridControlCompleted.SetColumnProperty("Complete","Source","Caption","Source")
	Gui.FormQC.GsGridControlCompleted.SetColumnProperty("Complete","Source","HeaderBackColor","Green")
	Gui.FormQC.GsGridControlCompleted.SetColumnProperty("Complete","Source","HeaderForeColor","White")
	Gui.FormQC.GsGridControlCompleted.SetColumnProperty("Complete","Source","HeaderFontSize",10)
	Gui.FormQC.GsGridControlCompleted.SetColumnProperty("Complete","Source","CellFontSize",10)
	
	Gui.FormQC.GsGridControlCompleted.SetColumnProperty("Complete","ECC","ReadOnly",True)
	Gui.FormQC.GsGridControlCompleted.SetColumnProperty("Complete","ECC","AllowEdit",False)
	Gui.FormQC.GsGridControlCompleted.SetColumnProperty("Complete","ECC","Caption","ECC #")
	Gui.FormQC.GsGridControlCompleted.SetColumnProperty("Complete","ECC","HeaderBackColor","Green")
	Gui.FormQC.GsGridControlCompleted.SetColumnProperty("Complete","ECC","HeaderForeColor","White")
	Gui.FormQC.GsGridControlCompleted.SetColumnProperty("Complete","ECC","HeaderFontSize",10)
	Gui.FormQC.GsGridControlCompleted.SetColumnProperty("Complete","ECC","CellFontSize",10)
	
	Gui.FormQC.GsGridControlCompleted.SetColumnProperty("Complete","PART","ReadOnly",True)
	Gui.FormQC.GsGridControlCompleted.SetColumnProperty("Complete","PART","AllowEdit",False)
	Gui.FormQC.GsGridControlCompleted.SetColumnProperty("Complete","PART","Caption","Part #")
	Gui.FormQC.GsGridControlCompleted.SetColumnProperty("Complete","PART","HeaderBackColor","Green")
	Gui.FormQC.GsGridControlCompleted.SetColumnProperty("Complete","PART","HeaderForeColor","White")
	Gui.FormQC.GsGridControlCompleted.SetColumnProperty("Complete","PART","HeaderFontSize",10)
	Gui.FormQC.GsGridControlCompleted.SetColumnProperty("Complete","PART","CellFontSize",10)
	
	Gui.FormQC.GsGridControlCompleted.SetColumnProperty("Complete","WO","ReadOnly",True)
	Gui.FormQC.GsGridControlCompleted.SetColumnProperty("Complete","WO","AllowEdit",False)
	Gui.FormQC.GsGridControlCompleted.SetColumnProperty("Complete","WO","HeaderBackColor","Green")
	Gui.FormQC.GsGridControlCompleted.SetColumnProperty("Complete","WO","HeaderForeColor","White")
	Gui.FormQC.GsGridControlCompleted.SetColumnProperty("Complete","WO","HeaderFontSize",10)
	Gui.FormQC.GsGridControlCompleted.SetColumnProperty("Complete","WO","CellFontSize",10)
	
	Gui.FormQC.GsGridControlCompleted.SetColumnProperty("Complete","SO","ReadOnly",True)
	Gui.FormQC.GsGridControlCompleted.SetColumnProperty("Complete","SO","AllowEdit",False)
	Gui.FormQC.GsGridControlCompleted.SetColumnProperty("Complete","SO","HeaderBackColor","Green")
	Gui.FormQC.GsGridControlCompleted.SetColumnProperty("Complete","SO","HeaderForeColor","White")
	Gui.FormQC.GsGridControlCompleted.SetColumnProperty("Complete","SO","HeaderFontSize",10)
	Gui.FormQC.GsGridControlCompleted.SetColumnProperty("Complete","SO","CellFontSize",10)
	
	Gui.FormQC.GsGridControlCompleted.SetColumnProperty("Complete","ISSUE","ReadOnly",True)
	Gui.FormQC.GsGridControlCompleted.SetColumnProperty("Complete","ISSUE","AllowEdit",False)
	Gui.FormQC.GsGridControlCompleted.SetColumnProperty("Complete","ISSUE","Caption","Issue")
	Gui.FormQC.GsGridControlCompleted.SetColumnProperty("Complete","ISSUE","HeaderBackColor","Green")
	Gui.FormQC.GsGridControlCompleted.SetColumnProperty("Complete","ISSUE","HeaderForeColor","White")
	Gui.FormQC.GsGridControlCompleted.SetColumnProperty("Complete","ISSUE","HeaderFontSize",10)
	Gui.FormQC.GsGridControlCompleted.SetColumnProperty("Complete","ISSUE","CellFontSize",10)
	
	Gui.FormQC.GsGridControlCompleted.SetColumnProperty("Complete","DESCRIPTION","ReadOnly",True)
	Gui.FormQC.GsGridControlCompleted.SetColumnProperty("Complete","DESCRIPTION","AllowEdit",False)
	Gui.FormQC.GsGridControlCompleted.SetColumnProperty("Complete","DESCRIPTION","Caption","Description")
	Gui.FormQC.GsGridControlCompleted.SetColumnProperty("Complete","DESCRIPTION","HeaderBackColor","Green")
	Gui.FormQC.GsGridControlCompleted.SetColumnProperty("Complete","DESCRIPTION","HeaderForeColor","White")
	Gui.FormQC.GsGridControlCompleted.SetColumnProperty("Complete","DESCRIPTION","HeaderFontSize",10)
	Gui.FormQC.GsGridControlCompleted.SetColumnProperty("Complete","DESCRIPTION","CellFontSize",10)
	
	Gui.FormQC.GsGridControlCompleted.SetColumnProperty("Complete","ROOT_CAUSE","ReadOnly",True)
	Gui.FormQC.GsGridControlCompleted.SetColumnProperty("Complete","ROOT_CAUSE","AllowEdit",False)
	Gui.FormQC.GsGridControlCompleted.SetColumnProperty("Complete","ROOT_CAUSE","Caption","Root Cause")
	Gui.FormQC.GsGridControlCompleted.SetColumnProperty("Complete","ROOT_CAUSE","HeaderBackColor","Green")
	Gui.FormQC.GsGridControlCompleted.SetColumnProperty("Complete","ROOT_CAUSE","HeaderForeColor","White")
	Gui.FormQC.GsGridControlCompleted.SetColumnProperty("Complete","ROOT_CAUSE","HeaderFontSize",10)
	Gui.FormQC.GsGridControlCompleted.SetColumnProperty("Complete","ROOT_CAUSE","CellFontSize",10)
	
	Gui.FormQC.GsGridControlCompleted.SetColumnProperty("Complete","ACTION_PLAN","ReadOnly",True)
	Gui.FormQC.GsGridControlCompleted.SetColumnProperty("Complete","ACTION_PLAN","AllowEdit",False)
	Gui.FormQC.GsGridControlCompleted.SetColumnProperty("Complete","ACTION_PLAN","Caption","Action_Plan")
	Gui.FormQC.GsGridControlCompleted.SetColumnProperty("Complete","ACTION_PLAN","HeaderBackColor","Green")
	Gui.FormQC.GsGridControlCompleted.SetColumnProperty("Complete","ACTION_PLAN","HeaderForeColor","White")
	Gui.FormQC.GsGridControlCompleted.SetColumnProperty("Complete","ACTION_PLAN","HeaderFontSize",10)
	Gui.FormQC.GsGridControlCompleted.SetColumnProperty("Complete","ACTION_PLAN","CellFontSize",10)
	
	Gui.FormQC.GsGridControlCompleted.SetColumnProperty("Complete","STATUS","ReadOnly",True)
	Gui.FormQC.GsGridControlCompleted.SetColumnProperty("Complete","STATUS","AllowEdit",False)
	Gui.FormQC.GsGridControlCompleted.SetColumnProperty("Complete","STATUS","Caption","Status")
	Gui.FormQC.GsGridControlCompleted.SetColumnProperty("Complete","STATUS","Visible",False)
	Gui.FormQC.GsGridControlCompleted.SetColumnProperty("Complete","STATUS","HeaderBackColor","Green")
	Gui.FormQC.GsGridControlCompleted.SetColumnProperty("Complete","STATUS","HeaderForeColor","White")
	Gui.FormQC.GsGridControlCompleted.SetColumnProperty("Complete","STATUS","HeaderFontSize",10)
	Gui.FormQC.GsGridControlCompleted.SetColumnProperty("Complete","STATUS","CellFontSize",10)
	
	Gui.FormQC.GsGridControlCompleted.SetColumnProperty("Complete","ASSIGNED_Dept","ReadOnly",True)
	Gui.FormQC.GsGridControlCompleted.SetColumnProperty("Complete","ASSIGNED_Dept","AllowEdit",False)
	Gui.FormQC.GsGridControlCompleted.SetColumnProperty("Complete","ASSIGNED_Dept","Caption","Assigned Dept")
	Gui.FormQC.GsGridControlCompleted.SetColumnProperty("Complete","ASSIGNED_Dept","Visible",False)
	Gui.FormQC.GsGridControlCompleted.SetColumnProperty("Complete","ASSIGNED_Dept","HeaderBackColor","Green")
	Gui.FormQC.GsGridControlCompleted.SetColumnProperty("Complete","ASSIGNED_Dept","HeaderForeColor","White")
	Gui.FormQC.GsGridControlCompleted.SetColumnProperty("Complete","ASSIGNED_Dept","HeaderFontSize",10)
	Gui.FormQC.GsGridControlCompleted.SetColumnProperty("Complete","ASSIGNED_Dept","CellFontSize",10)
	
	Gui.FormQC.GsGridControlCompleted.SetColumnProperty("Complete","ASSIGNED_TO","ReadOnly",True)
	Gui.FormQC.GsGridControlCompleted.SetColumnProperty("Complete","ASSIGNED_TO","AllowEdit",False)
	Gui.FormQC.GsGridControlCompleted.SetColumnProperty("Complete","ASSIGNED_TO","Caption","Assigned To")
	Gui.FormQC.GsGridControlCompleted.SetColumnProperty("Complete","ASSIGNED_TO","Visible",False)
	Gui.FormQC.GsGridControlCompleted.SetColumnProperty("Complete","ASSIGNED_TO","HeaderBackColor","Green")
	Gui.FormQC.GsGridControlCompleted.SetColumnProperty("Complete","ASSIGNED_TO","HeaderForeColor","White")
	Gui.FormQC.GsGridControlCompleted.SetColumnProperty("Complete","ASSIGNED_TO","HeaderFontSize",10)
	Gui.FormQC.GsGridControlCompleted.SetColumnProperty("Complete","ASSIGNED_TO","CellFontSize",10)
	
	Gui.FormQC.GsGridControlCompleted.SetColumnProperty("Complete","EST_COST_INC","ReadOnly",True)
	Gui.FormQC.GsGridControlCompleted.SetColumnProperty("Complete","EST_COST_INC","AllowEdit",False)
	Gui.FormQC.GsGridControlCompleted.SetColumnProperty("Complete","EST_COST_INC","Caption","Est Cost")
	Gui.FormQC.GsGridControlCompleted.SetColumnProperty("Complete","EST_COST_INC","Visible",False)
	Gui.FormQC.GsGridControlCompleted.SetColumnProperty("Complete","EST_COST_INC","HeaderBackColor","Green")
	Gui.FormQC.GsGridControlCompleted.SetColumnProperty("Complete","EST_COST_INC","HeaderForeColor","White")
	Gui.FormQC.GsGridControlCompleted.SetColumnProperty("Complete","EST_COST_INC","HeaderFontSize",10)
	Gui.FormQC.GsGridControlCompleted.SetColumnProperty("Complete","EST_COST_INC","CellFontSize",10)
	
	Gui.FormQC.GsGridControlCompleted.SetColumnProperty("Complete","WorkGroup","ReadOnly",True)
	Gui.FormQC.GsGridControlCompleted.SetColumnProperty("Complete","WorkGroup","AllowEdit",False)
	Gui.FormQC.GsGridControlCompleted.SetColumnProperty("Complete","WorkGroup","Caption","WG")
	Gui.FormQC.GsGridControlCompleted.SetColumnProperty("Complete","WorkGroup","Visible",False)
	Gui.FormQC.GsGridControlCompleted.SetColumnProperty("Complete","WorkGroup","HeaderBackColor","Green")
	Gui.FormQC.GsGridControlCompleted.SetColumnProperty("Complete","WorkGroup","HeaderForeColor","White")
	Gui.FormQC.GsGridControlCompleted.SetColumnProperty("Complete","WorkGroup","HeaderFontSize",10)
	Gui.FormQC.GsGridControlCompleted.SetColumnProperty("Complete","WorkGroup","CellFontSize",10)
	
	Gui.FormQC.GsGridControlCompleted.SetColumnProperty("Complete","QA_SIGNOFF","ReadOnly",True)
	Gui.FormQC.GsGridControlCompleted.SetColumnProperty("Complete","QA_SIGNOFF","AllowEdit",False)
	Gui.FormQC.GsGridControlCompleted.SetColumnProperty("Complete","QA_SIGNOFF","Caption","QA Signoff")
	Gui.FormQC.GsGridControlCompleted.SetColumnProperty("Complete","QA_SIGNOFF","HeaderBackColor","Green")
	Gui.FormQC.GsGridControlCompleted.SetColumnProperty("Complete","QA_SIGNOFF","HeaderForeColor","White")
	Gui.FormQC.GsGridControlCompleted.SetColumnProperty("Complete","QA_SIGNOFF","HeaderFontSize",10)
	Gui.FormQC.GsGridControlCompleted.SetColumnProperty("Complete","QA_SIGNOFF","CellFontSize",10)
	
	Gui.FormQC.GsGridControlCompleted.SetColumnProperty("Complete","QA_USER","ReadOnly",True)
	Gui.FormQC.GsGridControlCompleted.SetColumnProperty("Complete","QA_USER","AllowEdit",False)
	Gui.FormQC.GsGridControlCompleted.SetColumnProperty("Complete","QA_USER","Caption","QA User")
	Gui.FormQC.GsGridControlCompleted.SetColumnProperty("Complete","QA_USER","HeaderBackColor","Green")
	Gui.FormQC.GsGridControlCompleted.SetColumnProperty("Complete","QA_USER","HeaderForeColor","White")
	Gui.FormQC.GsGridControlCompleted.SetColumnProperty("Complete","QA_USER","HeaderFontSize",10)
	Gui.FormQC.GsGridControlCompleted.SetColumnProperty("Complete","QA_USER","CellFontSize",10)
	
	Gui.FormQC.GsGridControlCompleted.SetColumnProperty("Complete","ADD_Group_1","ReadOnly",True)
	Gui.FormQC.GsGridControlCompleted.SetColumnProperty("Complete","ADD_Group_1","AllowEdit",False)
	Gui.FormQC.GsGridControlCompleted.SetColumnProperty("Complete","ADD_Group_1","Caption","Additional Group 1")
	Gui.FormQC.GsGridControlCompleted.SetColumnProperty("Complete","ADD_Group_1","HeaderBackColor","Green")
	Gui.FormQC.GsGridControlCompleted.SetColumnProperty("Complete","ADD_Group_1","HeaderForeColor","White")
	Gui.FormQC.GsGridControlCompleted.SetColumnProperty("Complete","ADD_Group_1","HeaderFontSize",10)
	Gui.FormQC.GsGridControlCompleted.SetColumnProperty("Complete","ADD_Group_1","CellFontSize",10)
	
	Gui.FormQC.GsGridControlCompleted.SetColumnProperty("Complete","Group_1_SIGNOFF","ReadOnly",True)
	Gui.FormQC.GsGridControlCompleted.SetColumnProperty("Complete","Group_1_SIGNOFF","AllowEdit",False)
	Gui.FormQC.GsGridControlCompleted.SetColumnProperty("Complete","Group_1_SIGNOFF","Caption","Group 1 Signoff")
	Gui.FormQC.GsGridControlCompleted.SetColumnProperty("Complete","Group_1_SIGNOFF","HeaderBackColor","Green")
	Gui.FormQC.GsGridControlCompleted.SetColumnProperty("Complete","Group_1_SIGNOFF","HeaderForeColor","White")
	Gui.FormQC.GsGridControlCompleted.SetColumnProperty("Complete","Group_1_SIGNOFF","HeaderFontSize",10)
	Gui.FormQC.GsGridControlCompleted.SetColumnProperty("Complete","Group_1_SIGNOFF","CellFontSize",10)
	
	Gui.FormQC.GsGridControlCompleted.SetColumnProperty("Complete","Group_1_USER","ReadOnly",True)
	Gui.FormQC.GsGridControlCompleted.SetColumnProperty("Complete","Group_1_USER","AllowEdit",False)
	Gui.FormQC.GsGridControlCompleted.SetColumnProperty("Complete","Group_1_USER","Caption","Group 1 User")
	Gui.FormQC.GsGridControlCompleted.SetColumnProperty("Complete","Group_1_USER","HeaderBackColor","Green")
	Gui.FormQC.GsGridControlCompleted.SetColumnProperty("Complete","Group_1_USER","HeaderForeColor","White")
	Gui.FormQC.GsGridControlCompleted.SetColumnProperty("Complete","Group_1_USER","HeaderFontSize",10)
	Gui.FormQC.GsGridControlCompleted.SetColumnProperty("Complete","Group_1_USER","CellFontSize",10)
	
	Gui.FormQC.GsGridControlCompleted.SetColumnProperty("Complete","ADD_Group_2","ReadOnly",True)
	Gui.FormQC.GsGridControlCompleted.SetColumnProperty("Complete","ADD_Group_2","AllowEdit",False)
	Gui.FormQC.GsGridControlCompleted.SetColumnProperty("Complete","ADD_Group_2","Caption","Additional Group 2")
	Gui.FormQC.GsGridControlCompleted.SetColumnProperty("Complete","ADD_Group_2","HeaderBackColor","Green")
	Gui.FormQC.GsGridControlCompleted.SetColumnProperty("Complete","ADD_Group_2","HeaderForeColor","White")
	Gui.FormQC.GsGridControlCompleted.SetColumnProperty("Complete","ADD_Group_2","HeaderFontSize",10)
	Gui.FormQC.GsGridControlCompleted.SetColumnProperty("Complete","ADD_Group_2","CellFontSize",10)
	
	Gui.FormQC.GsGridControlCompleted.SetColumnProperty("Complete","Group_2_SIGNOFF","ReadOnly",True)
	Gui.FormQC.GsGridControlCompleted.SetColumnProperty("Complete","Group_2_SIGNOFF","AllowEdit",False)
	Gui.FormQC.GsGridControlCompleted.SetColumnProperty("Complete","Group_2_SIGNOFF","Caption","Group 2 Signoff")
	Gui.FormQC.GsGridControlCompleted.SetColumnProperty("Complete","Group_2_SIGNOFF","HeaderBackColor","Green")
	Gui.FormQC.GsGridControlCompleted.SetColumnProperty("Complete","Group_2_SIGNOFF","HeaderForeColor","White")
	Gui.FormQC.GsGridControlCompleted.SetColumnProperty("Complete","Group_2_SIGNOFF","HeaderFontSize",10)
	Gui.FormQC.GsGridControlCompleted.SetColumnProperty("Complete","Group_2_SIGNOFF","CellFontSize",10)
	
	Gui.FormQC.GsGridControlCompleted.SetColumnProperty("Complete","Group_2_USER","ReadOnly",True)
	Gui.FormQC.GsGridControlCompleted.SetColumnProperty("Complete","Group_2_USER","AllowEdit",False)
	Gui.FormQC.GsGridControlCompleted.SetColumnProperty("Complete","Group_2_USER","Caption","Group 2 User")
	Gui.FormQC.GsGridControlCompleted.SetColumnProperty("Complete","Group_2_USER","HeaderBackColor","Green")
	Gui.FormQC.GsGridControlCompleted.SetColumnProperty("Complete","Group_2_USER","HeaderForeColor","White")
	Gui.FormQC.GsGridControlCompleted.SetColumnProperty("Complete","Group_2_USER","HeaderFontSize",10)
	Gui.FormQC.GsGridControlCompleted.SetColumnProperty("Complete","Group_2_USER","CellFontSize",10)
	
	Gui.FormQC.GsGridControlCompleted.SetColumnProperty("Complete","ORIG_DRAWNBY","ReadOnly",True)
	Gui.FormQC.GsGridControlCompleted.SetColumnProperty("Complete","ORIG_DRAWNBY","AllowEdit",False)
	Gui.FormQC.GsGridControlCompleted.SetColumnProperty("Complete","ORIG_DRAWNBY","Caption","Orig. Drawn By")
	Gui.FormQC.GsGridControlCompleted.SetColumnProperty("Complete","ORIG_DRAWNBY","HeaderBackColor","Green")
	Gui.FormQC.GsGridControlCompleted.SetColumnProperty("Complete","ORIG_DRAWNBY","HeaderForeColor","White")
	Gui.FormQC.GsGridControlCompleted.SetColumnProperty("Complete","ORIG_DRAWNBY","HeaderFontSize",10)
	Gui.FormQC.GsGridControlCompleted.SetColumnProperty("Complete","ORIG_DRAWNBY","CellFontSize",10)
	
	Gui.FormQC.GsGridControlCompleted.SetColumnProperty("Complete","ORIG_CHECKBY","ReadOnly",True)
	Gui.FormQC.GsGridControlCompleted.SetColumnProperty("Complete","ORIG_CHECKBY","AllowEdit",False)
	Gui.FormQC.GsGridControlCompleted.SetColumnProperty("Complete","ORIG_CHECKBY","Caption","Orig. Checked By")
	Gui.FormQC.GsGridControlCompleted.SetColumnProperty("Complete","ORIG_CHECKBY","HeaderBackColor","Green")
	Gui.FormQC.GsGridControlCompleted.SetColumnProperty("Complete","ORIG_CHECKBY","HeaderForeColor","White")
	Gui.FormQC.GsGridControlCompleted.SetColumnProperty("Complete","ORIG_CHECKBY","HeaderFontSize",10)
	Gui.FormQC.GsGridControlCompleted.SetColumnProperty("Complete","ORIG_CHECKBY","CellFontSize",10)
	
	Gui.FormQC.GsGridControlCompleted.SetColumnProperty("Complete","ORIG_MODELBY","ReadOnly",True)
	Gui.FormQC.GsGridControlCompleted.SetColumnProperty("Complete","ORIG_MODELBY","AllowEdit",False)
	Gui.FormQC.GsGridControlCompleted.SetColumnProperty("Complete","ORIG_MODELBY","Caption","Orig. Model By")
	Gui.FormQC.GsGridControlCompleted.SetColumnProperty("Complete","ORIG_MODELBY","HeaderBackColor","Green")
	Gui.FormQC.GsGridControlCompleted.SetColumnProperty("Complete","ORIG_MODELBY","HeaderForeColor","White")
	Gui.FormQC.GsGridControlCompleted.SetColumnProperty("Complete","ORIG_MODELBY","HeaderFontSize",10)
	Gui.FormQC.GsGridControlCompleted.SetColumnProperty("Complete","ORIG_MODELBY","CellFontSize",10)
	
	Gui.FormQC.GsGridControlCompleted.AddStyleFormatCondition("Complete","CCA_No","ParentCCA","Greater","0")
	Gui.FormQC.GsGridControlCompleted.SetStyleFormatConditionProperty("Complete","CCA_No","ParentCCA","BackColor","#EDFD73")
	
	Gui.FormQC.GsGridControlCompleted.AddStyleFormatCondition("Complete","ECR","ParentECR","Expression","[CCA_NO] < 1")
	Gui.FormQC.GsGridControlCompleted.SetStyleFormatConditionProperty("Complete","ECR","ParentECR","BackColor","#EDFD73")
	
	F.Intrinsic.String.Build("{0}\Custom\5398\{1}{2}_5398_Complete.txt",V.Caller.GlobalDir,V.Caller.User.Trim,V.Caller.CompanyCode,V.Local.sFile)
	
	F.Intrinsic.File.Exists(V.Local.sFile,V.Local.bRet)
	F.Intrinsic.Control.If(V.Local.bRet)
		F.Intrinsic.File.File2String(V.Local.sFile,V.Local.sReturn)
		Gui.FormQC.GsGridControlCompleted.Deserialize(V.Local.sReturn)
	F.Intrinsic.Control.EndIf
	
	Gui.FormQC.GsGridControlCompleted.MainView("Complete")
	
	F.Intrinsic.Control.ExitSub

F.Intrinsic.Control.Catch
	F.Intrinsic.Control.If(V.Ambient.ErrorNumber,<>,0)
		F.Intrinsic.String.Build("Project: {0}{1}Subroutine: {2}{1}Error Occurred {3} with description {4}","GCG_5398_CAR_ECN.g2u",V.Ambient.NewLine,V.Ambient.CurrentSubroutine,V.Ambient.ErrorNumber,V.Ambient.ErrorDescription,V.Local.sError)
		F.Intrinsic.UI.Msgbox(V.Local.sError)
		F.Intrinsic.Control.CallSub(FormQC_UnLoad)
	F.Intrinsic.Control.EndIf
Function.Intrinsic.Control.EndTry
Program.Sub.Set_Complete_Properties.End

Program.Sub.cmdRefresh_Click.Start
F.Intrinsic.Control.Try
	V.Local.sError.Declare(String,"")
	V.Local.sSql.Declare(String,"")
	V.Local.iRet.Declare(Long,0)
	
	F.Intrinsic.Control.BlockEvents
	
	Gui.FormQC..Enabled(False)

	F.ODBC.Connection!Con.OpenCompanyConnection
	
	V.Local.sSql.Set("Select '' as Doc_Link, CCA_NO, DATE_ENTERED, DUE_DATE, ORIG_USER, PRIORITY, rtrim(PROJECT_TYPE) as PROJECT_TYPE, rtrim(PART) as PART, rtrim(WO) as WO, rtrim(SO) as SO, ISSUE, rtrim(DESCRIPTION) as DESCRIPTION, rtrim(Root_Cause) as Root_Cause, rtrim(Action_Plan) as Action_Plan, STATUS, rtrim(ASSIGNED_Dept) as ASSIGNED_Dept, rtrim(ASSIGNED_TO) as ASSIGNED_TO, ECR_REQUIRED, ECR, rtrim(Source) as Source, EST_COST_INC,  rtrim(WorkGroup) as WorkGroup FROM GCG_5398_CAR Where Status <> 'Complete - Awaiting Signoff' ORDER BY CCA_NO")
	F.Data.DataTable.CreateFromSQL("Temp","con",V.Local.sSql,True)
	
	F.Data.DataTable.DeleteRow("CAR")
	F.Data.DataTable.AcceptChanges("CAR")
	
	F.Data.DataTable.Merge("Temp","CAR",True,2)
	
	F.Data.DataTable.SetValue("CAR",-1,"Edit","Edit")
	
	F.Data.DataTable.Close("Temp")
	
	V.Local.sSql.Set("Select '' as Doc_Link, ECR, DATE_ENTERED, DUE_DATE, ORIG_USER, PRIORITY, rtrim(PROJECT_TYPE) as PROJECT_TYPE, rtrim(ECC) as ECC, rtrim(PART) as PART, rtrim(WO) as WO, rtrim(SO) as SO, ISSUE, rtrim(DESCRIPTION) as DESCRIPTION, rtrim(Root_Cause) as Root_Cause, rtrim(Action_Plan) as Action_Plan, STATUS, rtrim(ASSIGNED_Dept) as ASSIGNED_Dept, rtrim(ASSIGNED_TO) as ASSIGNED_TO, rtrim(Source) as Source, EST_COST_INC, rtrim(WorkGroup) as WorkGroup, ORIG_DRAWNBY, ORIG_MODELBY, ORIG_CHECKBY FROM GCG_5398_ECR Where Status <> 'Complete - Awaiting Signoff' ORDER By ECR")
	F.Data.DataTable.CreateFromSQL("Temp","con",V.Local.sSql,True)
	
	F.Data.DataTable.DeleteRow("ECR")
	F.Data.DataTable.AcceptChanges("ECR")
	
	F.Data.DataTable.Merge("Temp","ECR",True,2)
	
	F.Data.DataTable.SetValue("ECR",-1,"Edit","Edit")
	
	F.Data.DataTable.Close("Temp")
	
	V.Local.sSql.Set("Select '' as Doc_Link, CCA_NO, ECR, DATE_ENTERED, DUE_DATE, ORIG_USER, PRIORITY, rtrim(PROJECT_TYPE) as PROJECT_TYPE, rtrim(PART) as PART, rtrim(WO) as WO, rtrim(SO) as SO, ISSUE, rtrim(DESCRIPTION) as DESCRIPTION, rtrim(Root_Cause) as Root_Cause, rtrim(Action_Plan) as Action_Plan, STATUS, rtrim(ASSIGNED_Dept) as ASSIGNED_Dept, rtrim(ASSIGNED_TO) as ASSIGNED_TO, rtrim(Source) as Source, EST_COST_INC, rtrim(WorkGroup) as WorkGroup, QA_SIGNOFF, QA_USER, ADD_Group_1, Group_1_SIGNOFF, Group_1_USER, ADD_Group_2, Group_2_SIGNOFF, Group_2_USER, '' as ORIG_DRAWNBY, '' as ORIG_MODELBY, '' as ORIG_CHECKBY FROM GCG_5398_CAR Where Status = 'Complete - Awaiting Signoff' and QA_SIGNOFF <> 1 ORDER BY CCA_NO")
	F.Data.DataTable.CreateFromSQL("TempSignoff","con",V.Local.sSql,True)
	
	V.Local.sSql.Set("Select ECR, DATE_ENTERED, DUE_DATE, COMPLETED_DATE, ORIG_USER, PRIORITY, rtrim(PROJECT_TYPE) as PROJECT_TYPE, rtrim(PART) as PART, rtrim(WO) as WO, rtrim(SO) as SO, ISSUE, rtrim(DESCRIPTION) as DESCRIPTION, rtrim(Root_Cause) as Root_Cause, rtrim(Action_Plan) as Action_Plan, STATUS, rtrim(ASSIGNED_Dept) as ASSIGNED_Dept, rtrim(ASSIGNED_TO) as ASSIGNED_TO, rtrim(Source) as Source, EST_COST_INC, rtrim(WorkGroup) as WorkGroup, QA_SIGNOFF, QA_USER, ADD_Group_1, Group_1_SIGNOFF, Group_1_USER, ADD_Group_2, Group_2_SIGNOFF, Group_2_USER FROM GCG_5398_ECR Where Status = 'Complete - Awaiting Signoff' and QA_SIGNOFF <> 1 ORDER BY ECR")
	F.Data.DataTable.CreateFromSQL("Temp","con",V.Local.sSql,True)
	F.Data.DataTable.Merge("Temp","TempSignoff",True,2)
	F.Data.DataTable.Close("Temp")
	
	F.Data.DataTable.DeleteRow("Signoff")
	F.Data.DataTable.AcceptChanges("Signoff")
	
	F.Data.DataTable.Merge("TempSignoff","Signoff",True,2)
	F.Data.DataTable.Close("TempSignoff")
	
	F.Data.DataTable.SetValue("Signoff",-1,"Edit","Edit")
	
	V.Local.sSql.Set("Select '' as Doc_Link, CCA_NO, ECR, DATE_ENTERED, DUE_DATE, COMPLETED_DATE, ORIG_USER, PRIORITY, rtrim(PROJECT_TYPE) as PROJECT_TYPE, rtrim(PART) as PART, rtrim(WO) as WO, rtrim(SO) as SO, ISSUE, rtrim(DESCRIPTION) as DESCRIPTION, rtrim(Root_Cause) as Root_Cause, rtrim(Action_Plan) as Action_Plan, STATUS, rtrim(ASSIGNED_Dept) as ASSIGNED_Dept, rtrim(ASSIGNED_TO) as ASSIGNED_TO, rtrim(Source) as Source, EST_COST_INC, rtrim(WorkGroup) as WorkGroup, QA_SIGNOFF, QA_USER, ADD_Group_1, Group_1_SIGNOFF, Group_1_USER, ADD_Group_2, Group_2_SIGNOFF, Group_2_USER, '' as ORIG_DRAWNBY, '' as ORIG_MODELBY, '' as ORIG_CHECKBY FROM GCG_5398_CAR Where Status = 'Complete - Awaiting Signoff' and QA_SIGNOFF = 1 ORDER BY CCA_NO")
	F.Data.DataTable.CreateFromSQL("TempComplete","con",V.Local.sSql,True)
	
	F.Data.DataTable.DeleteRow("Complete")
	F.Data.DataTable.AcceptChanges("Complete")
	
	V.Local.sSql.Set("Select ECR, DATE_ENTERED, DUE_DATE, COMPLETED_DATE, ORIG_USER, PRIORITY, rtrim(PROJECT_TYPE) as PROJECT_TYPE, rtrim(ECC) as ECC, rtrim(PART) as PART, rtrim(WO) as WO, rtrim(SO) as SO, ISSUE, rtrim(DESCRIPTION) as DESCRIPTION, rtrim(Root_Cause) as Root_Cause, rtrim(Action_Plan) as Action_Plan, STATUS, rtrim(ASSIGNED_Dept) as ASSIGNED_Dept, rtrim(ASSIGNED_TO) as ASSIGNED_TO, rtrim(Source) as Source, EST_COST_INC, rtrim(WorkGroup) as WorkGroup, QA_SIGNOFF, QA_USER, ADD_Group_1, Group_1_SIGNOFF, Group_1_USER, ADD_Group_2, Group_2_SIGNOFF, Group_2_USER, ORIG_DRAWNBY, ORIG_MODELBY, ORIG_CHECKBY FROM GCG_5398_ECR Where Status = 'Complete - Awaiting Signoff' and QA_SIGNOFF = 1 ORDER BY ECR")
	F.Data.DataTable.CreateFromSQL("Temp","con",V.Local.sSql,True)
	F.Data.DataTable.Merge("Temp","TempComplete",True,2)
	F.Data.DataTable.Close("Temp")
	
	F.Data.DataTable.Merge("TempComplete","Complete",True,2)
	F.Data.DataTable.Close("TempComplete")
	F.ODBC.Connection!Con.Close
	
	Gui.FormQC.GsGridControlCAR.ResumeLayout()
	Gui.FormQC.GsGridControlCompleted.ResumeLayout()
	Gui.FormQC.GsGridControlECR.ResumeLayout()
	Gui.FormQC.GsGridControlSignOff.ResumeLayout()
	
	Gui.FormQC..Enabled(True)
	
	F.Intrinsic.Control.UnBlockEvents
	
	F.Intrinsic.Control.ExitSub

F.Intrinsic.Control.Catch
	F.Intrinsic.Control.If(V.Ambient.ErrorNumber,<>,0)
		F.Intrinsic.String.Build("Project: {0}{1}Subroutine: {2}{1}Error Occurred {3} with description {4}","GCG_5398_CAR_ECN.g2u",V.Ambient.NewLine,V.Ambient.CurrentSubroutine,V.Ambient.ErrorNumber,V.Ambient.ErrorDescription,V.Local.sError)
		F.Intrinsic.UI.Msgbox(V.Local.sError)
		F.Intrinsic.Control.CallSub(FormQC_UnLoad)
	F.Intrinsic.Control.EndIf
Function.Intrinsic.Control.EndTry
Program.Sub.cmdRefresh_Click.End

Program.Sub.GsGridControlCompleted_RowcellClick.Start
F.Intrinsic.Control.Try
	V.Local.sError.Declare(String,"")
	V.Local.sRet.Declare(String,"")
	V.Local.i.Declare(Long,0)
	V.Local.sATGDoc.Declare(String,"")
	V.Local.sFilter.Declare(String,"")
	V.Local.iIdentity.Declare(Long,0)
	
	F.Intrinsic.Control.SelectCase(V.Args.Column.UCase)
		F.Intrinsic.Control.Case("DOC_LINK")
			F.Intrinsic.Control.If(V.DataTable.Complete(V.Args.RowIndex).CCA_NO!FieldVal,<>,"")
				Function.Global.General.ResetPassedDataElements
				F.Global.General.SetPassedDataElement("DATA-LINK-TYPE",2010)
				F.Intrinsic.String.Build("{0}-ECR",V.DataTable.Complete(V.Args.RowIndex).CCA_NO!FieldValLong,V.Local.sRet)
				F.Global.General.SetPassedDataElement("DATA-LINK-KEY",V.Local.sRet)
				F.Global.General.SetPassedDataElement("DATA-LINK-DESC","Engineering Change Request")
				F.Global.DocumentControl.GetLinkID(V.Local.sRet,2010,V.Local.i)
				F.Intrinsic.Control.If(V.Local.i,=,-1)
					F.Global.DocumentControl.CreateReference(V.Local.sRet,2010,V.Local.i)
				F.Intrinsic.Control.EndIf
				F.Intrinsic.String.Build("{0}\ATG_DocumentControl.gas",V.Caller.GasDir,V.Local.sATGDoc)
				F.Global.General.CallAsyncGAS(V.Local.sATGDoc,V.Local.i)
			F.Intrinsic.Control.Else
				Function.Global.General.ResetPassedDataElements
				F.Global.General.SetPassedDataElement("DATA-LINK-TYPE",2010)
				F.Intrinsic.String.Build("Select CCA_NO From GCG_5398_CAR Where ECR = {0}",V.DataTable.Complete(V.Args.RowIndex).ECR!FieldValLong,V.Local.sFilter)
				F.ODBC.Connection!Con.OpenCompanyConnection
				F.ODBC.Connection!Con.ExecuteAndReturn(V.Local.sFilter,V.Local.sFilter)
				F.ODBC.Connection!Con.Close
				F.Intrinsic.Control.If(V.Local.sFilter,<>,"")
					F.Intrinsic.String.Build("{0}-CCA",V.Local.sFilter.Long,V.Local.sRet)
				F.Intrinsic.Control.Else
					F.Intrinsic.String.Build("{0}-ECR",V.DataTable.Complete(V.Args.RowIndex).ECR!FieldValLong,V.Local.sRet)
				F.Intrinsic.Control.EndIf
				F.Global.General.SetPassedDataElement("DATA-LINK-KEY",V.Local.sRet)
				F.Global.General.SetPassedDataElement("DATA-LINK-DESC","Engineering Change Request")
				F.Intrinsic.String.Build("{0}\ATG_DocumentControl.gas",V.Caller.GasDir,V.Local.sATGDoc)
				F.Global.DocumentControl.GetLinkID(V.Local.sRet,2010,V.Local.iIdentity)
				F.Intrinsic.Control.If(V.Local.iIdentity,=,-1)
					F.Global.DocumentControl.CreateReference(V.Local.sRet,2010,V.Local.iIdentity)
				F.Intrinsic.Control.EndIf
				F.Global.General.CallAsyncGAS(V.Local.sATGDoc,V.Local.i)
			F.Intrinsic.Control.EndIf
			
	F.Intrinsic.Control.ExitSub

F.Intrinsic.Control.Catch
	F.Intrinsic.Control.If(V.Ambient.ErrorNumber,<>,0)
		F.Intrinsic.String.Build("Project: {0}{1}Subroutine: {2}{1}Error Occurred {3} with description {4}","GCG_5398_CAR_ECN.g2u",V.Ambient.NewLine,V.Ambient.CurrentSubroutine,V.Ambient.ErrorNumber,V.Ambient.ErrorDescription,V.Local.sError)
		F.Intrinsic.UI.Msgbox(V.Local.sError)
		F.Intrinsic.Control.CallSub(FormQC_UnLoad)
	F.Intrinsic.Control.EndIf
Function.Intrinsic.Control.EndTry	
Program.Sub.GsGridControlCompleted_RowcellClick.End

Program.Sub.FormCCA/ECR_UnLoad.Start
F.Intrinsic.Control.Try
	V.Local.sError.Declare(String,"")
	V.Local.iRet.Declare(Long,0)
	
	F.Intrinsic.Control.If(V.Screen.FormCCA/ECR!cmdCCAECRSave.Enabled)
		F.Intrinsic.UI.Msgbox("Current changes have not been saved, would you like to save changes?","Attention",4,V.Local.iRet)
		F.Intrinsic.Control.If(V.Local.iRet,=,6)
			F.Intrinsic.Control.CallSub(cmdCCAECRSave_Click)
		F.Intrinsic.Control.EndIf
	F.Intrinsic.Control.EndIf
	
	V.Global.iEcr.Set(0)
	
	F.Intrinsic.Control.BlockEvents
	Gui.FormCCA/ECR.chkECR.Value(0)
	Gui.FormCCA/ECR.ddlAssignedTo.Text("")
	Gui.FormCCA/ECR.ddlIssue.Text("")
	Gui.FormCCA/ECR.ddlPriority.Text("")
	Gui.FormCCA/ECR.ddlProjType.Text("")
	Gui.FormCCA/ECR.ddlStatus.Text("")
	Gui.FormCCA/ECR.ddlWG.Text("")
	GUi.FormCCA/ECR.dtpDueDate.Value(V.Ambient.Date)
	Gui.FormCCA/ECR.txtDesc.Text("")
	Gui.FormCCA/ECR.txtECR.Text("")
	Gui.FormCCA/ECR.txtESTCost.Text(V.Ambient.DBNull)
	gui.FormCCA/ECR.txtDept.Text("")
	Gui.FormCCA/ECR.txtOrgCheckBy.Text("")
	Gui.FormCCA/ECR.txtOrgDrawn.Text("")
	Gui.FormCCA/ECR.txtOrgModBy.Text("")
	Gui.FormCCA/ECR.txtPart.Text("")
	Gui.FormCCA/ECR.txtSO.Text("")
	Gui.FormCCA/ECR.txtWO.Text("")
	Gui.FormCCA/ECR.ddlSource.Text("")
	Gui.FormCCA/ECR.txtActionPlan.Text("")
	Gui.FormCCA/ECR.txtRootCause.Text("")
	F.Intrinsic.Control.UnBlockEvents
	
	F.Intrinsic.Control.BlockEvents
	Gui.FormCCA/ECR..Visible(False)
	F.Intrinsic.Control.UnBlockEvents
	
	F.Intrinsic.Control.ExitSub

F.Intrinsic.Control.Catch
	F.Intrinsic.Control.If(V.Ambient.ErrorNumber,<>,0)
		F.Intrinsic.String.Build("Project: {0}{1}Subroutine: {2}{1}Error Occurred {3} with description {4}","GCG_5398_CAR_ECN.g2u",V.Ambient.NewLine,V.Ambient.CurrentSubroutine,V.Ambient.ErrorNumber,V.Ambient.ErrorDescription,V.Local.sError)
		F.Intrinsic.UI.Msgbox(V.Local.sError)
		F.Intrinsic.Control.CallSub(FormQC_UnLoad)
	F.Intrinsic.Control.EndIf
Function.Intrinsic.Control.EndTry	
Program.Sub.FormCCA/ECR_UnLoad.End

Program.Sub.cmdPart_Click.Start
F.Intrinsic.Control.Try
	V.Local.sError.Declare(String,"")
	V.Local.sRet.Declare(String,"")
	
	'browser list is parsed for the type-ahead substring as it is being typed
	F.Intrinsic.UI.SetBrowserHotTypeAhead(True)

	F.Intrinsic.UI.Browser(105,"",V.Local.sRet)

	F.Intrinsic.Control.If(V.Local.sRet,<>,"***CANCEL***")
		F.Intrinsic.String.Split(V.Local.sRet,"*!*",V.Local.sRet)			
		Gui.FormCCA/ECR.txtPart.Text(V.Local.sRet.Trim)
		Gui.FormCCA/ECR.cmdCCAECRSave.Enabled(True)
	F.Intrinsic.Control.EndIf
				
	F.Intrinsic.Control.ExitSub

F.Intrinsic.Control.Catch
	F.Intrinsic.Control.If(V.Ambient.ErrorNumber,<>,0)
		F.Intrinsic.String.Build("Project: {0}{1}Subroutine: {2}{1}Error Occurred {3} with description {4}","GCG_5398_CAR_ECN.g2u",V.Ambient.NewLine,V.Ambient.CurrentSubroutine,V.Ambient.ErrorNumber,V.Ambient.ErrorDescription,V.Local.sError)
		F.Intrinsic.UI.Msgbox(V.Local.sError)
		F.Intrinsic.Control.CallSub(FormQC_UnLoad)
	F.Intrinsic.Control.EndIf
Function.Intrinsic.Control.EndTry	
Program.Sub.cmdPart_Click.End

Program.Sub.cmdWO_Click.Start
F.Intrinsic.Control.Try
	V.Local.sError.Declare(String,"")
	V.Local.sRet.Declare(String,"")
	V.Local.sSql.Declare(String,"")
	V.Local.sJob.Declare(String,"")
	V.Local.sSuffix.Declare(String,"")
	
	'browser list is parsed for the type-ahead substring as it is being typed
	F.Intrinsic.UI.SetBrowserHotTypeAhead(True)

	F.Intrinsic.UI.Browser(1000,"",V.Local.sRet)
	
	F.Intrinsic.Control.If(V.Local.sRet,<>,"***CANCEL***")
		F.Intrinsic.String.Split(V.Local.sRet,"*!*",V.Local.sRet)
		V.Local.sJob.Set(V.Local.sRet(0))
		V.Local.sSuffix.Set(V.Local.sRet(1))
		F.Intrinsic.String.Build("{0}-{1}",V.Local.sJob,V.Local.sSuffix,V.Local.sRet)
		F.Intrinsic.String.Build("Select Order_No, Order_Line, Part From V_Order_To_WO Where Job = '{0}' and Suffix = '{1}'",V.Local.sJob,V.Local.sSuffix,V.Local.sSql)
		Gui.FormCCA/ECR.txtWO.Text(V.Local.sRet)
		F.ODBC.Connection!Con.OpenCompanyConnection
		F.ODBC.Connection!Con.ExecuteAndReturn(V.Local.sSql,V.Local.sRet)
		F.Intrinsic.Control.If(V.Local.sRet.Length,>,0)
			F.Intrinsic.String.Split(V.Local.sRet,"*!*",V.Local.sRet)
			V.Local.sRet.RedimPreserve(0,2)
			Gui.FormCCA/ECR.txtPart.Text(V.Local.sRet(2))
			F.Intrinsic.String.Build("{0}-{1}",V.Local.sRet(0),V.Local.sRet(1),V.Local.sRet)
			Gui.FormCCA/ECR.txtSO.Text(V.Local.sRet.Trim)
		F.Intrinsic.Control.Else
			F.Intrinsic.String.Build("Select Part From V_Job_Header Where Job = '{0}' and Suffix = '{1}'",V.Local.sJob,V.Local.sSuffix,V.Local.sSql)
			F.ODBC.Connection!Con.ExecuteAndReturn(V.Local.sSql,V.Local.sRet)
			F.Intrinsic.Control.If(V.Local.sRet.Length,>,0)
				Gui.FormCCA/ECR.txtPart.Text(V.Local.sRet.Trim)
			F.Intrinsic.Control.EndIf
		F.Intrinsic.Control.EndIf
		F.ODBC.Connection!Con.Close
		Gui.FormCCA/ECR.cmdCCAECRSave.Enabled(True)
	F.Intrinsic.Control.EndIf

	F.Intrinsic.Control.ExitSub

F.Intrinsic.Control.Catch
	F.Intrinsic.Control.If(V.Ambient.ErrorNumber,<>,0)
		F.Intrinsic.String.Build("Project: {0}{1}Subroutine: {2}{1}Error Occurred {3} with description {4}","GCG_5398_CAR_ECN.g2u",V.Ambient.NewLine,V.Ambient.CurrentSubroutine,V.Ambient.ErrorNumber,V.Ambient.ErrorDescription,V.Local.sError)
		F.Intrinsic.UI.Msgbox(V.Local.sError)
		F.Intrinsic.Control.CallSub(FormQC_UnLoad)
	F.Intrinsic.Control.EndIf
Function.Intrinsic.Control.EndTry	
Program.Sub.cmdWO_Click.End

Program.Sub.cmdSO_Click.Start
F.Intrinsic.Control.Try
	V.Local.sError.Declare(String,"")
	V.Local.sRet.Declare(String,"")
	V.Local.sSql.Declare(String,"")
	V.Local.sTitles.Declare(String,"")
	V.Local.sWidths.Declare(String,"")
	
	'browser list is parsed for the type-ahead substring as it is being typed
	F.Intrinsic.UI.SetBrowserHotTypeAhead(True)

	F.ODBC.Connection!Con.OpenCompanyConnection
	
	V.Local.sSql.Set("Select Order_No, Record_No, Part, Description From V_Order_Lines Order by Order_No,Record_No")
	
	V.Local.sTitles.Set("Order*!*Line*!*Part*!*Description")
	V.Local.sWidths.Set("1800*!*1800*!*1800*!*1800")

	F.Intrinsic.String.Split(V.Local.sTitles,"*!*",V.Local.sTitles)
	F.Intrinsic.String.Split(V.Local.sWidths,"*!*",V.Local.sWidths)
	
	F.Intrinsic.UI.Browser("Select Sales Order/Line","con",V.Local.sSql,V.Local.sTitles,V.Local.sWidths,10200,8700,V.Local.sRet)
	
	F.Intrinsic.Control.If(V.Local.sRet,<>,"***CANCEL***")
		F.Intrinsic.String.Split(V.Local.sRet,"*!*",V.Local.sRet)
		F.Intrinsic.String.Build("{0}-{1}",V.Local.sRet(0),V.Local.sRet(1),V.Local.sRet)
		Gui.FormCCA/ECR.txtSO.Text(V.Local.sRet)
		Gui.FormCCA/ECR.txtPart.Text(V.Local.sRet(2).Trim)
		Gui.FormCCA/ECR.cmdCCAECRSave.Enabled(True)
	F.Intrinsic.Control.EndIf

	F.ODBC.Connection!Con.Close
	
	F.Intrinsic.Control.ExitSub

F.Intrinsic.Control.Catch
	F.Intrinsic.Control.If(V.Ambient.ErrorNumber,<>,0)
		F.Intrinsic.String.Build("Project: {0}{1}Subroutine: {2}{1}Error Occurred {3} with description {4}","GCG_5398_CAR_ECN.g2u",V.Ambient.NewLine,V.Ambient.CurrentSubroutine,V.Ambient.ErrorNumber,V.Ambient.ErrorDescription,V.Local.sError)
		F.Intrinsic.UI.Msgbox(V.Local.sError)
		F.Intrinsic.Control.CallSub(FormQC_UnLoad)
	F.Intrinsic.Control.EndIf
Function.Intrinsic.Control.EndTry	
Program.Sub.cmdSO_Click.End

Program.Sub.cmdDept_Click.Start
F.Intrinsic.Control.Try
	V.Local.sError.Declare(String,"")
	V.Local.sRet.Declare(String,"")
	V.Local.sSql.Declare(String,"")
	V.Local.sTitles.Declare(String,"")
	V.Local.sWidths.Declare(String,"")
	
	V.Local.sSql.Set("Select Distinct Dept_ID, Dept_Name From V_Departments")
	
	V.Local.sTitles.Set("Dept*!*Name")
	V.Local.sWidths.Set("1800*!*1800")

	F.Intrinsic.String.Split(V.Local.sTitles,"*!*",V.Local.sTitles)
	F.Intrinsic.String.Split(V.Local.sWidths,"*!*",V.Local.sWidths)
	
	F.ODBC.Connection!Con.OpenCompanyConnection
	
	F.Intrinsic.UI.Browser("Select Department","con",V.Local.sSql,V.Local.sTitles,V.Local.sWidths,10200,8700,V.Local.sRet)
	
	F.Intrinsic.Control.If(V.Local.sRet,<>,"***CANCEL***")
		F.Intrinsic.String.Split(V.Local.sRet,"*!*",V.Local.sRet)
		gui.FormCCA/ECR.txtDept.Text(V.Local.sRet.Trim)
		
'		F.Intrinsic.String.Build("Select rtrim(PR_User_ID), rtrim(PR_User_ID) From V_Employee_Mstr Where rtrim(Dept_Employee) = '{0}' and PR_User_ID <> ''",V.Local.sRet.Trim,V.Local.sSql)
		F.Intrinsic.String.Build("Select rtrim(PR_User_ID), rtrim(PR_User_ID) From V_Employee_Mstr a Where a.Employee in (Select b.Employee From GCG_5398_Dept_Maint b Where b.Dept_ID = '{0}') and PR_User_ID <> ''",V.Local.sRet.Trim,V.Local.sSql)
		
		F.Data.Dictionary.CreateFromSQL("AssignedTO","con",V.Local.sSql)
		Gui.FormCCA/ECR.ddlAssignedTo.ClearItems
		Gui.FormCCA/ECR.ddlAssignedTo.AddItem(" ",0)
		Gui.FormCCA/ECR.ddlAssignedTo.AddItems("Dictionary","AssignedTO")
		
		Gui.FormCCA/ECR.cmdCCAECRSave.Enabled(True)
		
		F.Data.Dictionary.Close("AssignedTO")
	F.Intrinsic.Control.EndIf
	
	F.ODBC.Connection!Con.Close
	
	F.Intrinsic.Control.ExitSub

F.Intrinsic.Control.Catch
	F.Intrinsic.Control.If(V.Ambient.ErrorNumber,<>,0)
		F.Intrinsic.String.Build("Project: {0}{1}Subroutine: {2}{1}Error Occurred {3} with description {4}","GCG_5398_CAR_ECN.g2u",V.Ambient.NewLine,V.Ambient.CurrentSubroutine,V.Ambient.ErrorNumber,V.Ambient.ErrorDescription,V.Local.sError)
		F.Intrinsic.UI.Msgbox(V.Local.sError)
		F.Intrinsic.Control.CallSub(FormQC_UnLoad)
	F.Intrinsic.Control.EndIf
Function.Intrinsic.Control.EndTry	
Program.Sub.cmdDept_Click.End

Program.Sub.cmdCCAECRSave_Click.Start
F.Intrinsic.Control.Try
	V.Local.sError.Declare(String,"")
	V.Local.sGrid.Declare(String,"")
	V.Local.sDesc.Declare(String,"")
	V.Local.sDate.Declare(String,"")
	V.Local.sFieldMap.Declare(String,"")
	V.Local.sFilter.Declare(String,"")
	V.Local.sRet.Declare(String,"")
	V.Local.sDateEntered.Declare(String,"")
	V.Local.iIdentity.Declare(Long,0)
	V.Local.sTemp.Declare(String,"")
	V.Local.sRootCause.Declare(String,"")
	V.Local.sActionPlan.Declare(String,"")
	V.Local.bSendEmail.Declare(Boolean,True)
	V.Local.bNew.Declare(Boolean,False)
	V.Local.iRet.Declare(Long,0)
	
	V.Local.sGrid.Set(V.Screen.FormCCA/ECR!lblCCA/ECR.Caption)
	V.Local.sGrid.Set(V.Local.sGrid.Left3)
	
	Gui.FormCCA/ECR.cmdCCAECRSave.Enabled(False)
	
	F.Intrinsic.String.Split(V.Screen.FormCCA/ECR!lblCCA/ECR.Caption,":",V.Local.sTemp)
	V.Local.iIdentity.Set(V.Local.sTemp(1).Long)
	
	F.ODBC.Connection!Con.OpenCompanyConnection
	F.Intrinsic.Control.If(V.Local.sGrid.UCase,=,"CAP")
		F.Intrinsic.String.Build("CCA_NO = {0}",V.Local.iIdentity,V.Local.sFilter)
		F.Intrinsic.String.Format(V.Screen.FormCCA/ECR!dtpDueDate.Value,"MM/DD/YYYY",V.Local.sDate)
		F.Intrinsic.Control.If(V.Local.sDate,=,"01/01/1900")
			V.Local.sDate.Set(V.Ambient.DBnull)
		F.Intrinsic.Control.EndIf
		V.Local.sDesc.Set(V.Screen.FormCCA/ECR!txtDesc.Text)
		V.Local.sActionPlan.Set(V.Screen.FormCCA/ECR!txtActionPlan.Text)
		V.Local.sRootCause.Set(V.Screen.FormCCA/ECR!txtRootCause.Text)
		
		F.Data.DataView.Create("Car","TempCar",22,V.Local.sFilter,"")
		
		F.Intrinsic.Control.If(V.DataView.CAR!TempCar.RowCount--,<>,-1)
			F.Intrinsic.UI.Msgbox("Would you like to resend an Email to the Process Email Addresss?","Attention",4,V.Local.iRet)
			F.Intrinsic.Control.If(V.Local.iRet,<>,6)
				V.Local.bSendEmail.Set(False)
			F.Intrinsic.Control.EndIf
			F.Intrinsic.Control.If(V.Screen.FormCCA/ECR!chkECR.Value,=,1)
				F.Intrinsic.Control.If(V.Local.sDate,=,"")
					F.Data.DataTable.SetValue("CAR",V.Global.iCarIndex,"ASSIGNED_Dept",V.Screen.FormCCA/ECR!txtDept.Text,"Description",V.Local.sDesc.Trim,"Root_Cause",V.Local.sRootCause.Trim,"Action_Plan",V.Local.sActionPlan.Trim,"ECR",V.Screen.FormCCA/ECR!txtECR.Text,"ECR_REQUIRED",True,"EST_COST_INC",V.Screen.FormCCA/ECR!txtESTCost.Text,"Part",V.Screen.FormCCA/ECR!txtPart.Text,"SO",V.Screen.FormCCA/ECR!txtSO.Text,"WO",V.Screen.FormCCA/ECR!txtWO.Text,"ASSIGNED_TO",V.Screen.FormCCA/ECR!ddlAssignedTo.Text,"Source",V.Screen.FormCCA/ECR!ddlSource.Text,"Issue",V.Screen.FormCCA/ECR!ddlIssue.Text,"Priority",V.Screen.FormCCA/ECR!ddlPriority.Text,"Project_Type",V.Screen.FormCCA/ECR!ddlProjType.Text,"Status",V.Screen.FormCCA/ECR!ddlStatus.Text,"WorkGroup",V.Screen.FormCCA/ECR!ddlWG.Text,"Due_Date",V.Ambient.DBNull)
				F.Intrinsic.Control.Else
					F.Data.DataTable.SetValue("CAR",V.Global.iCarIndex,"ASSIGNED_Dept",V.Screen.FormCCA/ECR!txtDept.Text,"Description",V.Local.sDesc.Trim,"Root_Cause",V.Local.sRootCause.Trim,"Action_Plan",V.Local.sActionPlan.Trim,"ECR",V.Screen.FormCCA/ECR!txtECR.Text,"ECR_REQUIRED",True,"EST_COST_INC",V.Screen.FormCCA/ECR!txtESTCost.Text,"Part",V.Screen.FormCCA/ECR!txtPart.Text,"SO",V.Screen.FormCCA/ECR!txtSO.Text,"WO",V.Screen.FormCCA/ECR!txtWO.Text,"ASSIGNED_TO",V.Screen.FormCCA/ECR!ddlAssignedTo.Text,"Source",V.Screen.FormCCA/ECR!ddlSource.Text,"Issue",V.Screen.FormCCA/ECR!ddlIssue.Text,"Priority",V.Screen.FormCCA/ECR!ddlPriority.Text,"Project_Type",V.Screen.FormCCA/ECR!ddlProjType.Text,"Status",V.Screen.FormCCA/ECR!ddlStatus.Text,"WorkGroup",V.Screen.FormCCA/ECR!ddlWG.Text,"Due_Date",V.Local.sDate)
				F.Intrinsic.Control.EndIf
			F.Intrinsic.Control.Else
				F.Intrinsic.Control.If(V.Local.sDate,=,"")
					F.Data.DataTable.SetValue("CAR",V.Global.iCarIndex,"ASSIGNED_Dept",V.Screen.FormCCA/ECR!txtDept.Text,"Description",V.Local.sDesc.Trim,"Root_Cause",V.Local.sRootCause.Trim,"Action_Plan",V.Local.sActionPlan.Trim,"ECR",V.Ambient.DBNull,"ECR_REQUIRED",False,"EST_COST_INC",V.Screen.FormCCA/ECR!txtESTCost.Text,"Part",V.Screen.FormCCA/ECR!txtPart.Text,"SO",V.Screen.FormCCA/ECR!txtSO.Text,"WO",V.Screen.FormCCA/ECR!txtWO.Text,"ASSIGNED_TO",V.Screen.FormCCA/ECR!ddlAssignedTo.Text,"Source",V.Screen.FormCCA/ECR!ddlSource.Text,"Issue",V.Screen.FormCCA/ECR!ddlIssue.Text,"Priority",V.Screen.FormCCA/ECR!ddlPriority.Text,"Project_Type",V.Screen.FormCCA/ECR!ddlProjType.Text,"Status",V.Screen.FormCCA/ECR!ddlStatus.Text,"WorkGroup",V.Screen.FormCCA/ECR!ddlWG.Text,"Due_Date",V.Ambient.DBNull)
				F.Intrinsic.Control.Else
					F.Data.DataTable.SetValue("CAR",V.Global.iCarIndex,"ASSIGNED_Dept",V.Screen.FormCCA/ECR!txtDept.Text,"Description",V.Local.sDesc.Trim,"Root_Cause",V.Local.sRootCause.Trim,"Action_Plan",V.Local.sActionPlan.Trim,"ECR",V.Ambient.DBNull,"ECR_REQUIRED",False,"EST_COST_INC",V.Screen.FormCCA/ECR!txtESTCost.Text,"Part",V.Screen.FormCCA/ECR!txtPart.Text,"SO",V.Screen.FormCCA/ECR!txtSO.Text,"WO",V.Screen.FormCCA/ECR!txtWO.Text,"ASSIGNED_TO",V.Screen.FormCCA/ECR!ddlAssignedTo.Text,"Source",V.Screen.FormCCA/ECR!ddlSource.Text,"Issue",V.Screen.FormCCA/ECR!ddlIssue.Text,"Priority",V.Screen.FormCCA/ECR!ddlPriority.Text,"Project_Type",V.Screen.FormCCA/ECR!ddlProjType.Text,"Status",V.Screen.FormCCA/ECR!ddlStatus.Text,"WorkGroup",V.Screen.FormCCA/ECR!ddlWG.Text,"Due_Date",V.Local.sDate)
				F.Intrinsic.Control.EndIf
			F.Intrinsic.Control.EndIf
		F.Intrinsic.Control.Else
			V.Local.bNew.Set(True)
			F.Intrinsic.String.Format(V.Ambient.Date,"MM/DD/YYYY",V.Local.sDateEntered)
			F.Intrinsic.Control.If(V.Screen.FormCCA/ECR!chkECR.Value,=,1)
				V.Global.iCarIndex.Set(V.DataTable.CAR.RowCount)
				F.Intrinsic.Control.If(V.Local.sDate,=,"")
					F.Data.DataTable.AddRow("CAR","CCA_NO",V.Local.iIdentity,"Date_Entered",V.Local.sDateEntered,"Orig_User",V.Caller.User.Trim,"ASSIGNED_Dept",V.Screen.FormCCA/ECR!txtDept.Text,"Description",V.Local.sDesc.Trim,"Root_Cause",V.Local.sRootCause.Trim,"Action_Plan",V.Local.sActionPlan.Trim,"ECR",V.Screen.FormCCA/ECR!txtECR.Text,"ECR_REQUIRED",True,"EST_COST_INC",V.Screen.FormCCA/ECR!txtESTCost.Text,"Part",V.Screen.FormCCA/ECR!txtPart.Text,"SO",V.Screen.FormCCA/ECR!txtSO.Text,"WO",V.Screen.FormCCA/ECR!txtWO.Text,"ASSIGNED_TO",V.Screen.FormCCA/ECR!ddlAssignedTo.Text,"Source",V.Screen.FormCCA/ECR!ddlSource.Text,"Issue",V.Screen.FormCCA/ECR!ddlIssue.Text,"Priority",V.Screen.FormCCA/ECR!ddlPriority.Text,"Project_Type",V.Screen.FormCCA/ECR!ddlProjType.Text,"Status",V.Screen.FormCCA/ECR!ddlStatus.Text,"WorkGroup",V.Screen.FormCCA/ECR!ddlWG.Text,"Due_Date",V.Ambient.DBNull)
				F.Intrinsic.Control.Else
					F.Data.DataTable.AddRow("CAR","CCA_NO",V.Local.iIdentity,"Date_Entered",V.Local.sDateEntered,"Orig_User",V.Caller.User.Trim,"ASSIGNED_Dept",V.Screen.FormCCA/ECR!txtDept.Text,"Description",V.Local.sDesc.Trim,"Root_Cause",V.Local.sRootCause.Trim,"Action_Plan",V.Local.sActionPlan.Trim,"ECR",V.Screen.FormCCA/ECR!txtECR.Text,"ECR_REQUIRED",True,"EST_COST_INC",V.Screen.FormCCA/ECR!txtESTCost.Text,"Part",V.Screen.FormCCA/ECR!txtPart.Text,"SO",V.Screen.FormCCA/ECR!txtSO.Text,"WO",V.Screen.FormCCA/ECR!txtWO.Text,"ASSIGNED_TO",V.Screen.FormCCA/ECR!ddlAssignedTo.Text,"Source",V.Screen.FormCCA/ECR!ddlSource.Text,"Issue",V.Screen.FormCCA/ECR!ddlIssue.Text,"Priority",V.Screen.FormCCA/ECR!ddlPriority.Text,"Project_Type",V.Screen.FormCCA/ECR!ddlProjType.Text,"Status",V.Screen.FormCCA/ECR!ddlStatus.Text,"WorkGroup",V.Screen.FormCCA/ECR!ddlWG.Text,"Due_Date",V.Local.sDate)
				F.Intrinsic.Control.EndIf
			F.Intrinsic.Control.Else
				F.Intrinsic.Control.If(V.Local.sDate,=,"")
					F.Data.DataTable.AddRow("CAR","CCA_NO",V.Local.iIdentity,"Date_Entered",V.Local.sDateEntered,"Orig_User",V.Caller.User.Trim,"ASSIGNED_Dept",V.Screen.FormCCA/ECR!txtDept.Text,"Description",V.Local.sDesc.Trim,"Root_Cause",V.Local.sRootCause.Trim,"Action_Plan",V.Local.sActionPlan.Trim,"ECR",V.Ambient.DBNull,"ECR_REQUIRED",False,"EST_COST_INC",V.Screen.FormCCA/ECR!txtESTCost.Text,"Part",V.Screen.FormCCA/ECR!txtPart.Text,"SO",V.Screen.FormCCA/ECR!txtSO.Text,"WO",V.Screen.FormCCA/ECR!txtWO.Text,"ASSIGNED_TO",V.Screen.FormCCA/ECR!ddlAssignedTo.Text,"Source",V.Screen.FormCCA/ECR!ddlSource.Text,"Issue",V.Screen.FormCCA/ECR!ddlIssue.Text,"Priority",V.Screen.FormCCA/ECR!ddlPriority.Text,"Project_Type",V.Screen.FormCCA/ECR!ddlProjType.Text,"Status",V.Screen.FormCCA/ECR!ddlStatus.Text,"WorkGroup",V.Screen.FormCCA/ECR!ddlWG.Text,"Due_Date",V.Ambient.DBNull)
				F.Intrinsic.Control.Else
					F.Data.DataTable.AddRow("CAR","CCA_NO",V.Local.iIdentity,"Date_Entered",V.Local.sDateEntered,"Orig_User",V.Caller.User.Trim,"ASSIGNED_Dept",V.Screen.FormCCA/ECR!txtDept.Text,"Description",V.Local.sDesc.Trim,"Root_Cause",V.Local.sRootCause.Trim,"Action_Plan",V.Local.sActionPlan.Trim,"ECR",V.Ambient.DBNull,"ECR_REQUIRED",False,"EST_COST_INC",V.Screen.FormCCA/ECR!txtESTCost.Text,"Part",V.Screen.FormCCA/ECR!txtPart.Text,"SO",V.Screen.FormCCA/ECR!txtSO.Text,"WO",V.Screen.FormCCA/ECR!txtWO.Text,"ASSIGNED_TO",V.Screen.FormCCA/ECR!ddlAssignedTo.Text,"Source",V.Screen.FormCCA/ECR!ddlSource.Text,"Issue",V.Screen.FormCCA/ECR!ddlIssue.Text,"Priority",V.Screen.FormCCA/ECR!ddlPriority.Text,"Project_Type",V.Screen.FormCCA/ECR!ddlProjType.Text,"Status",V.Screen.FormCCA/ECR!ddlStatus.Text,"WorkGroup",V.Screen.FormCCA/ECR!ddlWG.Text,"Due_Date",V.Local.sDate)
				F.Intrinsic.Control.EndIf
			F.Intrinsic.Control.EndIf
		F.Intrinsic.Control.EndIf
		
		F.Data.DataView.Close("Car","TempCar")
		
		F.Intrinsic.Control.If(v.Global.iEcr,>,0)
			F.Intrinsic.String.Format(V.Ambient.Date,"MM/DD/YYYY",V.Local.sDateEntered)
'			V.Local.sFieldMap.Set("ECR@!@ECR*!*DATE_ENTERED@!@DATE_ENTERED*!*ORIG_USER@!@ORIG_USER*!*PROJECT_TYPE@!@PROJECT_TYPE*!*PART@!@PART*!*WO@!@WO*!*SO@!@SO*!*ISSUE@!@ISSUE*!*DESCRIPTION@!@DESCRIPTION*!*STATUS@!@STATUS*!*ASSIGNED_Dept@!@ASSIGNED_Dept*!*ASSIGNED_TO@!@ASSIGNED_TO*!*DUE_DATE@!@DUE_DATE*!*PRIORITY@!@PRIORITY*!*EST_COST_INC@!@EST_COST_INC*!*WorkGroup@!@WorkGroup")
			V.Local.sFieldMap.Set("ECR@!@ECR*!*DATE_ENTERED@!@DATE_ENTERED*!*ORIG_USER@!@ORIG_USER*!*PROJECT_TYPE@!@PROJECT_TYPE*!*PART@!@PART*!*WO@!@WO*!*SO@!@SO*!*ISSUE@!@ISSUE*!*DESCRIPTION@!@DESCRIPTION*!*ROOT_CAUSE@!@ROOT_CAUSE*!*ACTION_PLAN@!@ACTION_PLAN*!*STATUS@!@STATUS*!*ASSIGNED_Dept@!@ASSIGNED_Dept*!*ASSIGNED_TO@!@ASSIGNED_TO*!*SOURCE@!@SOURCE*!*DUE_DATE@!@DUE_DATE*!*PRIORITY@!@PRIORITY*!*EST_COST_INC@!@EST_COST_INC*!*WorkGroup@!@WorkGroup*!*ECC@!@ECC*!*Orig_DrawnBy@!@Orig_DrawnBY*!*Orig_CheckBy@!@Orig_CheckBy*!*Orig_ModelBy@!@Orig_ModelBy")
			
			F.Data.DataTable.AddRow("ECR","ECR",v.Global.iEcr,"CCA_NO",V.Local.iIdentity,"DATE_ENTERED",V.Local.sDateEntered,"ORIG_USER",V.Caller.User.Trim,"STATUS","Assinged - Not Started","Priority",V.DataTable.CAR(V.Global.iCarIndex).Priority!FieldValTrim,"Part",V.DataTable.CAR(V.Global.iCarIndex).Part!FieldValTrim,"WO",V.DataTable.CAR(V.Global.iCarIndex).WO!FieldValTrim,"SO",V.DataTable.CAR(V.Global.iCarIndex).SO!FieldValTrim,"Source",V.DataTable.CAR(V.Global.iCarIndex).Source!FieldValTrim,"Issue",V.DataTable.CAR(V.Global.iCarIndex).Issue!FieldValTrim,"Description",V.DataTable.CAR(V.Global.iCarIndex).Description!FieldValTrim,"Root_Cause",V.DataTable.CAR(V.Global.iCarIndex).Root_Cause!FieldValTrim,"Action_Plan",V.DataTable.CAR(V.Global.iCarIndex).Action_Plan!FieldValTrim,"Project_Type",V.DataTable.CAR(V.Global.iCarIndex).Project_Type!FieldValTrim,"ASSIGNED_Dept",V.DataTable.CAR(V.Global.iCarIndex).ASSIGNED_Dept!FieldValTrim,"WorkGroup",V.DataTable.CAR(V.Global.iCarIndex).WorkGroup!FieldValTrim,"EST_COST_INC",V.DataTable.CAR(V.Global.iCarIndex).EST_COST_INC!FieldVal,"ASSIGNED_TO",V.DataTable.CAR(V.Global.iCarIndex).ASSIGNED_TO!FieldValTrim,"Due_Date",V.DataTable.CAR(V.Global.iCarIndex).Due_Date!FieldVal,"Edit","Edit")
			F.Data.DataTable.AddRow("ECRSave","ECR",v.Global.iEcr,"DATE_ENTERED",V.Local.sDateEntered,"ORIG_USER",V.Caller.User.Trim,"STATUS","Assinged - Not Started","Priority",V.DataTable.CAR(V.Global.iCarIndex).Priority!FieldValTrim,"Part",V.DataTable.CAR(V.Global.iCarIndex).Part!FieldValTrim,"WO",V.DataTable.CAR(V.Global.iCarIndex).WO!FieldValTrim,"SO",V.DataTable.CAR(V.Global.iCarIndex).SO!FieldValTrim,"Source",V.DataTable.CAR(V.Global.iCarIndex).Source!FieldValTrim,"Issue",V.DataTable.CAR(V.Global.iCarIndex).Issue!FieldValTrim,"Description",V.DataTable.CAR(V.Global.iCarIndex).Description!FieldValTrim,"Root_Cause",V.DataTable.CAR(V.Global.iCarIndex).Root_Cause!FieldValTrim,"Action_Plan",V.DataTable.CAR(V.Global.iCarIndex).Action_Plan!FieldValTrim,"Project_Type",V.DataTable.CAR(V.Global.iCarIndex).Project_Type!FieldValTrim,"ASSIGNED_Dept",V.DataTable.CAR(V.Global.iCarIndex).ASSIGNED_Dept!FieldValTrim,"WorkGroup",V.DataTable.CAR(V.Global.iCarIndex).WorkGroup!FieldValTrim,"EST_COST_INC",V.DataTable.CAR(V.Global.iCarIndex).EST_COST_INC!FieldVal,"ASSIGNED_TO",V.DataTable.CAR(V.Global.iCarIndex).ASSIGNED_TO!FieldValTrim,"Due_Date",V.DataTable.CAR(V.Global.iCarIndex).Due_Date!FieldVal)
			F.Data.DataTable.SaveToDB("ECRSave","con","GCG_5398_ECR","ECR",256,V.Local.sFieldMap)
			F.Data.DataTable.DeleteRow("ECRSave")
			F.Data.DataTable.AcceptChanges("ECRSave")
			GUi.FormQC.GsGridControlECR.ResumeLayout
		F.Intrinsic.Control.EndIf
		
		V.Local.sFieldMap.Set("CCA_NO@!@CCA_NO*!*ECR@!@ECR*!*ECR_REQUIRED@!@ECR_REQUIRED*!*DATE_ENTERED@!@DATE_ENTERED*!*ORIG_USER@!@ORIG_USER*!*PROJECT_TYPE@!@PROJECT_TYPE*!*PART@!@PART*!*WO@!@WO*!*SO@!@SO*!*ISSUE@!@ISSUE*!*DESCRIPTION@!@DESCRIPTION*!*ROOT_CAUSE@!@ROOT_CAUSE*!*ACTION_PLAN@!@ACTION_PLAN*!*STATUS@!@STATUS*!*ASSIGNED_Dept@!@ASSIGNED_Dept*!*ASSIGNED_TO@!@ASSIGNED_TO*!*SOURCE@!@SOURCE*!*DUE_DATE@!@DUE_DATE*!*PRIORITY@!@PRIORITY*!*EST_COST_INC@!@EST_COST_INC*!*WorkGroup@!@WorkGroup")
		'saving current row
		F.Intrinsic.String.Build("CCA_NO = {0}",V.Local.iIdentity,V.Local.sFilter)
		F.Data.DataView.Create("CAR","CARTemp",22,V.Local.sFilter,"")
		F.Data.DataView.ToDataTable("CAR","CARTemp","CARSaveTemp")
		F.Data.DataView.Close("CAR","CARTemp")
		F.Data.DataTable.Merge("CARSaveTemp","CarSave",True,2)
		F.Data.DataTable.SaveToDB("CARSave","Con","GCG_5398_CAR","CCA_NO",256,V.Local.sFieldMap)
		F.Data.DataTable.DeleteRow("CarSave")
		F.Data.DataTable.AcceptChanges("CarSave")		
		V.Local.sRet.Set(V.DataTable.CarSaveTemp(V.DataTable.CarSaveTemp.RowCount--).Status!FieldValTrim)
		F.Intrinsic.Control.If(V.Local.sRet.UCase,=,"COMPLETE - AWAITING SIGNOFF")
			F.Data.DataTable.AddColumn("CarSaveTemp","QA_SIGNOFF","Boolean")
			F.Data.DataTable.AddColumn("CarSaveTemp","Group_1_SIGNOFF","Boolean")
			F.Data.DataTable.AddColumn("CarSaveTemp","Group_2_SIGNOFF","Boolean")
			F.Data.DataTable.SetValue("CarSaveTemp",-1,"QA_SIGNOFF",False,"Group_1_SIGNOFF",False,"Group_2_SIGNOFF",False)
			F.Data.DataTable.Merge("CarSaveTemp","Signoff",True,2)
			F.Data.DataTable.DeleteRow("CAR",V.Global.iCarIndex)
			F.Data.DataTable.AcceptChanges("CAR")
		F.Intrinsic.Control.EndIf
		
	F.Intrinsic.Control.Else	
		F.Intrinsic.String.Format(V.Screen.FormCCA/ECR!dtpDueDate.Value,"MM/DD/YYYY",V.Local.sDate)
		F.Intrinsic.Control.If(V.Local.sDate,=,"1/1/1900")
			V.Local.sDate.Set(V.Ambient.DBnull)
		F.Intrinsic.Control.EndIf
		V.Local.sDesc.Set(V.Screen.FormCCA/ECR!txtDesc.Text)
		V.Local.sActionPlan.Set(V.Screen.FormCCA/ECR!txtActionPlan.Text)
		V.Local.sRootCause.Set(V.Screen.FormCCA/ECR!txtRootCause.Text)
		
		F.Intrinsic.String.Build("ECR = {0}",V.Local.iIdentity,V.Local.sFilter)
		F.Data.DataView.Create("ECR","ECRTemp",22,V.Local.sFilter,"")
		F.Intrinsic.Control.If(V.DataView.ECR!ECRTemp.RowCount--,<>,-1)
			F.Intrinsic.UI.Msgbox("Would you like to resend an Email to the Process Email Addresss?","Attention",4,V.Local.iRet)
			F.Intrinsic.Control.If(V.Local.iRet,<>,6)
				V.Local.bSendEmail.Set(False)
			F.Intrinsic.Control.EndIf
			F.Intrinsic.Control.If(V.Local.sDate,=,"")
				F.Data.DataTable.SetValue("ECR",V.Global.iECRIndex,"ASSIGNED_Dept",V.Screen.FormCCA/ECR!txtDept.Text,"Description",V.Local.sDesc.Trim,"Root_Cause",V.Local.sRootCause.Trim,"Action_Plan",V.Local.sActionPlan.Trim,"EST_COST_INC",V.Screen.FormCCA/ECR!txtESTCost.Text,"Part",V.Screen.FormCCA/ECR!txtPart.Text,"SO",V.Screen.FormCCA/ECR!txtSO.Text,"WO",V.Screen.FormCCA/ECR!txtWO.Text,"ASSIGNED_TO",V.Screen.FormCCA/ECR!ddlAssignedTo.Text,"Source",V.Screen.FormCCA/ECR!ddlSource.Text,"Issue",V.Screen.FormCCA/ECR!ddlIssue.Text,"Priority",V.Screen.FormCCA/ECR!ddlPriority.Text,"Project_Type",V.Screen.FormCCA/ECR!ddlProjType.Text,"Status",V.Screen.FormCCA/ECR!ddlStatus.Text,"WorkGroup",V.Screen.FormCCA/ECR!ddlWG.Text,"Due_Date",V.Ambient.DBNull,"ECC",V.Screen.FormCCA/ECR!txtECR.Text,"ORIG_DRAWNBY",V.Screen.FormCCA/ECR!txtOrgDrawn.Text,"ORIG_CHECKBY",V.Screen.FormCCA/ECR!txtOrgCheckBy.Text,"ORIG_MODELBY",V.Screen.FormCCA/ECR!txtOrgModBy.Text)
			F.Intrinsic.Control.Else
				F.Data.DataTable.SetValue("ECR",V.Global.iECRIndex,"ASSIGNED_Dept",V.Screen.FormCCA/ECR!txtDept.Text,"Description",V.Local.sDesc.Trim,"Root_Cause",V.Local.sRootCause.Trim,"Action_Plan",V.Local.sActionPlan.Trim,"EST_COST_INC",V.Screen.FormCCA/ECR!txtESTCost.Text,"Part",V.Screen.FormCCA/ECR!txtPart.Text,"SO",V.Screen.FormCCA/ECR!txtSO.Text,"WO",V.Screen.FormCCA/ECR!txtWO.Text,"ASSIGNED_TO",V.Screen.FormCCA/ECR!ddlAssignedTo.Text,"Source",V.Screen.FormCCA/ECR!ddlSource.Text,"Issue",V.Screen.FormCCA/ECR!ddlIssue.Text,"Priority",V.Screen.FormCCA/ECR!ddlPriority.Text,"Project_Type",V.Screen.FormCCA/ECR!ddlProjType.Text,"Status",V.Screen.FormCCA/ECR!ddlStatus.Text,"WorkGroup",V.Screen.FormCCA/ECR!ddlWG.Text,"Due_Date",V.Local.sDate,"ECC",V.Screen.FormCCA/ECR!txtECR.Text,"ORIG_DRAWNBY",V.Screen.FormCCA/ECR!txtOrgDrawn.Text,"ORIG_CHECKBY",V.Screen.FormCCA/ECR!txtOrgCheckBy.Text,"ORIG_MODELBY",V.Screen.FormCCA/ECR!txtOrgModBy.Text)
			F.Intrinsic.Control.EndIf
		F.Intrinsic.Control.Else
			V.Local.bNew.Set(True)
			V.Global.iEcrIndex.Set(V.DataTable.ECR.RowCount)
			F.Intrinsic.String.Format(V.Ambient.Date,"MM/DD/YYYY",V.Local.sDateEntered)
			F.Intrinsic.Control.If(V.Local.sDate,=,"")
				F.Data.DataTable.AddRow("ECR","ECR",V.Local.iIdentity,"Date_Entered",V.Local.sDateEntered,"Orig_User",V.Caller.User.Trim,"ASSIGNED_Dept",V.Screen.FormCCA/ECR!txtDept.Text,"Description",V.Local.sDesc.Trim,"Root_Cause",V.Local.sRootCause.Trim,"Action_Plan",V.Local.sActionPlan.Trim,"EST_COST_INC",V.Screen.FormCCA/ECR!txtESTCost.Text,"Part",V.Screen.FormCCA/ECR!txtPart.Text,"SO",V.Screen.FormCCA/ECR!txtSO.Text,"WO",V.Screen.FormCCA/ECR!txtWO.Text,"ASSIGNED_TO",V.Screen.FormCCA/ECR!ddlAssignedTo.Text,"Source",V.Screen.FormCCA/ECR!ddlSource.Text,"Issue",V.Screen.FormCCA/ECR!ddlIssue.Text,"Priority",V.Screen.FormCCA/ECR!ddlPriority.Text,"Project_Type",V.Screen.FormCCA/ECR!ddlProjType.Text,"Status",V.Screen.FormCCA/ECR!ddlStatus.Text,"WorkGroup",V.Screen.FormCCA/ECR!ddlWG.Text,"Due_Date",V.Ambient.DBNull,"ECC",V.Screen.FormCCA/ECR!txtECR.Text,"ORIG_DRAWNBY",V.Screen.FormCCA/ECR!txtOrgDrawn.Text,"ORIG_CHECKBY",V.Screen.FormCCA/ECR!txtOrgCheckBy.Text,"ORIG_MODELBY",V.Screen.FormCCA/ECR!txtOrgModBy.Text)
			F.Intrinsic.Control.Else
				F.Data.DataTable.AddRow("ECR","ECR",V.Local.iIdentity,"Date_Entered",V.Local.sDateEntered,"Orig_User",V.Caller.User.Trim,"ASSIGNED_Dept",V.Screen.FormCCA/ECR!txtDept.Text,"Description",V.Local.sDesc.Trim,"Root_Cause",V.Local.sRootCause.Trim,"Action_Plan",V.Local.sActionPlan.Trim,"EST_COST_INC",V.Screen.FormCCA/ECR!txtESTCost.Text,"Part",V.Screen.FormCCA/ECR!txtPart.Text,"SO",V.Screen.FormCCA/ECR!txtSO.Text,"WO",V.Screen.FormCCA/ECR!txtWO.Text,"ASSIGNED_TO",V.Screen.FormCCA/ECR!ddlAssignedTo.Text,"Source",V.Screen.FormCCA/ECR!ddlSource.Text,"Issue",V.Screen.FormCCA/ECR!ddlIssue.Text,"Priority",V.Screen.FormCCA/ECR!ddlPriority.Text,"Project_Type",V.Screen.FormCCA/ECR!ddlProjType.Text,"Status",V.Screen.FormCCA/ECR!ddlStatus.Text,"WorkGroup",V.Screen.FormCCA/ECR!ddlWG.Text,"Due_Date",V.Local.sDate,"ECC",V.Screen.FormCCA/ECR!txtECR.Text,"ORIG_DRAWNBY",V.Screen.FormCCA/ECR!txtOrgDrawn.Text,"ORIG_CHECKBY",V.Screen.FormCCA/ECR!txtOrgCheckBy.Text,"ORIG_MODELBY",V.Screen.FormCCA/ECR!txtOrgModBy.Text)
			F.Intrinsic.Control.EndIf
		F.Intrinsic.Control.EndIf
		
		F.Data.DataView.Close("Ecr","EcrTemp")
		
		V.Local.sFieldMap.Set("ECR@!@ECR*!*DATE_ENTERED@!@DATE_ENTERED*!*ORIG_USER@!@ORIG_USER*!*PROJECT_TYPE@!@PROJECT_TYPE*!*PART@!@PART*!*WO@!@WO*!*SO@!@SO*!*ISSUE@!@ISSUE*!*DESCRIPTION@!@DESCRIPTION*!*ROOT_CAUSE@!@ROOT_CAUSE*!*ACTION_PLAN@!@ACTION_PLAN*!*STATUS@!@STATUS*!*ASSIGNED_Dept@!@ASSIGNED_Dept*!*ASSIGNED_TO@!@ASSIGNED_TO*!*SOURCE@!@SOURCE*!*DUE_DATE@!@DUE_DATE*!*PRIORITY@!@PRIORITY*!*EST_COST_INC@!@EST_COST_INC*!*WorkGroup@!@WorkGroup*!*ECC@!@ECC*!*Orig_DrawnBy@!@Orig_DrawnBY*!*Orig_CheckBy@!@Orig_CheckBy*!*Orig_ModelBy@!@Orig_ModelBy")
		'saving current row
		F.Intrinsic.String.Build("ECR = {0}",V.DataTable.ECR(V.Global.iECRIndex).ECR!FieldValLong,V.Local.sFilter)
		F.Data.DataView.Create("ECR","ECRTemp",22,V.Local.sFilter,"")
		F.Data.DataView.ToDataTable("ECR","ECRTemp","ECRSaveTemp")
		F.Data.DataView.Close("ECR","ECRTemp")
		F.Data.DataTable.Merge("ECRSaveTemp","ECRSave",True,2)
		F.Data.DataTable.SaveToDB("ECRSave","Con","GCG_5398_ECR","ECR",256,V.Local.sFieldMap)
		F.Data.DataTable.DeleteRow("ECRSave")
		F.Data.DataTable.AcceptChanges("ECRSave")		
		V.Local.sRet.Set(V.DataTable.ECRSaveTemp(V.DataTable.ECRSaveTemp.RowCount--).Status!FieldValTrim)
		F.Intrinsic.Control.If(V.Local.sRet.UCase,=,"COMPLETE - AWAITING SIGNOFF")
			F.Data.DataTable.AddColumn("ECRSaveTemp","QA_SIGNOFF","Boolean")
			F.Data.DataTable.AddColumn("ECRSaveTemp","Group_1_SIGNOFF","Boolean")
			F.Data.DataTable.AddColumn("ECRSaveTemp","Group_2_SIGNOFF","Boolean")
			F.Data.DataTable.SetValue("ECRSaveTemp",-1,"QA_SIGNOFF",False,"Group_1_SIGNOFF",False,"Group_2_SIGNOFF",False)
			F.Data.DataTable.Merge("ECRSaveTemp","Signoff",True,2)
			F.Data.DataTable.DeleteRow("ECR",V.Global.iECRIndex)
			F.Data.DataTable.AcceptChanges("ECR")
		F.Intrinsic.Control.EndIf
	F.Intrinsic.Control.EndIf
	
	F.Intrinsic.Control.If(V.Local.bSendEmail)
		Function.Global.General.ResetPassedDataElements
		F.Intrinsic.String.Build("{0}",V.Screen.FormCCA/ECR!lblCCA/ECR.Caption,V.Local.sRet)

		F.Global.General.SetPassedDataElement("ECR_CCA",V.Local.sRet)
		F.Intrinsic.Control.If(V.Local.bNew)
			F.Global.General.SetPassedDataElement("Type","NEW")
		F.Intrinsic.Control.Else
			F.Global.General.SetPassedDataElement("Type","UPDATE")
		F.Intrinsic.Control.EndIf
		F.Intrinsic.String.Build("{0}\GCG_5398_ISSUE_EMAIL.g2u",V.Caller.GasDir,V.Local.sRet)
		F.Global.General.CallsyncGAS(V.Local.sRet,"S",-1)
	F.Intrinsic.Control.EndIf
		
	F.ODBC.Connection!Con.Close
	
	F.Intrinsic.Control.CallSub(FormCCA/ECR_UnLoad)
	
	F.Intrinsic.Control.ExitSub

F.Intrinsic.Control.Catch
	F.Intrinsic.Control.If(V.Ambient.ErrorNumber,<>,0)
		F.Intrinsic.String.Build("Project: {0}{1}Subroutine: {2}{1}Error Occurred {3} with description {4}","GCG_5398_CAR_ECN.g2u",V.Ambient.NewLine,V.Ambient.CurrentSubroutine,V.Ambient.ErrorNumber,V.Ambient.ErrorDescription,V.Local.sError)
		F.Intrinsic.UI.Msgbox(V.Local.sError)
		F.Intrinsic.Control.CallSub(FormQC_UnLoad)
	F.Intrinsic.Control.EndIf
Function.Intrinsic.Control.EndTry	
Program.Sub.cmdCCAECRSave_Click.End

Program.Sub.FormCCA/ECRSignoff_UnLoad.Start
F.Intrinsic.Control.Try
	V.Local.sError.Declare(String,"")
	V.Local.iRet.Declare(Long,0)
	
	F.Intrinsic.Control.If(V.Screen.FormCCA/ECRSignoff!cmdSaveSignoff.Enabled)
		F.Intrinsic.UI.Msgbox("Current changes have not been saved, whould you like to save changes?","Attention",4,V.Local.iRet)
		F.Intrinsic.Control.If(V.Local.iRet,=,6)
			F.Intrinsic.Control.CallSub(cmdSaveSignoff_Click)
		F.Intrinsic.Control.EndIf
	F.Intrinsic.Control.EndIf
	
	Gui.FormCCA/ECRSignoff..Visible(False)
	
	F.Intrinsic.Control.ExitSub

F.Intrinsic.Control.Catch
	F.Intrinsic.Control.If(V.Ambient.ErrorNumber,<>,0)
		F.Intrinsic.String.Build("Project: {0}{1}Subroutine: {2}{1}Error Occurred {3} with description {4}","GCG_5398_CAR_ECN.g2u",V.Ambient.NewLine,V.Ambient.CurrentSubroutine,V.Ambient.ErrorNumber,V.Ambient.ErrorDescription,V.Local.sError)
		F.Intrinsic.UI.Msgbox(V.Local.sError)
		F.Intrinsic.Control.CallSub(FormQC_UnLoad)
	F.Intrinsic.Control.EndIf
Function.Intrinsic.Control.EndTry	
Program.Sub.FormCCA/ECRSignoff_UnLoad.End

Program.Sub.chkAddGroup1Signoff_Click.Start
F.Intrinsic.Control.Try
	V.Local.sError.Declare(String,"")
	
	F.Intrinsic.Control.If(V.Screen.FormCCA/ECRSignoff!chkAddGroup1Signoff.Value,=,1)
		Gui.FormCCA/ECRSignoff.txtGroup1User.Text(V.Caller.User.Trim)
	F.Intrinsic.Control.Else
		Gui.FormCCA/ECRSignoff.txtGroup1User.Text("")
	F.Intrinsic.Control.EndIf
	
	Gui.FormCCA/ECRSignoff.cmdSaveSignoff.Enabled(True)
	
	F.Intrinsic.Control.ExitSub

F.Intrinsic.Control.Catch
	F.Intrinsic.Control.If(V.Ambient.ErrorNumber,<>,0)
		F.Intrinsic.String.Build("Project: {0}{1}Subroutine: {2}{1}Error Occurred {3} with description {4}","GCG_5398_CAR_ECN.g2u",V.Ambient.NewLine,V.Ambient.CurrentSubroutine,V.Ambient.ErrorNumber,V.Ambient.ErrorDescription,V.Local.sError)
		F.Intrinsic.UI.Msgbox(V.Local.sError)
		F.Intrinsic.Control.CallSub(FormQC_UnLoad)
	F.Intrinsic.Control.EndIf
Function.Intrinsic.Control.EndTry
Program.Sub.chkAddGroup1Signoff_Click.End

Program.Sub.chkAddGroup2Signoff_Click.Start
F.Intrinsic.Control.Try
	V.Local.sError.Declare(String,"")
	
	F.Intrinsic.Control.If(V.Screen.FormCCA/ECRSignoff!chkAddGroup2Signoff.Value,=,1)
		Gui.FormCCA/ECRSignoff.txtGroup2User.Text(V.Caller.User.Trim)
	F.Intrinsic.Control.Else
		Gui.FormCCA/ECRSignoff.txtGroup2User.Text("")
	F.Intrinsic.Control.EndIf
	
	Gui.FormCCA/ECRSignoff.cmdSaveSignoff.Enabled(True)
	
	F.Intrinsic.Control.ExitSub

F.Intrinsic.Control.Catch
	F.Intrinsic.Control.If(V.Ambient.ErrorNumber,<>,0)
		F.Intrinsic.String.Build("Project: {0}{1}Subroutine: {2}{1}Error Occurred {3} with description {4}","GCG_5398_CAR_ECN.g2u",V.Ambient.NewLine,V.Ambient.CurrentSubroutine,V.Ambient.ErrorNumber,V.Ambient.ErrorDescription,V.Local.sError)
		F.Intrinsic.UI.Msgbox(V.Local.sError)
		F.Intrinsic.Control.CallSub(FormQC_UnLoad)
	F.Intrinsic.Control.EndIf
Function.Intrinsic.Control.EndTry
Program.Sub.chkAddGroup2Signoff_Click.End

Program.Sub.chkQCSignoff_Click.Start
F.Intrinsic.Control.Try
	V.Local.sError.Declare(String,"")
	
	F.Intrinsic.Control.BlockEvents
	F.Intrinsic.Control.If(V.Screen.FormCCA/ECRSignoff!ddlAddGroup1.Text,=,"","AND",V.Screen.FormCCA/ECRSignoff!ddlAddGroup2.Text,=,"")
		Gui.FormCCA/ECRSignoff.chkQCSignoff.Value(1)
		Gui.FormCCA/ECRSignoff.txtQCUser.Text(V.Caller.User.Trim)
	F.Intrinsic.Control.Else
		F.Intrinsic.Control.If(V.Screen.FormCCA/ECRSignoff!ddlAddGroup1.Text,<>,"","AND",V.Screen.FormCCA/ECRSignoff!ddlAddGroup2.Text,<>,"")
			F.Intrinsic.Control.If(V.Screen.FormCCA/ECRSignoff!chkAddGroup1Signoff.Value,=,1,"AND",V.Screen.FormCCA/ECRSignoff!chkAddGroup2Signoff.Value,=,1)
				Gui.FormCCA/ECRSignoff.chkQCSignoff.Value(1)
				Gui.FormCCA/ECRSignoff.txtQCUser.Text(V.Caller.User.Trim)
			F.Intrinsic.Control.Else
				Gui.FormCCA/ECRSignoff.chkQCSignoff.Value(0)
			F.Intrinsic.Control.EndIf
		F.Intrinsic.Control.Else
			F.Intrinsic.Control.If(V.Screen.FormCCA/ECRSignoff!ddlAddGroup1.Text,<>,"")
				F.Intrinsic.Control.If(V.Screen.FormCCA/ECRSignoff!chkAddGroup1Signoff.Value,=,1)
					Gui.FormCCA/ECRSignoff.chkQCSignoff.Value(1)
					Gui.FormCCA/ECRSignoff.txtQCUser.Text(V.Caller.User.Trim)
				F.Intrinsic.Control.Else
					Gui.FormCCA/ECRSignoff.chkQCSignoff.Value(0)
				F.Intrinsic.Control.EndIf
			F.Intrinsic.Control.Else
				F.Intrinsic.Control.If(V.Screen.FormCCA/ECRSignoff!chkAddGroup2Signoff.Value,=,1)
					Gui.FormCCA/ECRSignoff.chkQCSignoff.Value(1)
					Gui.FormCCA/ECRSignoff.txtQCUser.Text(V.Caller.User.Trim)
				F.Intrinsic.Control.Else
					Gui.FormCCA/ECRSignoff.chkQCSignoff.Value(0)
				F.Intrinsic.Control.EndIf
			F.Intrinsic.Control.EndIf
		F.Intrinsic.Control.EndIf
	F.Intrinsic.Control.EndIf
	
	Gui.FormCCA/ECRSignoff.txtQCUser.SetFocus
	Gui.FormCCA/ECRSignoff.cmdSaveSignoff.Enabled(True)
	
	F.Intrinsic.Control.UnBlockEvents
	F.Intrinsic.Control.ExitSub

F.Intrinsic.Control.Catch
	F.Intrinsic.Control.If(V.Ambient.ErrorNumber,<>,0)
		F.Intrinsic.String.Build("Project: {0}{1}Subroutine: {2}{1}Error Occurred {3} with description {4}","GCG_5398_CAR_ECN.g2u",V.Ambient.NewLine,V.Ambient.CurrentSubroutine,V.Ambient.ErrorNumber,V.Ambient.ErrorDescription,V.Local.sError)
		F.Intrinsic.UI.Msgbox(V.Local.sError)
		F.Intrinsic.Control.CallSub(FormQC_UnLoad)
	F.Intrinsic.Control.EndIf
Function.Intrinsic.Control.EndTry
Program.Sub.chkQCSignoff_Click.End

Program.Sub.cmdSendEmails_Click.Start
F.Intrinsic.Control.Try
	V.Local.sError.Declare(String,"")
	V.Local.sRet.Declare(String,"")
	V.Local.sProjNo.Declare(String,"")
	
	'email 			
	Function.Global.General.ResetPassedDataElements
	F.Intrinsic.String.Build("{0}",V.Screen.FormCCA/ECRSignoff!lblCCA/ECR.Caption,V.Local.sRet)
	
	F.Intrinsic.Control.If(V.Screen.FormCCA/ECRSignoff!ddlAddGroup1.Text,<>,"","AND",V.Screen.FormCCA/ECRSignoff!chkAddGroup1Signoff.Value,=,0)
		F.Global.General.SetPassedDataElement("ECR_CCA",V.Local.sRet)
		F.Global.General.SetPassedDataElement("Type","SIGNOFF")
		F.Global.General.SetPassedDataElement("Group",V.Screen.FormCCA/ECRSignoff!ddlAddGroup1.Text)
		F.Intrinsic.String.Build("{0}\GCG_5398_ISSUE_EMAIL.g2u",V.Caller.GasDir,V.Local.sRet)
		F.Global.General.CallsyncGAS(V.Local.sRet,"S",-1)
		F.Intrinsic.UI.Msgbox("Email Sent")
	F.Intrinsic.Control.EndIf
	
	F.Intrinsic.Control.If(V.Screen.FormCCA/ECRSignoff!ddlAddGroup2.Text,<>,"","AND",V.Screen.FormCCA/ECRSignoff!chkAddGroup2Signoff.Value,=,0)
		F.Global.General.SetPassedDataElement("ECR_CCA",V.Local.sRet)
		F.Global.General.SetPassedDataElement("Type","SIGNOFF")
		F.Global.General.SetPassedDataElement("Group",V.Screen.FormCCA/ECRSignoff!ddlAddGroup2.Text)
		F.Intrinsic.String.Build("{0}\GCG_5398_ISSUE_EMAIL.g2u",V.Caller.GasDir,V.Local.sRet)
		F.Global.General.CallsyncGAS(V.Local.sRet,"S",-1)
		F.Intrinsic.UI.Msgbox("Email Sent")
	F.Intrinsic.Control.EndIf
	
	F.Intrinsic.Control.ExitSub

F.Intrinsic.Control.Catch
	F.Intrinsic.Control.If(V.Ambient.ErrorNumber,<>,0)
		F.Intrinsic.String.Build("Project: {0}{1}Subroutine: {2}{1}Error Occurred {3} with description {4}","GCG_5398_CAR_ECN.g2u",V.Ambient.NewLine,V.Ambient.CurrentSubroutine,V.Ambient.ErrorNumber,V.Ambient.ErrorDescription,V.Local.sError)
		F.Intrinsic.UI.Msgbox(V.Local.sError)
		F.Intrinsic.Control.CallSub(FormQC_UnLoad)
	F.Intrinsic.Control.EndIf
Function.Intrinsic.Control.EndTry
Program.Sub.cmdSendEmails_Click.End

Program.Sub.cmdSaveSignoff_Click.Start
F.Intrinsic.Control.Try
	V.Local.sError.Declare(String,"")
	V.Local.sFieldMap.Declare(String,"")
	V.Local.sFilter.Declare(String,"")
	
	F.ODBC.Connection!Con.OpenCompanyConnection
	F.Data.DataTable.SetValue("Signoff",V.Global.iSignOffIndex,"ADD_Group_1",V.Screen.FormCCA/ECRSignoff!ddlAddGroup1.Text,"ADD_Group_2",V.Screen.FormCCA/ECRSignoff!ddlAddGroup2.Text,"Group_1_USER",V.Screen.FormCCA/ECRSignoff!txtGroup1User.Text,"Group_2_USER",V.Screen.FormCCA/ECRSignoff!txtGroup2User.Text,"QA_USER",V.Screen.FormCCA/ECRSignoff!txtQCUser.Text)
	F.Intrinsic.Control.If(V.Screen.FormCCA/ECRSignoff!chkAddGroup1Signoff.Value,=,1)
		F.Data.DataTable.SetValue("Signoff",V.Global.iSignOffIndex,"Group_1_SIGNOFF",True)
	F.Intrinsic.Control.Else
		F.Data.DataTable.SetValue("Signoff",V.Global.iSignOffIndex,"Group_1_SIGNOFF",False)
	F.Intrinsic.Control.EndIf
	F.Intrinsic.Control.If(V.Screen.FormCCA/ECRSignoff!chkAddGroup2Signoff.Value,=,1)
		F.Data.DataTable.SetValue("Signoff",V.Global.iSignOffIndex,"Group_2_SIGNOFF",True)
	F.Intrinsic.Control.Else
		F.Data.DataTable.SetValue("Signoff",V.Global.iSignOffIndex,"Group_2_SIGNOFF",False)
	F.Intrinsic.Control.EndIf
	F.Intrinsic.Control.If(V.Screen.FormCCA/ECRSignoff!chkQCSignoff.Value,=,1)
		F.Data.DataTable.SetValue("Signoff",V.Global.iSignOffIndex,"QA_SIGNOFF",True)
	F.Intrinsic.Control.Else
		F.Data.DataTable.SetValue("Signoff",V.Global.iSignOffIndex,"QA_SIGNOFF",False)
	F.Intrinsic.Control.EndIf
	F.Intrinsic.Control.If(V.DataTable.Signoff(V.Global.iSignOffIndex).CCA_NO!FieldValTrim,<>,"")
		V.Local.sFieldMap.Set("CCA_NO@!@CCA_NO*!*DATE_ENTERED@!@DATE_ENTERED*!*COMPLETED_DATE@!@COMPLETED_DATE*!*ORIG_USER@!@ORIG_USER*!*PROJECT_TYPE@!@PROJECT_TYPE*!*PART@!@PART*!*WO@!@WO*!*SO@!@SO*!*ISSUE@!@ISSUE*!*DESCRIPTION@!@DESCRIPTION*!*STATUS@!@STATUS*!*DUE_DATE@!@DUE_DATE*!*PRIORITY@!@PRIORITY*!*QA_SIGNOFF@!@QA_SIGNOFF*!*QA_USER@!@QA_USER*!*ADD_Group_1@!@ADD_Group_1*!*Group_1_SIGNOFF@!@Group_1_SIGNOFF*!*Group_1_USER@!@Group_1_USER*!*ADD_Group_2@!@ADD_Group_2*!*Group_2_SIGNOFF@!@Group_2_SIGNOFF*!*Group_2_USER@!@Group_2_USER")	
		F.Intrinsic.String.Build("CCA_NO = {0}",V.DataTable.Signoff(V.Global.iSignOffIndex).CCA_NO!FieldVAL,v.Local.sFilter)
		F.Data.DataView.Create("Signoff","VSignOff",22,V.Local.sFilter,"")
		F.Data.DataView.ToDataTable("Signoff","VSignOff","SignOffSaveTemp")
		F.Intrinsic.Control.If(V.DataTable.SignoffSaveTemp(V.DataTable.SignoffSaveTemp.RowCount--).QA_SIGNOFF!FieldVal)
			F.Data.DataTable.SetValue("SIGNOFFSAVETEMP",-1,"COMPLETED_DATE",V.Ambient.Date)
		F.Intrinsic.Control.EndIf
		
		F.Data.DataTable.Merge("SignOffSaveTemp","SignoffSave",True,2)
		F.Data.DataView.Close("Signoff","VSignOff")
		F.Data.DataTable.Close("SignoffSaveTemp")
		F.Data.DataTable.SaveToDB("SignoffSave","con","GCG_5398_CAR","CCA_NO",256,V.Local.sFieldMap)
		F.Data.DataTable.Merge("SignoffSave","Complete",True,2)
		F.Data.DataTable.DeleteRow("SignoffSave")
		F.Data.DataTable.AcceptChanges("SignoffSave")
		F.Intrinsic.Control.If(V.DataTable.Signoff(V.Global.iSignOffIndex).QA_Signoff!FieldVal)	
			F.Data.DataTable.DeleteRow("Signoff",V.Global.iSignOffIndex)
			F.Data.DataTable.AcceptChanges("Signoff")
		F.Intrinsic.Control.EndIf
	F.Intrinsic.Control.Else
		V.Local.sFieldMap.Set("ECR@!@ECR*!*DATE_ENTERED@!@DATE_ENTERED*!*COMPLETED_DATE@!@COMPLETED_DATE*!*ORIG_USER@!@ORIG_USER*!*PROJECT_TYPE@!@PROJECT_TYPE*!*PART@!@PART*!*WO@!@WO*!*SO@!@SO*!*ISSUE@!@ISSUE*!*DESCRIPTION@!@DESCRIPTION*!*STATUS@!@STATUS*!*DUE_DATE@!@DUE_DATE*!*PRIORITY@!@PRIORITY*!*QA_SIGNOFF@!@QA_SIGNOFF*!*QA_USER@!@QA_USER*!*ADD_Group_1@!@ADD_Group_1*!*Group_1_SIGNOFF@!@Group_1_SIGNOFF*!*Group_1_USER@!@Group_1_USER*!*ADD_Group_2@!@ADD_Group_2*!*Group_2_SIGNOFF@!@Group_2_SIGNOFF*!*Group_2_USER@!@Group_2_USER")
		F.Intrinsic.String.Build("ECR = {0}",V.DataTable.Signoff(V.Global.iSignOffIndex).ECR!FieldVAL,v.Local.sFilter)
		F.Data.DataView.Create("Signoff","VSignOff",22,V.Local.sFilter,"")
		F.Data.DataView.ToDataTable("Signoff","VSignOff","SignOffSaveTemp")
		F.Intrinsic.Control.If(V.DataTable.SignoffSaveTemp(V.DataTable.SignoffSaveTemp.RowCount--).QA_SIGNOFF!FieldVal)
			F.Data.DataTable.SetValue("SIGNOFFSAVETEMP",-1,"COMPLETED_DATE",V.Ambient.Date)
		F.Intrinsic.Control.EndIf
		F.Data.DataTable.Merge("SignOffSaveTemp","SignoffSave",True,2)
		F.Data.DataTable.SaveToDB("SignoffSave","con","GCG_5398_ECR","ECR",256,V.Local.sFieldMap)
		F.Data.DataView.Close("Signoff","VSignOff")
		F.Data.DataTable.Close("SignoffSaveTemp")
		F.Data.DataTable.Merge("SignoffSave","Complete",True,2)
		F.Data.DataTable.DeleteRow("SignoffSave")
		F.Data.DataTable.AcceptChanges("SignoffSave")
		F.Intrinsic.Control.If(V.DataTable.Signoff(V.Global.iSignOffIndex).QA_Signoff!FieldVal)
			F.Data.DataTable.DeleteRow("Signoff",V.Global.iSignOffIndex)
			F.Data.DataTable.AcceptChanges("Signoff")
		F.Intrinsic.Control.EndIf
	F.Intrinsic.Control.EndIf
	
	F.ODBC.Connection!Con.Close
	
	Gui.FormCCA/ECRSignoff.cmdSaveSignoff.Enabled(False)
	
	F.Intrinsic.Control.CallSub(FormCCA/ECRSignoff_UnLoad)
	
	F.Intrinsic.Control.ExitSub

F.Intrinsic.Control.Catch
	F.Intrinsic.Control.If(V.Ambient.ErrorNumber,<>,0)
		F.Intrinsic.String.Build("Project: {0}{1}Subroutine: {2}{1}Error Occurred {3} with description {4}","GCG_5398_CAR_ECN.g2u",V.Ambient.NewLine,V.Ambient.CurrentSubroutine,V.Ambient.ErrorNumber,V.Ambient.ErrorDescription,V.Local.sError)
		F.Intrinsic.UI.Msgbox(V.Local.sError)
		F.Intrinsic.Control.CallSub(FormQC_UnLoad)
	F.Intrinsic.Control.EndIf
Function.Intrinsic.Control.EndTry
Program.Sub.cmdSaveSignoff_Click.End

Program.Sub.chkECR_Click.Start
F.Intrinsic.Control.Try
	V.Local.sError.Declare(String,"")
	V.Local.iIdentity.Declare(Long,0)
	V.Local.sSql.Declare(String,"")
	V.Local.sRet.Declare(String,"")
	V.Local.sDate.Declare(String,"")

	F.ODBC.Connection!Con.OpenCompanyConnection
	F.Intrinsic.Control.If(V.Screen.FormCCA/ECR!chkECR.Value,=,1)
		F.Intrinsic.Control.If(V.Global.iEcr,=,0)
			F.Intrinsic.String.Format(V.Ambient.Date,"MM/DD/YYYY",V.Local.sDate)
			F.ODBC.Connection!Con.ExecuteAndReturn("Select LAST_ECR_NO, LAST_CCA_NO From GCG_5398_CCA_ECR_NO",V.Local.sRet)
			F.Intrinsic.String.Split(V.Local.sRet,"*!*",V.Local.sRet)
			F.Intrinsic.Control.If(V.Local.sRet.UBound,>,0)
				F.Intrinsic.Math.Add(V.Local.sRet(0).Long,1,V.Local.iIdentity)
				F.Intrinsic.String.Build("Update GCG_5398_CCA_ECR_NO SET LAST_ECR_NO = {0}",V.Local.iIdentity,V.Local.sSql)
			F.Intrinsic.Control.Else
				V.Local.iIdentity.Set(1)
				F.Intrinsic.String.Build("Insert Into GCG_5398_CCA_ECR_NO (LAST_ECR_NO) VALUES({0})",V.Local.iIdentity,V.Local.sSql)
			F.Intrinsic.Control.EndIf
			F.ODBC.Connection!Con.Execute(V.Local.sSql)
			
			Gui.FormCCA/ECR.txtECR.Text(V.Local.iIdentity)
			
			V.Global.iEcr.Set(V.Local.iIdentity)
			
		F.Intrinsic.Control.Else
			Gui.FormCCA/ECR.txtECR.Text(V.Global.iEcr)
		F.Intrinsic.Control.EndIf
	F.Intrinsic.Control.Else
		Gui.FormCCA/ECR.txtECR.Text(V.Ambient.DBNull)
	F.Intrinsic.Control.EndIf
	
	Gui.FormCCA/ECR.txtDesc.SetFocus
	
	F.ODBC.Connection!Con.Close
	
	F.Intrinsic.Control.ExitSub

F.Intrinsic.Control.Catch
	F.Intrinsic.Control.If(V.Ambient.ErrorNumber,<>,0)
		F.Intrinsic.String.Build("Project: {0}{1}Subroutine: {2}{1}Error Occurred {3} with description {4}","GCG_5398_CAR_ECN.g2u",V.Ambient.NewLine,V.Ambient.CurrentSubroutine,V.Ambient.ErrorNumber,V.Ambient.ErrorDescription,V.Local.sError)
		F.Intrinsic.UI.Msgbox(V.Local.sError)
		F.Intrinsic.Control.CallSub(FormQC_UnLoad)
	F.Intrinsic.Control.EndIf
Function.Intrinsic.Control.EndTry
Program.Sub.chkECR_Click.End

Program.Sub.Form_ECRCCA_Change.Start
F.Intrinsic.Control.Try
	V.Local.sError.Declare(String,"")
	
	Gui.FormCCA/ECR.cmdCCAECRSave.Enabled(True)
	
	F.Intrinsic.Control.ExitSub

F.Intrinsic.Control.Catch
	F.Intrinsic.Control.If(V.Ambient.ErrorNumber,<>,0)
		F.Intrinsic.String.Build("Project: {0}{1}Subroutine: {2}{1}Error Occurred {3} with description {4}","GCG_5398_CAR_ECN.g2u",V.Ambient.NewLine,V.Ambient.CurrentSubroutine,V.Ambient.ErrorNumber,V.Ambient.ErrorDescription,V.Local.sError)
		F.Intrinsic.UI.Msgbox(V.Local.sError)
		F.Intrinsic.Control.CallSub(FormQC_UnLoad)
	F.Intrinsic.Control.EndIf
Function.Intrinsic.Control.EndTry
Program.Sub.Form_ECRCCA_Change.End

Program.Sub.Form_ECRCCASignoff_Change.Start
F.Intrinsic.Control.Try
	V.Local.sError.Declare(String,"")
	
	Gui.FormCCA/ECRSignoff.cmdSaveSignoff.Enabled(True)
	
	F.Intrinsic.Control.ExitSub

F.Intrinsic.Control.Catch
	F.Intrinsic.Control.If(V.Ambient.ErrorNumber,<>,0)
		F.Intrinsic.String.Build("Project: {0}{1}Subroutine: {2}{1}Error Occurred {3} with description {4}","GCG_5398_CAR_ECN.g2u",V.Ambient.NewLine,V.Ambient.CurrentSubroutine,V.Ambient.ErrorNumber,V.Ambient.ErrorDescription,V.Local.sError)
		F.Intrinsic.UI.Msgbox(V.Local.sError)
		F.Intrinsic.Control.CallSub(FormQC_UnLoad)
	F.Intrinsic.Control.EndIf
Function.Intrinsic.Control.EndTry
Program.Sub.Form_ECRCCASignoff_Change.End

Program.Sub.cmdECC_Click.Start
F.Intrinsic.Control.Try
	V.Local.sError.Declare(String,"")
	V.Local.sRet.Declare(String,"")
	V.Local.sSql.Declare(String,"")
	V.Local.sTitles.Declare(String,"")
	V.Local.sWidths.Declare(String,"")
	
	V.Local.sSql.Set("Select ECN_NUMBER, CHANGE_REASON From V_ECN_HEADER UNION Select ECN_NUMBER, CHANGE_REASON From V_ECN_HIST_HEADER Order By ECN_NUMBER")
	
	V.Local.sTitles.Set("ECN #*!*Change Reason")
	V.Local.sWidths.Set("1800*!*1800")

	F.Intrinsic.String.Split(V.Local.sTitles,"*!*",V.Local.sTitles)
	F.Intrinsic.String.Split(V.Local.sWidths,"*!*",V.Local.sWidths)
	
	F.ODBC.Connection!Con.OpenCompanyConnection
	
	F.Intrinsic.UI.SetBrowserHotTypeAhead(True)
	
	F.Intrinsic.UI.Browser("Select Department","con",V.Local.sSql,V.Local.sTitles,V.Local.sWidths,10200,8700,V.Local.sRet)
	
	F.Intrinsic.Control.If(V.Local.sRet,<>,"***CANCEL***")
		F.Intrinsic.String.Split(V.Local.sRet,"*!*",V.Local.sRet)
		Gui.FormCCA/ECR.txtECR.Text(V.Local.sRet.Trim)
		
		Gui.FormCCA/ECR.cmdCCAECRSave.Enabled(True)
		
	F.Intrinsic.Control.EndIf
	
	F.ODBC.Connection!Con.Close	
	
	F.Intrinsic.Control.ExitSub

F.Intrinsic.Control.Catch
	F.Intrinsic.Control.If(V.Ambient.ErrorNumber,<>,0)
		F.Intrinsic.String.Build("Project: {0}{1}Subroutine: {2}{1}Error Occurred {3} with description {4}","GCG_5398_CAR_ECN.g2u",V.Ambient.NewLine,V.Ambient.CurrentSubroutine,V.Ambient.ErrorNumber,V.Ambient.ErrorDescription,V.Local.sError)
		F.Intrinsic.UI.Msgbox(V.Local.sError)
		F.Intrinsic.Control.CallSub(FormQC_UnLoad)
	F.Intrinsic.Control.EndIf
Function.Intrinsic.Control.EndTry
Program.Sub.cmdECC_Click.End

Program.Sub.cmdOrigDrawn_Click.Start
F.Intrinsic.Control.Try
	V.Local.sError.Declare(String,"")
	V.Local.sRet.Declare(String,"")
	V.Local.sSql.Declare(String,"")
	V.Local.sTitles.Declare(String,"")
	V.Local.sWidths.Declare(String,"")
	
	F.Intrinsic.String.Build("Select rtrim(PR_User_ID), rtrim(Dept_Employee) From V_Employee_Mstr Where rtrim(Dept_Employee) = '{0}' and PR_User_ID <> ''","ENGR",V.Local.sSql)
	
	V.Local.sTitles.Set("User ID*!*Department")
	V.Local.sWidths.Set("1800*!*1800")

	F.Intrinsic.String.Split(V.Local.sTitles,"*!*",V.Local.sTitles)
	F.Intrinsic.String.Split(V.Local.sWidths,"*!*",V.Local.sWidths)
	
	F.ODBC.Connection!Con.OpenCompanyConnection
	
	F.Intrinsic.UI.SetBrowserHotTypeAhead(True)
	
	F.Intrinsic.UI.Browser("Select User","con",V.Local.sSql,V.Local.sTitles,V.Local.sWidths,10200,8700,V.Local.sRet)
	
	F.Intrinsic.Control.If(V.Local.sRet,<>,"***CANCEL***")
		F.Intrinsic.String.Split(V.Local.sRet,"*!*",V.Local.sRet)
		Gui.FormCCA/ECR.txtOrgDrawn.Text(V.Local.sRet.Trim)
		
		Gui.FormCCA/ECR.cmdCCAECRSave.Enabled(True)
		
	F.Intrinsic.Control.EndIf
	
	F.ODBC.Connection!Con.Close	
	
	F.Intrinsic.Control.ExitSub
	
F.Intrinsic.Control.Catch
	F.Intrinsic.Control.If(V.Ambient.ErrorNumber,<>,0)
		F.Intrinsic.String.Build("Project: {0}{1}Subroutine: {2}{1}Error Occurred {3} with description {4}","GCG_5398_CAR_ECN.g2u",V.Ambient.NewLine,V.Ambient.CurrentSubroutine,V.Ambient.ErrorNumber,V.Ambient.ErrorDescription,V.Local.sError)
		F.Intrinsic.UI.Msgbox(V.Local.sError)
		F.Intrinsic.Control.CallSub(FormQC_UnLoad)
	F.Intrinsic.Control.EndIf
Function.Intrinsic.Control.EndTry
Program.Sub.cmdOrigDrawn_Click.End

Program.Sub.cmdOrigModBy_Click.Start
F.Intrinsic.Control.Try
	V.Local.sError.Declare(String,"")
	V.Local.sRet.Declare(String,"")
	V.Local.sSql.Declare(String,"")
	V.Local.sTitles.Declare(String,"")
	V.Local.sWidths.Declare(String,"")
	
	F.Intrinsic.String.Build("Select rtrim(PR_User_ID), rtrim(Dept_Employee) From V_Employee_Mstr Where rtrim(Dept_Employee) = '{0}' and PR_User_ID <> ''","ENGR",V.Local.sSql)
	
	V.Local.sTitles.Set("User ID*!*Deptartment")
	V.Local.sWidths.Set("1800*!*1800")

	F.Intrinsic.String.Split(V.Local.sTitles,"*!*",V.Local.sTitles)
	F.Intrinsic.String.Split(V.Local.sWidths,"*!*",V.Local.sWidths)
	
	F.ODBC.Connection!Con.OpenCompanyConnection
	
	F.Intrinsic.UI.SetBrowserHotTypeAhead(True)
	
	F.Intrinsic.UI.Browser("Select User","con",V.Local.sSql,V.Local.sTitles,V.Local.sWidths,10200,8700,V.Local.sRet)
	
	F.Intrinsic.Control.If(V.Local.sRet,<>,"***CANCEL***")
		F.Intrinsic.String.Split(V.Local.sRet,"*!*",V.Local.sRet)
		Gui.FormCCA/ECR.txtOrgModBy.Text(V.Local.sRet.Trim)
		
		Gui.FormCCA/ECR.cmdCCAECRSave.Enabled(True)
		
	F.Intrinsic.Control.EndIf
	
	F.ODBC.Connection!Con.Close	
	
	F.Intrinsic.Control.ExitSub
	
F.Intrinsic.Control.Catch
	F.Intrinsic.Control.If(V.Ambient.ErrorNumber,<>,0)
		F.Intrinsic.String.Build("Project: {0}{1}Subroutine: {2}{1}Error Occurred {3} with description {4}","GCG_5398_CAR_ECN.g2u",V.Ambient.NewLine,V.Ambient.CurrentSubroutine,V.Ambient.ErrorNumber,V.Ambient.ErrorDescription,V.Local.sError)
		F.Intrinsic.UI.Msgbox(V.Local.sError)
		F.Intrinsic.Control.CallSub(FormQC_UnLoad)
	F.Intrinsic.Control.EndIf
Function.Intrinsic.Control.EndTry
Program.Sub.cmdOrigModBy_Click.End

Program.Sub.cmdOrigCheck_Click.Start
F.Intrinsic.Control.Try
	V.Local.sError.Declare(String,"")
	V.Local.sRet.Declare(String,"")
	V.Local.sSql.Declare(String,"")
	V.Local.sTitles.Declare(String,"")
	V.Local.sWidths.Declare(String,"")

	F.Intrinsic.String.Build("Select rtrim(PR_User_ID), rtrim(Dept_Employee) From V_Employee_Mstr Where rtrim(Dept_Employee) = '{0}' and PR_User_ID <> ''","ENGR",V.Local.sSql)
	
	V.Local.sTitles.Set("User ID*!*Deptartment")
	V.Local.sWidths.Set("1800*!*1800")

	F.Intrinsic.String.Split(V.Local.sTitles,"*!*",V.Local.sTitles)
	F.Intrinsic.String.Split(V.Local.sWidths,"*!*",V.Local.sWidths)
	
	F.ODBC.Connection!Con.OpenCompanyConnection
	
	F.Intrinsic.UI.SetBrowserHotTypeAhead(True)
	
	F.Intrinsic.UI.Browser("Select User","con",V.Local.sSql,V.Local.sTitles,V.Local.sWidths,10200,8700,V.Local.sRet)
	
	F.Intrinsic.Control.If(V.Local.sRet,<>,"***CANCEL***")
		F.Intrinsic.String.Split(V.Local.sRet,"*!*",V.Local.sRet)
		Gui.FormCCA/ECR.txtOrgCheckBy.Text(V.Local.sRet.Trim)
		
		Gui.FormCCA/ECR.cmdCCAECRSave.Enabled(True)
		
	F.Intrinsic.Control.EndIf
	
	F.ODBC.Connection!Con.Close	
	
	F.Intrinsic.Control.ExitSub
	
F.Intrinsic.Control.Catch
	F.Intrinsic.Control.If(V.Ambient.ErrorNumber,<>,0)
		F.Intrinsic.String.Build("Project: {0}{1}Subroutine: {2}{1}Error Occurred {3} with description {4}","GCG_5398_CAR_ECN.g2u",V.Ambient.NewLine,V.Ambient.CurrentSubroutine,V.Ambient.ErrorNumber,V.Ambient.ErrorDescription,V.Local.sError)
		F.Intrinsic.UI.Msgbox(V.Local.sError)
		F.Intrinsic.Control.CallSub(FormQC_UnLoad)
	F.Intrinsic.Control.EndIf
Function.Intrinsic.Control.EndTry
Program.Sub.cmdOrigCheck_Click.End

Program.Sub.cmdAddRow_Click.Start
F.Intrinsic.Control.Try
	V.Local.sError.Declare(String,"")
	V.Local.sFilter.Declare(String,"")
	V.Local.iIdentity.Declare(Long,0)
	V.Local.sRet.Declare(String,"")
	V.Local.sSql.Declare(String,"")
	V.Local.sMsg.Declare(String,"")
	
	F.Intrinsic.Control.SelectCase(V.Screen.FormQC!tabQC.Tab)
		F.Intrinsic.Control.Case(0)
			F.ODBC.Connection!Con.OpenCompanyConnection
			
			F.ODBC.Connection!Con.ExecuteAndReturn("Select LAST_CCA_NO, LAST_ECR_NO From GCG_5398_CCA_ECR_NO",V.Local.sRet)
			F.Intrinsic.String.Split(V.Local.sRet,"*!*",V.Local.sRet)
			F.Intrinsic.Control.If(V.Local.sRet.UBound,>,0)
				F.Intrinsic.Math.Add(V.Local.sRet(0).Long,1,V.Local.iIdentity)
				F.Intrinsic.String.Build("Update GCG_5398_CCA_ECR_NO SET LAST_CCA_NO = {0}",V.Local.iIdentity,V.Local.sSql)
			F.Intrinsic.Control.Else
				V.Local.iIdentity.Set(1)
				F.Intrinsic.String.Build("Insert Into GCG_5398_CCA_ECR_NO (LAST_CCA_NO) VALUES({0})",V.Local.iIdentity,V.Local.sSql)
			F.Intrinsic.Control.EndIf
			F.ODBC.Connection!Con.Execute(V.Local.sSql)
			
			F.ODBC.Connection!Con.Close
			
			Gui.FormCCA/ECR.txtECR.Text(V.Ambient.DBNull)
			Gui.FormCCA/ECR.dtpDueDate.Value(V.Ambient.Date)
			Gui.FormCCA/ECR.ddlAssignedTo.Text(" ")
			Gui.FormCCA/ECR.ddlIssue.Text(" ")
			Gui.FormCCA/ECR.ddlProjType.Text(" ")
			Gui.FormCCA/ECR.ddlSource.Text(" ")
			Gui.FormCCA/ECR.ddlWG.Text(" ")
			Gui.FormCCA/ECR.ddlStatus.Text("Assigned - Not Started")
			Gui.FormCCA/ECR.ddlPriority.Text("Low")
			Gui.FormCCA/ECR.lblECR.Caption("ECR")
			Gui.FormCCA/ECR.txtESTCost.Text("0")
			Gui.FormCCA/ECR.txtECR.Locked(True)
			Gui.FormCCA/ECR.cmdECC.Visible(False)
			Gui.FormCCA/ECR.lblOrgCheck.Visible(False)
			Gui.FormCCA/ECR.lblOrgDrawn.Visible(False)
			Gui.FormCCA/ECR.lblModBy.Visible(False)
			Gui.FormCCA/ECR.txtOrgCheckBy.Visible(False)
			Gui.FormCCA/ECR.txtOrgDrawn.Visible(False)
			Gui.FormCCA/ECR.txtOrgModBy.Visible(False)
			Gui.FormCCA/ECR.cmdOrigCheck.Visible(False)
			Gui.FormCCA/ECR.cmdOrigDrawn.Visible(False)
			Gui.FormCCA/ECR.cmdOrigModBy.Visible(False)
			Gui.FormCCA/ECR.chkECR.Visible(True)
			F.Intrinsic.String.Build("CAPA: {0}",V.Local.iIdentity,V.Local.sMsg)
			Gui.FormCCA/ECR.lblCCA/ECR.Caption(V.Local.sMsg)
			Gui.FormQC..Enabled(False)
			F.Intrinsic.Control.BlockEvents
			Gui.FormCCA/ECR..Show
			F.Intrinsic.Control.UnBlockEvents
			Gui.FormCCA/ECR..WaitForDismiss
			
			Gui.FormQC..Enabled(True)
			Gui.FormQC..AlwaysOnTop(True)
			Gui.FormQC..AlwaysOnTop(False)
			
			Gui.FormQC.GsGridControlCAR.ResumeLayout
			
		F.Intrinsic.Control.Case(1)
			F.ODBC.Connection!Con.OpenCompanyConnection
			
			F.ODBC.Connection!Con.ExecuteAndReturn("Select LAST_ECR_NO, LAST_CCA_NO From GCG_5398_CCA_ECR_NO",V.Local.sRet)
			F.Intrinsic.String.Split(V.Local.sRet,"*!*",V.Local.sRet)
			F.Intrinsic.Control.If(V.Local.sRet.UBound,>,0)
				F.Intrinsic.Math.Add(V.Local.sRet(0).Long,1,V.Local.iIdentity)
				F.Intrinsic.String.Build("Update GCG_5398_CCA_ECR_NO SET LAST_ECR_NO = {0}",V.Local.iIdentity,V.Local.sSql)
			F.Intrinsic.Control.Else
				V.Local.iIdentity.Set(1)
				F.Intrinsic.String.Build("Insert Into GCG_5398_CCA_ECR_NO (LAST_ECR_NO) VALUES({0})",V.Local.iIdentity,V.Local.sSql)
			F.Intrinsic.Control.EndIf
			F.ODBC.Connection!Con.Execute(V.Local.sSql)
			
			F.ODBC.Connection!Con.Close
			
'			Gui.FormCCA/ECR.txtECR.Text(V.Local.iIdentity)
			Gui.FormCCA/ECR.txtECR.Text(V.Ambient.DBNull)
			Gui.FormCCA/ECR.dtpDueDate.Value(V.Ambient.Date)
			Gui.FormCCA/ECR.ddlAssignedTo.Text(" ")
			Gui.FormCCA/ECR.ddlIssue.Text(" ")
			Gui.FormCCA/ECR.ddlProjType.Text(" ")
			Gui.FormCCA/ECR.ddlSource.Text(" ")
			Gui.FormCCA/ECR.ddlWG.Text(" ")
			Gui.FormCCA/ECR.ddlStatus.Text("Assigned - Not Started")
			Gui.FormCCA/ECR.ddlPriority.Text("Low")
			Gui.FormQC..Enabled(False)
			Gui.FormCCA/ECR.txtESTCost.Text("0")
			Gui.FormCCA/ECR.lblECR.Caption("ECC")
			Gui.FormCCA/ECR.txtECR.Locked(True)
			Gui.FormCCA/ECR.cmdECC.Visible(True)
			Gui.FormCCA/ECR.lblECR.Visible(True)
			Gui.FormCCA/ECR.txtECR.Visible(True)
			Gui.FormCCA/ECR.lblOrgCheck.Visible(True)
			Gui.FormCCA/ECR.lblOrgDrawn.Visible(True)
			Gui.FormCCA/ECR.lblModBy.Visible(True)
			Gui.FormCCA/ECR.txtOrgCheckBy.Visible(True)
			Gui.FormCCA/ECR.txtOrgDrawn.Visible(True)
			Gui.FormCCA/ECR.txtOrgModBy.Visible(True)
			Gui.FormCCA/ECR.txtOrgModBy.Text(" ")
			Gui.FormCCA/ECR.txtOrgCheckBy.Text(" ")
			Gui.FormCCA/ECR.txtOrgDrawn.Text(" ")
			Gui.FormCCA/ECR.cmdOrigCheck.Visible(True)
			Gui.FormCCA/ECR.cmdOrigDrawn.Visible(True)
			Gui.FormCCA/ECR.cmdOrigModBy.Visible(True)
			Gui.FormCCA/ECR.chkECR.Visible(False)
			F.Intrinsic.String.Build("ECR: {0}",V.Local.iIdentity,V.Local.sMsg)
			Gui.FormCCA/ECR.lblCCA/ECR.Caption(V.Local.sMsg)
			F.Intrinsic.Control.BlockEvents
			Gui.FormCCA/ECR..Show
			F.Intrinsic.Control.UnBlockEvents
			Gui.FormCCA/ECR..WaitForDismiss
			
			Gui.FormQC..Enabled(True)
			
			Gui.FormQC..AlwaysOnTop(True)
			Gui.FormQC..AlwaysOnTop(False)
			
			Gui.FormQC.GsGridControlECR.ResumeLayout
	
	F.Intrinsic.Control.EndSelect
	
	F.Intrinsic.Control.ExitSub
	
F.Intrinsic.Control.Catch
	F.Intrinsic.Control.If(V.Ambient.ErrorNumber,<>,0)
		F.Intrinsic.String.Build("Project: {0}{1}Subroutine: {2}{1}Error Occurred {3} with description {4}","GCG_5398_CAR_ECN.g2u",V.Ambient.NewLine,V.Ambient.CurrentSubroutine,V.Ambient.ErrorNumber,V.Ambient.ErrorDescription,V.Local.sError)
		F.Intrinsic.UI.Msgbox(V.Local.sError)
		F.Intrinsic.Control.CallSub(FormQC_UnLoad)
	F.Intrinsic.Control.EndIf
Function.Intrinsic.Control.EndTry
Program.Sub.cmdAddRow_Click.End

Program.Sub.tabQC_Click.Start
F.Intrinsic.Control.Try
	V.Local.sError.Declare(String,"")
	
	F.Intrinsic.Control.SelectCase(V.Screen.FormQC!tabQC.Tab)
		F.Intrinsic.Control.CaseAny(0,1)
			Gui.FormQC.cmdAddRow.Visible(True)
			
		F.Intrinsic.Control.CaseElse
			Gui.FormQC.cmdAddRow.Visible(False)
	
	F.Intrinsic.Control.EndSelect
	
	F.Intrinsic.Control.ExitSub
	
F.Intrinsic.Control.Catch
	F.Intrinsic.Control.If(V.Ambient.ErrorNumber,<>,0)
		F.Intrinsic.String.Build("Project: {0}{1}Subroutine: {2}{1}Error Occurred {3} with description {4}","GCG_5398_CAR_ECN.g2u",V.Ambient.NewLine,V.Ambient.CurrentSubroutine,V.Ambient.ErrorNumber,V.Ambient.ErrorDescription,V.Local.sError)
		F.Intrinsic.UI.Msgbox(V.Local.sError)
		F.Intrinsic.Control.CallSub(FormQC_UnLoad)
	F.Intrinsic.Control.EndIf
Function.Intrinsic.Control.EndTry
Program.Sub.tabQC_Click.End

Program.Sub.FormCCA/ECR_Resize.Start
F.Intrinsic.Control.Try
	V.Local.sError.Declare(String,"")
	v.Local.iFWidthDiff.Declare(Long,0)
	v.Local.iFHeightDiff.Declare(Long,0)
	v.Local.iWorkWidth.Declare(Long,0)
	v.Local.iWorkHeight.Declare(Long,0)
	V.Local.iTop.Declare(Long,0)

'	f.Intrinsic.Math.Div(V.Screen.FormCCA/ECR.Height,8,v.Local.iFHeightDiff)
	F.Intrinsic.Math.Sub(V.Screen.FormCCA/ECR!cmdCCAECRSave.Top,V.Screen.FormCCA/ECR!txtDesc.Top,V.Local.iFHeightDiff)
	F.Intrinsic.Math.Div(V.Local.iFHeightDiff,3,V.Local.iFHeightDiff)
	F.Intrinsic.Math.Sub(V.Local.iFHeightDiff,285,V.Local.iFHeightDiff)

	Gui.FormCCA/ECR.txtDesc.Size(V.Screen.FormCCA/ECR!txtDesc.Width,V.Local.iFHeightDiff)
	Gui.FormCCA/ECR.txtRootCause.Size(V.Screen.FormCCA/ECR!txtDesc.Width,V.Screen.FormCCA/ECR!txtDesc.Height)
	Gui.FormCCA/ECR.txtActionPlan.Size(V.Screen.FormCCA/ECR!txtDesc.Width,V.Screen.FormCCA/ECR!txtDesc.Height)
'	
''	Gui.FormCCA/ECR.txtDesc.Position(105,V.Local.iTop)
	F.Intrinsic.Math.Add(V.Screen.FormCCA/ECR!txtDesc.Top,V.Screen.FormCCA/ECR!txtDesc.Height,100,V.Local.iWorkHeight)
	Gui.FormCCA/ECR.lblRootCause.Position(105,V.Local.iWorkHeight)
	F.Intrinsic.Math.Add(V.Local.iWorkHeight,300,V.Local.iWorkHeight)
	Gui.FormCCA/ECR.txtRootCause.Position(105,V.Local.iWorkHeight)
	F.Intrinsic.Math.Add(V.Screen.FormCCA/ECR!txtRootCause.Top,V.Screen.FormCCA/ECR!txtRootCause.Height,100,V.Local.iWorkHeight)
	Gui.FormCCA/ECR.lblActionPlan.Position(105,V.Local.iWorkHeight)
	F.Intrinsic.Math.Add(V.Local.iWorkHeight,300,V.Local.iWorkHeight)
	Gui.FormCCA/ECR.txtActionPlan.Position(105,V.Local.iWorkHeight)
	
	F.Intrinsic.Control.ExitSub
	
F.Intrinsic.Control.Catch
	F.Intrinsic.Control.If(V.Ambient.ErrorNumber,<>,0)
		F.Intrinsic.String.Build("Project: {0}{1}Subroutine: {2}{1}Error Occurred {3} with description {4}","GCG_5398_CAR_ECN.g2u",V.Ambient.NewLine,V.Ambient.CurrentSubroutine,V.Ambient.ErrorNumber,V.Ambient.ErrorDescription,V.Local.sError)
		F.Intrinsic.UI.Msgbox(V.Local.sError)
		F.Intrinsic.Control.CallSub(FormQC_UnLoad)
	F.Intrinsic.Control.EndIf
Function.Intrinsic.Control.EndTry
Program.Sub.FormCCA/ECR_Resize.End
